Index: ksmserver/legacy.cpp
===================================================================
--- ksmserver/legacy.cpp	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ ksmserver/legacy.cpp	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -272,6 +272,10 @@
     for ( int i = 1; i <= count; i++ ) {
         QString n = QString::number(i);
         QStringList wmCommand = config->readListEntry( QString("command")+n, sep );
+        if( wmCommand.isEmpty())
+            continue;
+        if( isWM( wmCommand.first()))
+            continue;
         startApplication( wmCommand,
                           config->readEntry( QString("clientMachine")+n ),
                           config->readEntry( QString("userId")+n ));
Index: ksmserver/server.cpp
===================================================================
--- ksmserver/server.cpp	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ ksmserver/server.cpp	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -903,12 +903,16 @@
 
 bool KSMServer::isWM( const KSMClient* client ) const
 {
+    return isWM( client->program());
+}
+
+bool KSMServer::isWM( const QString& program ) const
+{
     // KWin relies on ksmserver's special treatment in phase1,
     // therefore make sure it's recognized even if ksmserver
     // was initially started with different WM, and kwin replaced
     // it later
-    return client->program() == wm
-        || client->program() == "kwin";
+    return program == wm || program == "kwin";
 }
 
 bool KSMServer::defaultSession() const
Index: ksmserver/server.h
===================================================================
--- ksmserver/server.h	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ ksmserver/server.h	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -138,6 +138,7 @@
     void executeCommand( const QStringList& command );
     
     bool isWM( const KSMClient* client ) const;
+    bool isWM( const QString& program ) const;
     bool defaultSession() const; // empty session
     void setupXIOErrorHandler();
 
Index: kcontrol/ebrowsing/plugins/ikws/searchproviders/dmoz.desktop
===================================================================
--- kcontrol/ebrowsing/plugins/ikws/searchproviders/dmoz.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/ebrowsing/plugins/ikws/searchproviders/dmoz.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -27,7 +27,6 @@
 Name[ne]=डाइरेक्टरी खोल्नुहोस्
 Name[pa]=ਖੁੱਲੀ ਡਾਇਰੈਕਟਰੀ
 Name[pl]=Open Directory - katalog stron WWW
-Name[pt_BR]=Abrir Diretório
 Name[ro]=Director web open-source
 Name[ru]=Открытый каталог
 Name[rw]= Gufungura Inkoranyamagambo
Index: kcontrol/locale/default/entry.desktop
===================================================================
--- kcontrol/locale/default/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/locale/default/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -14,7 +14,7 @@
 Name[da]=Engelsk US
 Name[de]=US-Englisch
 Name[el]=Αγγλική ΗΠΑ
-Name[eo]=Angla usona
+Name[eo]=Usona anglo
 Name[es]=Inglés de EEUU
 Name[et]=Inglise (US)
 Name[eu]=EEBBetako ingelesa
Index: kcontrol/filetypes/filetypes.desktop
===================================================================
--- kcontrol/filetypes/filetypes.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/filetypes/filetypes.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -202,7 +202,7 @@
 Keywords[nds]=Dateitypen,Datei-Tohören,Mime Typen,Dateimuster,Datei,Muster
 Keywords[ne]=फाइल प्रकार, फाइल संयोजन, माइम प्रकार, फाइल बाँन्की, फाइलहरू, बाँन्की
 Keywords[nl]=bestandstypen,bestandsextensies,bestandsassociaties,mime types,bestandspatronen,extensies,bestanden
-Keywords[nn]=filtypar,filtilknytingar,mime-typar,filmønster,filer,mønster
+Keywords[nn]=filtypar,filtilknytingar,MIME-typar,filmønster,filer,mønster
 Keywords[nso]=Mehuta ya difaele,Dikopantsho tsa Difaele,Mehuta ya Kekiso,Mekgwa ya Difaele,Difaele,Mokgwa
 Keywords[pa]=Filetypes,File Associations,Mime Types,File Patterns,ਫਾਇਲਾਂ,Pattern,ਫਾਇਲ ਕਿਸਮ,ਫਾਇਲ ਸਬੰਧ
 Keywords[pl]=Typy plików,skojarzenia plików,typy MIME,wzorce plików,pliki,wzorzec
Index: kcontrol/smserver/kcmsmserver.desktop
===================================================================
--- kcontrol/smserver/kcmsmserver.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/smserver/kcmsmserver.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -65,7 +65,7 @@
 Name[pt]=Gestor de Sessões
 Name[pt_BR]=Gerenciador de Sessão
 Name[ro]=Managerul de sesiune
-Name[ru]=Менеджер сеансов
+Name[ru]=Диспетчер сеансов
 Name[rw]=Mugenga Mukoro
 Name[se]=Bargovuorrogieđahalli
 Name[sk]=Správca sedenia
@@ -139,7 +139,7 @@
 Comment[pt]=Configuração do gestor de sessões e das opções de encerramento
 Comment[pt_BR]=Configura o gerenciador de sessão e definições de logout
 Comment[ro]=Configurează managerul de sesiune și setările de ieșire
-Comment[ru]=Настройка менеджера сеансов
+Comment[ru]=Настройка диспетчера сеансов
 Comment[rw]=Umukoro Muyobozi no Gufunga Igenamiterere 
 Comment[se]=Heivet bargovuorrogieđahalli ja olggosčáliheami
 Comment[sk]=Nastavenie správcu sedení a odhlásenia
Index: kcontrol/kded/kcmkded.desktop
===================================================================
--- kcontrol/kded/kcmkded.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/kded/kcmkded.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -126,7 +126,7 @@
 Comment[mn]=Системийн үйлчилгээний тохируулга
 Comment[ms]=Konfigurasi Servis Sistem
 Comment[mt]=Konfigurazzjoni tas-servizzi tas-sistema
-Comment[nb]=Systemtjenesteinstillinger
+Comment[nb]=Systemtjenesteinnstillinger
 Comment[nds]=Systeemdeensten instellen
 Comment[ne]=प्रणाली सेवा कन्फिगरेसन
 Comment[nl]=KDE-systeemdiensten instellen
Index: kcontrol/kicker/kicker_config_appearance.desktop
===================================================================
--- kcontrol/kicker/kicker_config_appearance.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/kicker/kicker_config_appearance.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -173,7 +173,7 @@
 Keywords[cy]=ciciwr,kicker,panel,kpanel,bar tasgau,bar cychwyn,bar lansio,lleoliad,maint,awto-guddio,hunan-guddio,cuddio,botymau,animeiddiad,cefndir,themâu,storfa dewislen, storfa,cache,celc,cudd,K-Menu,nodau tudalen,dogfenni diweddar,porydd cyflym,dewislen porydd,dewislen,eiconau,teiliau,rhaglenigion,ymcychwyn,amlygu,carnau,eiconau chwyddo
 Keywords[da]=kicker,panel,kpanel,opgavelinje,startlinje,sted,størrelse,autogem,gem,knapper,animering,baggrund,temaer,menucache,cache,skjult,K-Menu,bogmærker,nylige dokumenter,hurtigsøger,søgemenu,menu,ikoner,fliser,panelprogrammer,opstart,markér,håndterer,ikoner
 Keywords[de]=Kicker,Panel,Taskbar,Kontrollleiste,Startleiste,Klickstartleiste,Fensterleiste,Autom. ausblenden,Ausblenden, Knöpfe,Animation,Hintergründe,Stile,Design,Themes,Menü-Zwischenspeicher, K-Menü,Zwischenspeicher,Lesezeichen,Zuletzt geöffnete Dateien, Schnellanzeiger,Menüs,Symbole,Icons,Kacheln,Applets,Miniprogramme, Java-Miniprogramme,Hervorhebung,Anfasser,Sicherheitsstufen,Zoom für Symbole
-Keywords[el]=kicker,πίνακας,kpanel,γραμμή εργασιών,γραμμή έναρξης,γραμμή εκκίνησης,τοποθεσία,μέγεθος,αυτόματη απόκρυψη,απόκρυψη,κουμπιά,εφέ κίνησης,φόντο,θέματα,λανθάνουσα μνήμη μενού,λανθάνουσα μνήμη,κρυφό, K-Μενού,σελιδοδείκτες,πρόσφατα έγγραφα,γρήγορος εξερευνητής,μενού εξερευνητή,μενού,εικονίδια,tiles,εφαρμογίδια,έναρξη,τονισμός,χειριστήρια, μεγέθυνση εικονιδίων
+Keywords[el]=kicker,πίνακας,kpanel,γραμμή εργασιών,γραμμή έναρξης,γραμμή εκκίνησης,τοποθεσία,μέγεθος,αυτόματη απόκρυψη,απόκρυψη,κουμπιά,εφέ κίνησης,φόντο,θέματα,λανθάνουσα μνήμη μενού,λανθάνουσα μνήμη,κρυφό, K-Μενού,σελιδοδείκτες,πρόσφατα έγγραφα,γρήγορος εξερευνητής,μενού εξερευνητή,μενού,εικονίδια,tiles,μικροεφαρμογές,έναρξη,τονισμός,χειριστήρια, μεγέθυνση εικονιδίων
 Keywords[eo]=lanĉilo,panelo,tasklistelo,situo,grandeco,aŭtokaŝo,kaŝo,butono,fono,etoso,menubufro,K-Menuo,legosigno,lasta dokumento,rapidrigardilo,rigardmenuo,piktogramo,kahelo,aplikaĵo,lanĉo,emfazo,teniloj,pligrandigo,fidindaj aplikaĵetoj,sekurecnivelo
 Keywords[es]=kicker,panel,kpanel,barra de tareas,barra de inicio,barra de lanzamiento,dirección,tamaño,auto ocultar,ocultar,botones,animación,fondo,temas,caché de menú,caché,oculto,Menú K,marcadores,documentos recientes,navegador rápido,menú navegador,menú,iconos,mosaicos,miniaplicaciones,arranque,resaltado,asas,iconos ampliados
 Keywords[et]=kicker,paneel,kpanel,tegumiriba,käivitusriba,asukoht,suurus,terminal,automaatne peitmine,peitmine,nupud,animatsioon,taust,teemad,menüü vahemälu,vahemälu,peidetud,K-menüü,järjehoidjad,viimati kasutatud dokumendid, kiirbrauser,lehitsemise menüü,menüü,ikoonid,apletid,käivitamine,esiletõstmine,piirded,ikoonide suurendamine,usaldusväärsed apletid,turvatase
Index: kcontrol/kicker/kicker_config_arrangement.desktop
===================================================================
--- kcontrol/kicker/kicker_config_arrangement.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/kicker/kicker_config_arrangement.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -156,7 +156,7 @@
 Keywords[cy]=ciciwr,kicker,panel,kpanel,bar tasgau,bar cychwyn,bar lansio,lleoliad,maint,awto-guddio,hunan-guddio,cuddio,botymau,animeiddiad,cefndir,themâu,storfa dewislen, storfa,cache,celc,cudd,K-Menu,nodau tudalen,dogfenni diweddar,porydd cyflym,dewislen porydd,dewislen,eiconau,teiliau,rhaglenigion,ymcychwyn,amlygu,carnau,eiconau chwyddo
 Keywords[da]=kicker,panel,kpanel,opgavelinje,startlinje,sted,størrelse,autogem,gem,knapper,animering,baggrund,temaer,menucache,cache,skjult,K-Menu,bogmærker,nylige dokumenter,hurtigsøger,søgemenu,menu,ikoner,fliser,panelprogrammer,opstart,markér,håndterer,ikoner
 Keywords[de]=Kicker,Panel,Taskbar,Kontrollleiste,Startleiste,Klickstartleiste,Fensterleiste,Autom. ausblenden,Ausblenden, Knöpfe,Animation,Hintergründe,Stile,Design,Themes,Menü-Zwischenspeicher, K-Menü,Zwischenspeicher,Lesezeichen,Zuletzt geöffnete Dateien, Schnellanzeiger,Menüs,Symbole,Icons,Kacheln,Applets,Miniprogramme, Java-Miniprogramme,Hervorhebung,Anfasser,Sicherheitsstufen,Zoom für Symbole
-Keywords[el]=kicker,πίνακας,kpanel,γραμμή εργασιών,γραμμή έναρξης,γραμμή εκκίνησης,τοποθεσία,μέγεθος,αυτόματη απόκρυψη,απόκρυψη,κουμπιά,εφέ κίνησης,φόντο,θέματα,λανθάνουσα μνήμη μενού,λανθάνουσα μνήμη,κρυφό, K-Μενού,σελιδοδείκτες,πρόσφατα έγγραφα,γρήγορος εξερευνητής,μενού εξερευνητή,μενού,εικονίδια,tiles,εφαρμογίδια,έναρξη,τονισμός,χειριστήρια, μεγέθυνση εικονιδίων
+Keywords[el]=kicker,πίνακας,kpanel,γραμμή εργασιών,γραμμή έναρξης,γραμμή εκκίνησης,τοποθεσία,μέγεθος,αυτόματη απόκρυψη,απόκρυψη,κουμπιά,εφέ κίνησης,φόντο,θέματα,λανθάνουσα μνήμη μενού,λανθάνουσα μνήμη,κρυφό, K-Μενού,σελιδοδείκτες,πρόσφατα έγγραφα,γρήγορος εξερευνητής,μενού εξερευνητή,μενού,εικονίδια,tiles,μικροεφαρμογές,έναρξη,τονισμός,χειριστήρια, μεγέθυνση εικονιδίων
 Keywords[eo]=lanĉilo,panelo,tasklistelo,situo,grandeco,aŭtokaŝo,kaŝo,butono,fono,etoso,menubufro,K-Menuo,legosigno,lasta dokumento,rapidrigardilo,rigardmenuo,piktogramo,kahelo,aplikaĵo,lanĉo,emfazo,teniloj,pligrandigo,fidindaj aplikaĵetoj,sekurecnivelo
 Keywords[es]=kicker,panel,kpanel,barra de tareas,barra de inicio,barra de lanzamiento,dirección,tamaño,auto ocultar,ocultar,botones,animación,fondo,temas,caché de menú,caché,oculto,Menú K,marcadores,documentos recientes,navegador rápido,menú navegador,menú,iconos,mosaicos,miniaplicaciones,arranque,resaltado,asas,iconos ampliados
 Keywords[et]=kicker,paneel,kpanel,tegumiriba,käivitusriba,asukoht,suurus,terminal,automaatne peitmine,peitmine,nupud,animatsioon,taust,teemad,menüü vahemälu,vahemälu,peidetud,K-menüü,järjehoidjad,viimati kasutatud dokumendid, kiirbrauser,lehitsemise menüü,menüü,ikoonid,apletid,käivitamine,esiletõstmine,piirded,ikoonide suurendamine,usaldusväärsed apletid,turvatase
Index: kcontrol/kicker/kicker_config.desktop
===================================================================
--- kcontrol/kicker/kicker_config.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/kicker/kicker_config.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -167,7 +167,7 @@
 Keywords[cy]=ciciwr,kicker,panel,kpanel,bar tasgau,bar cychwyn,bar lansio,lleoliad,maint,awto-guddio,hunan-guddio,cuddio,botymau,animeiddiad,cefndir,themâu,storfa dewislen, storfa,cache,celc,cudd,K-Menu,nodau tudalen,dogfenni diweddar,porydd cyflym,dewislen porydd,dewislen,eiconau,teiliau,rhaglenigion,ymcychwyn,amlygu,carnau,eiconau chwyddo
 Keywords[da]=kicker,panel,kpanel,opgavelinje,startlinje,sted,størrelse,autogem,gem,knapper,animering,baggrund,temaer,menucache,cache,skjult,K-Menu,bogmærker,nylige dokumenter,hurtigsøger,søgemenu,menu,ikoner,fliser,panelprogrammer,opstart,markér,håndterer,ikoner
 Keywords[de]=Kicker,Panel,Taskbar,Kontrollleiste,Startleiste,Klickstartleiste,Fensterleiste,Autom. ausblenden,Ausblenden, Knöpfe,Animation,Hintergründe,Stile,Design,Themes,Menü-Zwischenspeicher, K-Menü,Zwischenspeicher,Lesezeichen,Zuletzt geöffnete Dateien, Schnellanzeiger,Menüs,Symbole,Icons,Kacheln,Applets,Miniprogramme, Java-Miniprogramme,Hervorhebung,Anfasser,Sicherheitsstufen,Zoom für Symbole
-Keywords[el]=kicker,πίνακας,kpanel,γραμμή εργασιών,γραμμή έναρξης,γραμμή εκκίνησης,τοποθεσία,μέγεθος,αυτόματη απόκρυψη,απόκρυψη,κουμπιά,εφέ κίνησης,φόντο,θέματα,λανθάνουσα μνήμη μενού,λανθάνουσα μνήμη,κρυφό, K-Μενού,σελιδοδείκτες,πρόσφατα έγγραφα,γρήγορος εξερευνητής,μενού εξερευνητή,μενού,εικονίδια,tiles,εφαρμογίδια,έναρξη,τονισμός,χειριστήρια, μεγέθυνση εικονιδίων
+Keywords[el]=kicker,πίνακας,kpanel,γραμμή εργασιών,γραμμή έναρξης,γραμμή εκκίνησης,τοποθεσία,μέγεθος,αυτόματη απόκρυψη,απόκρυψη,κουμπιά,εφέ κίνησης,φόντο,θέματα,λανθάνουσα μνήμη μενού,λανθάνουσα μνήμη,κρυφό, K-Μενού,σελιδοδείκτες,πρόσφατα έγγραφα,γρήγορος εξερευνητής,μενού εξερευνητή,μενού,εικονίδια,tiles,μικροεφαρμογές,έναρξη,τονισμός,χειριστήρια, μεγέθυνση εικονιδίων
 Keywords[eo]=lanĉilo,panelo,tasklistelo,situo,grandeco,aŭtokaŝo,kaŝo,butono,fono,etoso,menubufro,K-Menuo,legosigno,lasta dokumento,rapidrigardilo,rigardmenuo,piktogramo,kahelo,aplikaĵo,lanĉo,emfazo,teniloj,pligrandigo,fidindaj aplikaĵetoj,sekurecnivelo
 Keywords[es]=kicker,panel,kpanel,barra de tareas,barra de inicio,barra de lanzamiento,dirección,tamaño,auto ocultar,ocultar,botones,animación,fondo,temas,caché de menú,caché,oculto,Menú K,marcadores,documentos recientes,navegador rápido,menú navegador,menú,iconos,mosaicos,miniaplicaciones,arranque,resaltado,asas,iconos ampliados
 Keywords[et]=kicker,paneel,kpanel,tegumiriba,käivitusriba,asukoht,suurus,terminal,automaatne peitmine,peitmine,nupud,animatsioon,taust,teemad,menüü vahemälu,vahemälu,peidetud,K-menüü,järjehoidjad,viimati kasutatud dokumendid, kiirbrauser,lehitsemise menüü,menüü,ikoonid,apletid,käivitamine,esiletõstmine,piirded,ikoonide suurendamine,usaldusväärsed apletid,turvatase
Index: kcontrol/kicker/panel.desktop
===================================================================
--- kcontrol/kicker/panel.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/kicker/panel.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -166,7 +166,7 @@
 Keywords[cy]=ciciwr,kicker,panel,kpanel,bar tasgau,bar cychwyn,bar lansio,lleoliad,maint,awto-guddio,hunan-guddio,cuddio,botymau,animeiddiad,cefndir,themâu,storfa dewislen, storfa,cache,celc,cudd,K-Menu,nodau tudalen,dogfenni diweddar,porydd cyflym,dewislen porydd,dewislen,eiconau,teiliau,rhaglenigion,ymcychwyn,amlygu,carnau,eiconau chwyddo
 Keywords[da]=kicker,panel,kpanel,opgavelinje,startlinje,sted,størrelse,autogem,gem,knapper,animering,baggrund,temaer,menucache,cache,skjult,K-Menu,bogmærker,nylige dokumenter,hurtigsøger,søgemenu,menu,ikoner,fliser,panelprogrammer,opstart,markér,håndterer,ikoner
 Keywords[de]=Kicker,Panel,Taskbar,Kontrollleiste,Startleiste,Klickstartleiste,Fensterleiste,Autom. ausblenden,Ausblenden, Knöpfe,Animation,Hintergründe,Stile,Design,Themes,Menü-Zwischenspeicher, K-Menü,Zwischenspeicher,Lesezeichen,Zuletzt geöffnete Dateien, Schnellanzeiger,Menüs,Symbole,Icons,Kacheln,Applets,Miniprogramme, Java-Miniprogramme,Hervorhebung,Anfasser,Sicherheitsstufen,Zoom für Symbole
-Keywords[el]=kicker,πίνακας,kpanel,γραμμή εργασιών,γραμμή έναρξης,γραμμή εκκίνησης,τοποθεσία,μέγεθος,αυτόματη απόκρυψη,απόκρυψη,κουμπιά,εφέ κίνησης,φόντο,θέματα,λανθάνουσα μνήμη μενού,λανθάνουσα μνήμη,κρυφό, K-Μενού,σελιδοδείκτες,πρόσφατα έγγραφα,γρήγορος εξερευνητής,μενού εξερευνητή,μενού,εικονίδια,tiles,εφαρμογίδια,έναρξη,τονισμός,χειριστήρια, μεγέθυνση εικονιδίων
+Keywords[el]=kicker,πίνακας,kpanel,γραμμή εργασιών,γραμμή έναρξης,γραμμή εκκίνησης,τοποθεσία,μέγεθος,αυτόματη απόκρυψη,απόκρυψη,κουμπιά,εφέ κίνησης,φόντο,θέματα,λανθάνουσα μνήμη μενού,λανθάνουσα μνήμη,κρυφό, K-Μενού,σελιδοδείκτες,πρόσφατα έγγραφα,γρήγορος εξερευνητής,μενού εξερευνητή,μενού,εικονίδια,tiles,μικροεφαρμογές,έναρξη,τονισμός,χειριστήρια, μεγέθυνση εικονιδίων
 Keywords[eo]=lanĉilo,panelo,tasklistelo,situo,grandeco,aŭtokaŝo,kaŝo,butono,fono,etoso,menubufro,K-Menuo,legosigno,lasta dokumento,rapidrigardilo,rigardmenuo,piktogramo,kahelo,aplikaĵo,lanĉo,emfazo,teniloj,pligrandigo,fidindaj aplikaĵetoj,sekurecnivelo
 Keywords[es]=kicker,panel,kpanel,barra de tareas,barra de inicio,barra de lanzamiento,dirección,tamaño,auto ocultar,ocultar,botones,animación,fondo,temas,caché de menú,caché,oculto,Menú K,marcadores,documentos recientes,navegador rápido,menú navegador,menú,iconos,mosaicos,miniaplicaciones,arranque,resaltado,asas,iconos ampliados
 Keywords[et]=kicker,paneel,kpanel,tegumiriba,käivitusriba,asukoht,suurus,terminal,automaatne peitmine,peitmine,nupud,animatsioon,taust,teemad,menüü vahemälu,vahemälu,peidetud,K-menüü,järjehoidjad,viimati kasutatud dokumendid, kiirbrauser,lehitsemise menüü,menüü,ikoonid,apletid,käivitamine,esiletõstmine,piirded,ikoonide suurendamine,usaldusväärsed apletid,turvatase
Index: kcontrol/kicker/kicker_config_hiding.desktop
===================================================================
--- kcontrol/kicker/kicker_config_hiding.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/kicker/kicker_config_hiding.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -146,7 +146,7 @@
 Keywords[cy]=ciciwr,kicker,panel,kpanel,bar tasgau,bar cychwyn,bar lansio,lleoliad,maint,awto-guddio,hunan-guddio,cuddio,botymau,animeiddiad,cefndir,themâu,storfa dewislen, storfa,cache,celc,cudd,K-Menu,nodau tudalen,dogfenni diweddar,porydd cyflym,dewislen porydd,dewislen,eiconau,teiliau,rhaglenigion,ymcychwyn,amlygu,carnau,eiconau chwyddo
 Keywords[da]=kicker,panel,kpanel,opgavelinje,startlinje,sted,størrelse,autogem,gem,knapper,animering,baggrund,temaer,menucache,cache,skjult,K-Menu,bogmærker,nylige dokumenter,hurtigsøger,søgemenu,menu,ikoner,fliser,panelprogrammer,opstart,markér,håndterer,ikoner
 Keywords[de]=Kicker,Panel,Taskbar,Kontrollleiste,Startleiste,Klickstartleiste,Fensterleiste,Autom. ausblenden,Ausblenden, Knöpfe,Animation,Hintergründe,Stile,Design,Themes,Menü-Zwischenspeicher, K-Menü,Zwischenspeicher,Lesezeichen,Zuletzt geöffnete Dateien, Schnellanzeiger,Menüs,Symbole,Icons,Kacheln,Applets,Miniprogramme, Java-Miniprogramme,Hervorhebung,Anfasser,Sicherheitsstufen,Zoom für Symbole
-Keywords[el]=kicker,πίνακας,kpanel,γραμμή εργασιών,γραμμή έναρξης,γραμμή εκκίνησης,τοποθεσία,μέγεθος,αυτόματη απόκρυψη,απόκρυψη,κουμπιά,εφέ κίνησης,φόντο,θέματα,λανθάνουσα μνήμη μενού,λανθάνουσα μνήμη,κρυφό, K-Μενού,σελιδοδείκτες,πρόσφατα έγγραφα,γρήγορος εξερευνητής,μενού εξερευνητή,μενού,εικονίδια,tiles,εφαρμογίδια,έναρξη,τονισμός,χειριστήρια, μεγέθυνση εικονιδίων
+Keywords[el]=kicker,πίνακας,kpanel,γραμμή εργασιών,γραμμή έναρξης,γραμμή εκκίνησης,τοποθεσία,μέγεθος,αυτόματη απόκρυψη,απόκρυψη,κουμπιά,εφέ κίνησης,φόντο,θέματα,λανθάνουσα μνήμη μενού,λανθάνουσα μνήμη,κρυφό, K-Μενού,σελιδοδείκτες,πρόσφατα έγγραφα,γρήγορος εξερευνητής,μενού εξερευνητή,μενού,εικονίδια,tiles,μικροεφαρμογές,έναρξη,τονισμός,χειριστήρια, μεγέθυνση εικονιδίων
 Keywords[eo]=lanĉilo,panelo,tasklistelo,situo,grandeco,aŭtokaŝo,kaŝo,butono,fono,etoso,menubufro,K-Menuo,legosigno,lasta dokumento,rapidrigardilo,rigardmenuo,piktogramo,kahelo,aplikaĵo,lanĉo,emfazo,teniloj,pligrandigo,fidindaj aplikaĵetoj,sekurecnivelo
 Keywords[es]=kicker,panel,kpanel,barra de tareas,barra de inicio,barra de lanzamiento,dirección,tamaño,auto ocultar,ocultar,botones,animación,fondo,temas,caché de menú,caché,oculto,Menú K,marcadores,documentos recientes,navegador rápido,menú navegador,menú,iconos,mosaicos,miniaplicaciones,arranque,resaltado,asas,iconos ampliados
 Keywords[et]=kicker,paneel,kpanel,tegumiriba,käivitusriba,asukoht,suurus,terminal,automaatne peitmine,peitmine,nupud,animatsioon,taust,teemad,menüü vahemälu,vahemälu,peidetud,K-menüü,järjehoidjad,viimati kasutatud dokumendid, kiirbrauser,lehitsemise menüü,menüü,ikoonid,apletid,käivitamine,esiletõstmine,piirded,ikoonide suurendamine,usaldusväärsed apletid,turvatase
Index: kcontrol/kicker/kicker_config_menus.desktop
===================================================================
--- kcontrol/kicker/kicker_config_menus.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/kicker/kicker_config_menus.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -143,7 +143,7 @@
 Keywords[cy]=ciciwr,kicker,panel,kpanel,bar tasgau,bar cychwyn,bar lansio,lleoliad,maint,awto-guddio,hunan-guddio,cuddio,botymau,animeiddiad,cefndir,themâu,storfa dewislen, storfa,cache,celc,cudd,K-Menu,nodau tudalen,dogfenni diweddar,porydd cyflym,dewislen porydd,dewislen,eiconau,teiliau,rhaglenigion,ymcychwyn,amlygu,carnau,eiconau chwyddo
 Keywords[da]=kicker,panel,kpanel,opgavelinje,startlinje,sted,størrelse,autogem,gem,knapper,animering,baggrund,temaer,menucache,cache,skjult,K-Menu,bogmærker,nylige dokumenter,hurtigsøger,søgemenu,menu,ikoner,fliser,panelprogrammer,opstart,markér,håndterer,ikoner
 Keywords[de]=Kicker,Panel,Taskbar,Kontrollleiste,Startleiste,Klickstartleiste,Fensterleiste,Autom. ausblenden,Ausblenden, Knöpfe,Animation,Hintergründe,Stile,Design,Themes,Menü-Zwischenspeicher, K-Menü,Zwischenspeicher,Lesezeichen,Zuletzt geöffnete Dateien, Schnellanzeiger,Menüs,Symbole,Icons,Kacheln,Applets,Miniprogramme, Java-Miniprogramme,Hervorhebung,Anfasser,Sicherheitsstufen,Zoom für Symbole
-Keywords[el]=kicker,πίνακας,kpanel,γραμμή εργασιών,γραμμή έναρξης,γραμμή εκκίνησης,τοποθεσία,μέγεθος,αυτόματη απόκρυψη,απόκρυψη,κουμπιά,εφέ κίνησης,φόντο,θέματα,λανθάνουσα μνήμη μενού,λανθάνουσα μνήμη,κρυφό, K-Μενού,σελιδοδείκτες,πρόσφατα έγγραφα,γρήγορος εξερευνητής,μενού εξερευνητή,μενού,εικονίδια,tiles,εφαρμογίδια,έναρξη,τονισμός,χειριστήρια, μεγέθυνση εικονιδίων
+Keywords[el]=kicker,πίνακας,kpanel,γραμμή εργασιών,γραμμή έναρξης,γραμμή εκκίνησης,τοποθεσία,μέγεθος,αυτόματη απόκρυψη,απόκρυψη,κουμπιά,εφέ κίνησης,φόντο,θέματα,λανθάνουσα μνήμη μενού,λανθάνουσα μνήμη,κρυφό, K-Μενού,σελιδοδείκτες,πρόσφατα έγγραφα,γρήγορος εξερευνητής,μενού εξερευνητή,μενού,εικονίδια,tiles,μικροεφαρμογές,έναρξη,τονισμός,χειριστήρια, μεγέθυνση εικονιδίων
 Keywords[eo]=lanĉilo,panelo,tasklistelo,situo,grandeco,aŭtokaŝo,kaŝo,butono,fono,etoso,menubufro,K-Menuo,legosigno,lasta dokumento,rapidrigardilo,rigardmenuo,piktogramo,kahelo,aplikaĵo,lanĉo,emfazo,teniloj,pligrandigo,fidindaj aplikaĵetoj,sekurecnivelo
 Keywords[es]=kicker,panel,kpanel,barra de tareas,barra de inicio,barra de lanzamiento,dirección,tamaño,auto ocultar,ocultar,botones,animación,fondo,temas,caché de menú,caché,oculto,Menú K,marcadores,documentos recientes,navegador rápido,menú navegador,menú,iconos,mosaicos,miniaplicaciones,arranque,resaltado,asas,iconos ampliados
 Keywords[et]=kicker,paneel,kpanel,tegumiriba,käivitusriba,asukoht,suurus,terminal,automaatne peitmine,peitmine,nupud,animatsioon,taust,teemad,menüü vahemälu,vahemälu,peidetud,K-menüü,järjehoidjad,viimati kasutatud dokumendid, kiirbrauser,lehitsemise menüü,menüü,ikoonid,apletid,käivitamine,esiletõstmine,piirded,ikoonide suurendamine,usaldusväärsed apletid,turvatase
Index: kcontrol/privacy/privacy.desktop
===================================================================
--- kcontrol/privacy/privacy.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/privacy/privacy.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -38,7 +38,7 @@
 Comment[mk]=Приватност - kcontrol модул кој ги чисти несаканите траги кои ги остава корисникот на системот
 Comment[mn]=Privacy - систем дэх хэрэглэгчийн хэрэглэхгүй охрисон хог цэвэрлэгчийн хяналтын модул
 Comment[mt]=Privatezza - modulu ta' kcontrol biex tnaddaf traċċi li l-user jista' jħalli fuq is-sistema
-Comment[nb]=Personvern - en kcontrol-modul som fjerner uønskede spor som brukeren etterlater i systemet
+Comment[nb]=Personvern – en kcontrol-modul som fjerner uønskede spor som brukeren etterlater i systemet
 Comment[nds]=Privaatrebeet - Mit dit Moduul kannst Du de Bruuksporen vun't Systeem wegmaken
 Comment[ne]=गोप्यता - प्रयोगकर्ताले प्रणालीमा छोडेका नचाहेका पदचिन्ह हटाउन के नियन्त्रण मोड्युल
 Comment[nl]=Privacy - een configuratiemodule waarmee u ongewenste sporen die gebruikers achterlaten kunt wissen.
@@ -50,7 +50,7 @@
 Comment[ro]=Șterge urmele nedorite pe care le lasă un utilizator în sistem
 Comment[ru]=Модуль kcontrol, очищающий нежелательные следы, оставленные пользователем в операционной системе
 Comment[rw]=Umwihariko - igice k-igenzura ryo gusiba ibirango bidakenewe ukoresha yasize kuri sisitemu
-Comment[se]=Iežassuodjaleapmi - kcontrolmoduvla mii váldá eret luottaid maid geavaheaddji guođđa vuogádahkii
+Comment[se]=Iežassuodjaleapmi – kcontrolmoduvla mii váldá eret luottaid maid geavaheaddji guođđa vuogádahkii
 Comment[sk]=Modul pre vyčistenie nežiadúcich infomácií, ktoré užívateľ necháva v systéme
 Comment[sl]=Zasebnost - nadzorni modul, ki počisti nezaželene sledi, ki jih uporabnik pusti na sistemu
 Comment[sr]=Приватност — kcontrol модул који уклања трагове активности корисника на систему
Index: kcontrol/kio/cache.desktop
===================================================================
--- kcontrol/kio/cache.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/kio/cache.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -172,7 +172,7 @@
 Keywords[hi]=कैश,इतिहास,ब्राउज़िंग इतिहास,पोर्ट,आकार
 Keywords[hr]=Cache,Pohrana,History,Povijest,Browsing History,Ports,Portovi,Size,Veličina,Povijest pretraživanja
 Keywords[hu]=gyorstár,napló,böngészési napló,portok,méret
-Keywords[is]=Skyndiminni,Saga,Vafrasaga,Port,Stærð,Cache,History,Browsing History,Ports,Size
+Keywords[is]=Skyndiminni,Saga,Vafrasaga,Gáttir,Stærð
 Keywords[it]=cache,cronologia,navigazione,cronologia di navigazione,porte,dimensione
 Keywords[ja]=キャッシュ,履歴,ブラウズの履歴,ポート,サイズ
 Keywords[km]=ឃ្លាំង​សម្ងាត់,ប្រវត្តិ,ប្រវត្តិ​ការ​រុករក,ច្រក,ទំហំ
Index: kcontrol/kio/netpref.desktop
===================================================================
--- kcontrol/kio/netpref.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/kio/netpref.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -41,7 +41,7 @@
 Comment[mn]=Ерөнхий сүлжээ-Тохируулга тохируулах Ж.нь.Хугацаа хэтрэлтийн хугацаа
 Comment[ms]=Konfigur keutamaan rangkaian generik, seperti nilai waktu rehat
 Comment[mt]=Hawn tista' tagħżel preferenzi ġeneriċi tan-network, bħal ħinijiet ta' stennija
-Comment[nb]=Angi generelle nettverksinstillinger, f.eks. verdier for tidsavbrudd
+Comment[nb]=Angi generelle nettverksinnstillinger, f.eks. verdier for tidsavbrudd
 Comment[nds]=Standard-Nettwarkinstellen, as t.B. Tietgrenzen
 Comment[ne]=समय समाप्ति मान जस्तै जेनेरिक सञ्जाल प्राथमिकता कन्फिगर गर्नुहोस्
 Comment[nl]=Instellen van algemene netwerkvoorkeuren, zoals tijdslimietwaarden
Index: kcontrol/clock/clock.desktop
===================================================================
--- kcontrol/clock/clock.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/clock/clock.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -56,7 +56,7 @@
 Name[mn]=Огноо & Цаг
 Name[ms]=Tarikh & Masa
 Name[mt]=Data u Ħin
-Name[nb]=Dato og tid
+Name[nb]=Dato og klokkeslett
 Name[nds]=Datum & Tiet
 Name[ne]=मिति र समय
 Name[nl]=Datum en Tijd
@@ -138,11 +138,11 @@
 Comment[mn]=Огноо ба цаг тохируулах
 Comment[ms]=Seting tarikh & Masa
 Comment[mt]=Konfigurazzjoni tad-data u l-ħin
-Comment[nb]=Innstilling av dato og tid
+Comment[nb]=Innstilling av dato og klokkeslett
 Comment[nds]=Instellen vun Datum un Tiet
 Comment[ne]=मिति र समय सेटिङ
 Comment[nl]=Instellen van datum en tijd
-Comment[nn]=Innstilling av dato og tid
+Comment[nn]=Innstilling av dato og klokkeslett
 Comment[nso]=Dipeakanyo tsa tsatsikgwedi le nako
 Comment[oc]=Configuracion dèu dia e l'ora
 Comment[pa]=ਮਿਤੀ ਅਤੇ ਸਮਾਂ ਸੈਟਿੰਗ
Index: kcontrol/konqhtml/appearance.cpp
===================================================================
--- kcontrol/konqhtml/appearance.cpp	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/konqhtml/appearance.cpp	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -357,6 +357,11 @@
 
     updateGUI();
     emit changed( useDefaults );
+
+#undef SET_GROUP
+#undef READ_NUM
+#undef READ_ENTRY
+#undef READ_LIST
 }
 
 void KAppearanceOptions::defaults()
Index: kcontrol/konqhtml/khtml_fonts.desktop
===================================================================
--- kcontrol/konqhtml/khtml_fonts.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/konqhtml/khtml_fonts.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -186,7 +186,7 @@
 Keywords[is]=vafri,vefur,vefurinn,vefsíður,letur,litir,kóðun,stafatafla, bendill,myndir,www,html,stafir
 Keywords[it]=konqueror,kfm,browser,html,web,www,caratteri,colori,set di caratteri,charset,codifica
 Keywords[ja]=konqueror,kfm,ブラウザ,html,web,ウェブ,www,フォント,文字,文字セット,色,カラー,エンコーディング
-Keywords[km]=konqueror,kfm,កម្មវិធី​រុករក,html,បណ្ដាញ,វើលវ៉ាយវិប,ពុម្ពអក្សរ,សំណុំ​តួអក្សរ
+Keywords[km]=konqueror,kfm,កម្មវិធី​រុករក,html,បណ្ដាញ,វើលវ៉ាយវិប,ពុម្ពអក្សរ,ការ​អ៊ិនកូដ
 Keywords[lt]=konqueror,kfm,browser,html,web,www,fonts,colours,colors,charsets,character sets,encodingsets,encoding,narašymas,html,tinklalapis,tinklapis,www,šriftai,spalvos,simbolių rinkiniai,koduotė
 Keywords[lv]=iekarotājs,kfm,pārlūks,html,web,www,fonti,krāsojums,krāsas,java,javaskripts,kursors,saites,attēli,simbolukomplekti,simbolu komplekti,kodējums
 Keywords[mk]=konqueror,kfm,browser,html,web,www,fonts,charsets,character sets,encoding,прелистувач,веб,фонтови,знаковни множества,кодирање
Index: kcontrol/konqhtml/htmlopts.cpp
===================================================================
--- kcontrol/konqhtml/htmlopts.cpp	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/konqhtml/htmlopts.cpp	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -277,6 +277,10 @@
     m_pOnlyMarkedBookmarksCheckBox->setChecked( config.readBoolEntry("FilteredToolbar", false) );
 
 	 emit changed( useDefaults );
+
+#undef READ_ENTRY
+#undef READ_BOOL
+#undef SET_GROUP
 }
 
 void KMiscHTMLOptions::defaults()
Index: kcontrol/style/style.desktop
===================================================================
--- kcontrol/style/style.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/style/style.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -173,7 +173,7 @@
 Keywords[da]=stil,udseende,kontrol,ikoner,værktøjslinjer,tekst,fremhæv,prog,KDE-programmer
 Keywords[de]=Stile,Design,Themes,Schema,Elemente,Bildschirmelemente,Icons,Bedienelemente,Schriften,Symbole,Werkzeugleisten,Text,Hervorhebungen,Knöpfe,Anwendungen,Programme,KDE-Programme
 Keywords[el]=στυλ,στυλ,εμφάνιση,γραφικό συστατικό,εικονίδια,γραμμές εργαλείων,κείμενο,τονισμός,εφαρμογές,εφαρμογές KDE
-Keywords[eo]=stilo,aspekto,fenestraĵo,piktogramo,illistelo,aplikaĵoj
+Keywords[eo]=stilo,aspekto,fenestraĵo,piktogramo,ilobreto,aplikaĵoj
 Keywords[es]=estilo,estilos,temas,aspecto,objeto visual,widget,texto,resaltado,botones, aplicaciones, aplicaciones KDE
 Keywords[et]=stiil,stiilid,teemad,välimus,elemendid,vidinad,menüüriba,ikoonid, tööriistaribad,rakendused,KDE rakendused
 Keywords[eu]=estiloa,estiloak,itxura,widget-a,ikonoak,tresna-barrak,testua, nabarmenketa,aplikazioak,KDE aplikazioak
Index: kcontrol/konsole/kcmkonsole.desktop
===================================================================
--- kcontrol/konsole/kcmkonsole.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/konsole/kcmkonsole.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -34,7 +34,6 @@
 Name[pa]=ਕੰਨਸੋਲ
 Name[pl]=Konsola
 Name[ro]=Consolă
-Name[ru]=Консоль
 Name[se]=Konsolla
 Name[sk]=Konzola
 Name[sl]=Konzola
Index: kcontrol/kdm/kdm-users.cpp
===================================================================
--- kcontrol/kdm/kdm-users.cpp	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/kdm/kdm-users.cpp	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -418,7 +418,8 @@
 	      setOn(selectedUsers.find(*name) != selectedUsers.end());
       (new QCheckListItem(optoutlv, *name, QCheckListItem::CheckBox))->
 	      setOn(hiddenUsers.find(*name) != hiddenUsers.end());
-      usercombo->insertItem(*name);
+      if ((*name)[0] != '@')
+        usercombo->insertItem(*name);
     }
     optinlv->sort();
     optoutlv->sort();
Index: kcontrol/kdm/kdm-appear.cpp
===================================================================
--- kcontrol/kdm/kdm-appear.cpp	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/kdm/kdm-appear.cpp	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -172,6 +172,7 @@
   guicombo = new KBackedComboBox(group);
   guicombo->insertItem( "", i18n("<default>") );
   loadGuiStyles(guicombo);
+  guicombo->listBox()->sort();
   label = new QLabel(guicombo, i18n("GUI s&tyle:"), group);
   connect(guicombo, SIGNAL(activated(int)), SLOT(changed()));
   hglay->addWidget(label, 0, 0);
@@ -184,6 +185,7 @@
   colcombo = new KBackedComboBox(group);
   colcombo->insertItem( "", i18n("<default>") );
   loadColorSchemes(colcombo);
+  colcombo->listBox()->sort();
   label = new QLabel(colcombo, i18n("&Color scheme:"), group);
   connect(colcombo, SIGNAL(activated(int)), SLOT(changed()));
   hglay->addWidget(label, 1, 0);
Index: kcontrol/dnssd/configdialog.ui
===================================================================
--- kcontrol/dnssd/configdialog.ui	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kcontrol/dnssd/configdialog.ui	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -289,6 +289,9 @@
 <slots>
     <slot>radioButton2_2_toggled(bool)</slot>
 </slots>
+<includes>
+    <include location="global" impldecl="in declaration">kcmodule.h</include>
+</includes>
 <layoutdefaults spacing="6" margin="11"/>
 <includehints>
     <includehint>kcmodule.h</includehint>
Index: pics/wallpapers/stelvio.jpg.desktop
===================================================================
--- pics/wallpapers/stelvio.jpg.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ pics/wallpapers/stelvio.jpg.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -12,6 +12,7 @@
 Name[ru]=Национальный парк Стельвио
 Name[sr]=Стелвио
 Name[te]=స్టెల్వియో
+Name[tg]=Стелвио
 Name[uz]=Стелвио
 Name[zh_CN]=孤堡
 ImageType=pixmap
Index: kdmlib/kgreet_classic.cpp
===================================================================
--- kdmlib/kgreet_classic.cpp	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdmlib/kgreet_classic.cpp	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -213,6 +213,7 @@
 	curUser = user;
 	loginEdit->setText( user );
 	passwdEdit->setFocus();
+	passwdEdit->selectAll();
 }
 
 void // virtual
Index: kdmlib/dmctl.cpp
===================================================================
--- kdmlib/dmctl.cpp	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdmlib/dmctl.cpp	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -65,21 +65,28 @@
 		if ((fd = ::socket( PF_UNIX, SOCK_STREAM, 0 )) < 0)
 			return;
 		sa.sun_family = AF_UNIX;
-		if (DMType == GDM)
-			strcpy( sa.sun_path, "/tmp/.gdm_socket" );
-		else {
+		if (DMType == GDM) {
+			strcpy( sa.sun_path, "/var/run/gdm_socket" );
+			if (::connect( fd, (struct sockaddr *)&sa, sizeof(sa) )) {
+				strcpy( sa.sun_path, "/tmp/.gdm_socket" );
+				if (::connect( fd, (struct sockaddr *)&sa, sizeof(sa) )) {
+					::close( fd );
+					fd = -1;
+					break;
+				}
+			}
+			GDMAuthenticate();
+		} else {
 			if ((ptr = strchr( dpy, ':' )))
 				ptr = strchr( ptr, '.' );
 			snprintf( sa.sun_path, sizeof(sa.sun_path),
 			          "%s/dmctl-%.*s/socket",
-			          ctl, ptr ? ptr - dpy : 512, dpy );
+			          ctl, ptr ? int(ptr - dpy) : 512, dpy );
+			if (::connect( fd, (struct sockaddr *)&sa, sizeof(sa) )) {
+				::close( fd );
+				fd = -1;
+			}
 		}
-		if (::connect( fd, (struct sockaddr *)&sa, sizeof(sa) )) {
-			::close( fd );
-			fd = -1;
-		}
-		if (DMType == GDM)
-			GDMAuthenticate();
 		break;
 	case OldKDM:
 		{
Index: kdmlib/kgreet_winbind.cpp
===================================================================
--- kdmlib/kgreet_winbind.cpp	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdmlib/kgreet_winbind.cpp	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -293,6 +293,7 @@
 	slotChangedDomain( dom );
 	loginEdit->setText( usr );
 	passwdEdit->setFocus();
+	passwdEdit->selectAll();
 }
 
 void // virtual
Index: khelpcenter/plugins/applets.desktop
===================================================================
--- khelpcenter/plugins/applets.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ khelpcenter/plugins/applets.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -14,7 +14,7 @@
 Name[cy]=Llawlyfr Rhaglennig
 Name[da]=Panelprogrammanualer
 Name[de]=Handbücher zu Miniprogrammen (Applets)
-Name[el]=Εγχειρίδια εφαρμογιδίων
+Name[el]=Εγχειρίδια μικροεφαρμογών
 Name[eo]=Manlibroj de Aplikaĵoj
 Name[es]=Manuales de las miniaplicaciones
 Name[et]=Aplettide käsiraamatud
Index: khelpcenter/plugins/Tutorials/.directory
===================================================================
--- khelpcenter/plugins/Tutorials/.directory	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ khelpcenter/plugins/Tutorials/.directory	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -15,7 +15,9 @@
 Name[fo]=Skeið
 Name[fr]=Didactitiels
 Name[hr]=Praktični vodič
+Name[hu]=Bevezetők
 Name[id]=Tutorial
+Name[is]=Kennsluefni
 Name[it]=Esercitazioni
 Name[ja]=チュートリアル
 Name[km]=បង្រៀន
@@ -31,6 +33,7 @@
 Name[pt]=Tutoriais
 Name[pt_BR]=Tutoriais
 Name[ro]=Tutoriale
+Name[ru]=Обучение
 Name[sk]=Úvody
 Name[sl]=Učbeniki
 Name[sr]=Туторијали
@@ -63,7 +66,9 @@
 Comment[fr]=Didactitiels et documents de présentation
 Comment[hi]=शिक्षण पाठ तथा परिचय दस्तावेज़
 Comment[hr]=Praktični vodič i uvodni dokumenti.
+Comment[hu]=Bevezető jellegű dokumentumok.
 Comment[id]=Tutorial dan dokumen Pengenalan 
+Comment[is]=Kennslu- og kynningarefni.
 Comment[it]=Esercitazione e documenti introduttivi.
 Comment[ja]=チュートリアルと導入用ドキュメント
 Comment[km]=ឯកសារ​បង្រៀន និង​ណែនាំ ។
@@ -82,6 +87,7 @@
 Comment[pt]=Tutoriais e documentos introdutórios.
 Comment[pt_BR]=Tutoriais e documentos introdutórios.
 Comment[ro]=Documente introductive și tutoriale.
+Comment[ru]=Документы по обучению.
 Comment[sk]=Úvodné a predstavujúce dokumenty.
 Comment[sl]=Učbenik in uvodni dokumenti
 Comment[sr]=Туторијали и уводни документи.
Index: khelpcenter/plugins/Applications/.directory
===================================================================
--- khelpcenter/plugins/Applications/.directory	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ khelpcenter/plugins/Applications/.directory	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -16,6 +16,8 @@
 Name[fr]=Manuels des applications
 Name[hi]=अनुप्रयोग निर्देशिका
 Name[hr]=Priručnici aplikacija
+Name[hu]=Alkalmazások kézikönyvei
+Name[is]=Handbækur forrita
 Name[it]=Manuali applicazione
 Name[ja]=アプリケーションマニュアル
 Name[km]=សៀវភៅ​​កម្មវិធី
@@ -32,6 +34,7 @@
 Name[pt]=Manuais das Aplicações
 Name[pt_BR]=Manuais de Aplicativos
 Name[ro]=Manualele aplicațiilor
+Name[ru]=Руководства приложений
 Name[sk]=Aplikačné manuály
 Name[sl]=Priročniki za programe
 Name[sr]=Упутства за програме
Index: khelpcenter/plugins/Manpages/.directory
===================================================================
--- khelpcenter/plugins/Manpages/.directory	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ khelpcenter/plugins/Manpages/.directory	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -15,6 +15,8 @@
 Name[fr]=Pages du manuel UNIX
 Name[hi]=यूनिक्स निर्देशिका पृष्ठ
 Name[hr]=UNIX priručnici
+Name[hu]=UNIX man oldalak
+Name[is]=Síður UNIX handbóka
 Name[it]=Pagine manuale UNIX
 Name[ja]=UNIX マニュアルページ
 Name[km]=ទំព័រ​សៀវភៅ​របស់​យូនីក
@@ -31,6 +33,7 @@
 Name[pt]=Páginas de manual do UNIX
 Name[pt_BR]=Páginas de manual do UNIX
 Name[ro]=Pagini de manual UNIX
+Name[ru]=Страницы руководств UNIX
 Name[sk]=UNIX-ové manuálové stránky
 Name[sl]=Strani priročnika za UNIX
 Name[sr]=UNIX упутне стране
Index: doc/faq/about.docbook
===================================================================
--- doc/faq/about.docbook	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ doc/faq/about.docbook	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -18,8 +18,7 @@
 <para>First, send us any errors that you may find.  Also, any
 suggestions that you might have, are appreciated.  Better yet, send us
 everything  that you think is unclear, and if possible, send us what
-you think would be a clearer solution.  Our email address is
-<email>faq@kde.org</email>.
+you think would be a clearer solution. The email address of the current maintainer is <email>jhall@kde.org</email>.
 </para>
 
 <para>Second, send us your solutions of those frequently-asked
@@ -69,4 +68,5 @@
 sgml-local-catalogs:nil
 sgml-local-ecat-files:nil
 End:
--->
\ brakuje znaku końca linii na końcu pliku 
+-->
+
Index: klipper/klipperrc.desktop
===================================================================
--- klipper/klipperrc.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ klipper/klipperrc.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -430,7 +430,7 @@
 Description[mn]=&URL илгээх
 Description[ms]=Hantar &URL
 Description[mt]=Ibgħat &URL
-Description[nb]=Send &Nettadressa
+Description[nb]=Send &Nettadressen
 Description[nds]=&URL schicken
 Description[ne]=यूआरएल पठाउनुहोस्
 Description[nl]=&URL-adres verzenden
@@ -1200,7 +1200,7 @@
 Description[mn]=&URL илгээх
 Description[ms]=Hantar &URL
 Description[mt]=Ibgħat &URL
-Description[nb]=Send &Nettadressa
+Description[nb]=Send &Nettadressen
 Description[nds]=&URL schicken
 Description[ne]=यूआरएल पठाउनुहोस्
 Description[nl]=&URL-adres verzenden
@@ -1417,7 +1417,7 @@
 Description[mn]=&URL илгээх
 Description[ms]=Hantar &URL
 Description[mt]=Ibgħat &URL
-Description[nb]=Send &Nettadressa
+Description[nb]=Send &Nettadressen
 Description[nds]=&URL schicken
 Description[ne]=यूआरएल पठाउनुहोस्
 Description[nl]=&URL-adres verzenden
@@ -1879,7 +1879,7 @@
 Description[mn]=&URL илгээх
 Description[ms]=Hantar &URL
 Description[mt]=Ibgħat &URL
-Description[nb]=Send &Nettadressa
+Description[nb]=Send &Nettadressen
 Description[nds]=&URL schicken
 Description[ne]=यूआरएल पठाउनुहोस्
 Description[nl]=&URL-adres verzenden
@@ -1996,7 +1996,7 @@
 
 [General]
 KeepClipboardContents=true
-No Actions for WM_CLASS=Navigator,navigator:browser,konqueror,keditbookmarks,mozilla-bin,Mozilla,Opera main window,opera,gnumeric,Gnumeric,Galeon,kcontrol,ksirc,MozillaFirebird-bin,firefox-bin,Firefox-bin,klipper,Gecko
+No Actions for WM_CLASS=Navigator,navigator:browser,konqueror,keditbookmarks,mozilla-bin,Mozilla,Opera main window,opera,gnumeric,Gnumeric,Galeon,kcontrol,ksirc,MozillaFirebird-bin,firefox-bin,Firefox-bin,klipper,Gecko,gecko
 Number of Actions=7
 PopupAtMousePosition=false
 URLGrabberEnabled=false
Index: kicker/menuext/kdeprint/printmenu.desktop
===================================================================
--- kicker/menuext/kdeprint/printmenu.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kicker/menuext/kdeprint/printmenu.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -36,6 +36,7 @@
 Name[kk]=Басып шығару
 Name[km]=ប្រព័ន្ធ​បោះពុម្ព
 Name[ko]=인쇄 시스템
+Name[ku]=Pergala Çapkirinê
 Name[lo]=ລະບົບການພິມ
 Name[lt]=Spausdinimo sistema
 Name[lv]=Drukas Sistēma
Index: kicker/extensions/kasbar/kasbarextension.desktop
===================================================================
--- kicker/extensions/kasbar/kasbarextension.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kicker/extensions/kasbar/kasbarextension.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -41,7 +41,7 @@
 Comment[cy]=Rhaglennig bar tasgau arall i'r panel
 Comment[da]=Et alternativt opgavelinjepanelprogram.
 Comment[de]=Eine alternative Fensterleiste
-Comment[el]=Ένα εναλλακτικό εφαρμογίδιο γραμμής εργασιών για τον πίνακα.
+Comment[el]=Μία εναλλακτική μικροεφαρμογή γραμμής εργασιών για τον πίνακα.
 Comment[eo]=Alternativa taskostria panelaplikaĵeto
 Comment[es]=Barra de tareas alternativa (miniaplicación del panel).
 Comment[et]=Teistsugune paneelil töötav tegumiriba aplett
Index: kicker/kicker/panel.desktop
===================================================================
--- kicker/kicker/panel.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kicker/kicker/panel.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -36,6 +36,7 @@
 Name[kk]=KDE панелі
 Name[km]=បន្ទះ KDE
 Name[ko]=KDE 패널
+Name[ku]=Panela KDE'yê
 Name[lo]=ຖາດພາເນລຂອง KDE
 Name[lt]=KDE pultas
 Name[lv]=KDE Panelis
Index: kicker/applets/menu/menuapplet.desktop
===================================================================
--- kicker/applets/menu/menuapplet.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kicker/applets/menu/menuapplet.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -70,7 +70,7 @@
 Comment[cy]=Rhaglennig sy'n mewn-adeiladu bariau dewislen unigol
 Comment[da]=Applet der indlejrer alenestående menulinjer
 Comment[de]=Programm zur Einbettung einzelner Menüleisten
-Comment[el]=Εφαρμογίδιο που ενσωματώνει αυτόνομες γραμμές μενού
+Comment[el]=Μικροεφαρμογή που ενσωματώνει αυτόνομες γραμμές μενού
 Comment[eo]=Aplikaĵeniganta solfunkcia menuzono
 Comment[es]=Una miniaplicación que incluye barras de menú autónomas
 Comment[et]=Aplett, mis põimib endasse isseisvaid menüüribasid
Index: kicker/applets/systemtray/systemtrayapplet.desktop
===================================================================
--- kicker/applets/systemtray/systemtrayapplet.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kicker/applets/systemtray/systemtrayapplet.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -94,7 +94,7 @@
 Comment[cy]=Rhaglennig bar tasgau i'r panel
 Comment[da]=Statusfelt-panelprogrammet
 Comment[de]=Systemabschnitt der Kontrollleiste
-Comment[el]=Εφαρμογίδιο του πίνακα για το πλαίσιο συστήματος
+Comment[el]=Μικροεφαρμογή του πίνακα για το πλαίσιο συστήματος
 Comment[eo]=La sistempleta panelaplikaĵeto
 Comment[es]=La bandeja del sistema (miniaplicación del panel)
 Comment[et]=Paneelil töötav süsteemse doki aplett
Index: kicker/applets/swallow/swallowapplet.desktop
===================================================================
--- kicker/applets/swallow/swallowapplet.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kicker/applets/swallow/swallowapplet.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -14,7 +14,7 @@
 Name[cy]=Rhaglennig Llyncu
 Name[da]=Swallow-panelprogram
 Name[de]=Einbettungsprogramm
-Name[el]=Ενσωμάτωση εφαρμογίδιου
+Name[el]=Ενσωμάτωση μικροεφαρμογής
 Name[eo]=Sistemaplikaĵetejo
 Name[es]=Miniaplicación contenedora
 Name[et]=Põimimise aplett
@@ -81,7 +81,7 @@
 Comment[cy]=Rhaglennig llyncu i'r panel
 Comment[da]=Swallow-panelprogrammet
 Comment[de]=Leiste zum Einbetten von X-Anwendungen
-Comment[el]=Εφαρμογίδιο του πίνακα που "καταπίνει"
+Comment[el]=Μικροεφαρμογή του πίνακα που "καταπίνει"
 Comment[eo]=La panelaplikaĵeto enhavanta la dokitajn programojn
 Comment[es]=La miniaplicación del panel contenedora
 Comment[et]=Paneelil töötav põimimise aplett
Index: kioslave/media/services/media_unmount.desktop
===================================================================
--- kioslave/media/services/media_unmount.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kioslave/media/services/media_unmount.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -79,7 +79,7 @@
 Name[wa]=Dismonter
 Name[xh]=Sukuyilayisha
 Name[zh_CN]=卸载
-Name[zh_TW]=未掛載
+Name[zh_TW]=卸載
 Name[zu]=Yehlisa
 Exec=kio_media_mounthelper -u %u
 
Index: kioslave/media/mediamanager/halbackend.cpp
===================================================================
--- kioslave/media/mediamanager/halbackend.cpp	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kioslave/media/mediamanager/halbackend.cpp	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -74,7 +74,10 @@
         const QPtrList<Medium> medlist = m_mediaList.list();
         QPtrListIterator<Medium> it (medlist);
         for ( const Medium *current_medium = it.current(); current_medium; current_medium = ++it)
-	    unmount(current_medium->id());
+        {
+            if( !current_medium->id().startsWith( "/org/kde" ))
+                unmount(current_medium->id());
+        }
 
 
         /* Remove all the registered media first */
@@ -262,6 +265,8 @@
             (libhal_device_get_property_QString(m_halContext, udi, "storage.drive_type") == "zip") ||
             (libhal_device_get_property_QString(m_halContext, udi, "storage.drive_type") == "jaz"))
         {
+            if (! libhal_device_get_property_bool(m_halContext, udi, "storage.removable.media_available", NULL) )
+                allowNotification = false;
             /* Create medium */
             Medium* medium = new Medium(udi, "");
             // if the storage has a volume, we ignore it
@@ -295,11 +300,13 @@
 
 void HALBackend::ModifyDevice(const char *udi, const char* key)
 {
-    Q_UNUSED(key);
     const char* mediumUdi = findMediumUdiFromUdi(udi);
     if (!mediumUdi)
         return;
-    ResetProperties(mediumUdi);
+    bool allowNotification = false;
+    if (strcmp(key, "storage.removable.media_available") == 0)
+        allowNotification = libhal_device_get_property_bool(m_halContext, udi, key, NULL);
+    ResetProperties(mediumUdi, allowNotification);
 }
 
 void HALBackend::DeviceCondition(const char* udi, const char* condition)
@@ -379,7 +386,7 @@
     return NULL;
 }
 
-void HALBackend::ResetProperties(const char* mediumUdi)
+void HALBackend::ResetProperties(const char* mediumUdi, bool allowNotification)
 {
     kdDebug(1219) << "HALBackend::setProperties" << endl;
     if ( QString::fromLatin1( mediumUdi ).startsWith( "/org/kde/" ) )
@@ -390,7 +397,7 @@
             Medium m( *cmedium );
             if ( setFstabProperties( &m ) ) {
                 kdDebug() << "setFstabProperties worked" << endl;
-                m_mediaList.changeMediumState(m, false);
+                m_mediaList.changeMediumState(m, allowNotification);
             }
             return;
        }
@@ -405,7 +412,7 @@
     if (libhal_device_query_capability(m_halContext, mediumUdi, "camera", NULL))
         setCameraProperties(m);
 
-    m_mediaList.changeMediumState(*m, false);
+    m_mediaList.changeMediumState(*m, allowNotification);
 
     delete m;
 }
@@ -612,44 +619,49 @@
     LibHalDrive*  halDrive  = libhal_drive_from_udi(m_halContext, udi);
     if (!halDrive)
         return false;
-    int numVolumes;
-    char** volumes = libhal_drive_find_all_volumes(m_halContext, halDrive, &numVolumes);
-    kdDebug(1219) << " found " << numVolumes << " volumes" << endl;
-    if (numVolumes)
-    {
-        free(volumes);
-        libhal_drive_free(halDrive);
-        return false;
+
+    QString drive_type = libhal_device_get_property_QString(m_halContext, udi, "storage.drive_type");
+
+    if (drive_type == "zip") {
+        int numVolumes;
+        char** volumes = libhal_drive_find_all_volumes(m_halContext, halDrive, &numVolumes);
+        libhal_free_string_array(volumes);
+        kdDebug(1219) << " found " << numVolumes << " volumes" << endl;
+        if (numVolumes)
+        {
+            libhal_drive_free(halDrive);
+            return false;
+        }
     }
 
-    medium->setName(
-        generateName(libhal_drive_get_device_file(halDrive)) );
+    medium->setName( generateName(libhal_drive_get_device_file(halDrive)) );
+    medium->setLabel(i18n("Unknown Drive"));
 
     // HAL hates floppies - so we have to do it twice ;(
     medium->mountableState(libhal_drive_get_device_file(halDrive), QString::null, QString::null, false);
     setFloppyMountState(medium);
 
-    if (libhal_device_get_property_QString(m_halContext, udi, "storage.drive_type") == "floppy")
+    if (drive_type == "floppy")
     {
         if (medium->isMounted()) // don't use _SUFFIX here as it accesses the volume
             medium->setMimeType("media/floppy_mounted" );
         else
             medium->setMimeType("media/floppy_unmounted");
+        medium->setLabel(i18n("Floppy Drive"));
     }
-
-    if (libhal_device_get_property_QString(m_halContext, udi, "storage.drive_type") == "zip")
+    else if (drive_type == "zip") 
     {
         if (medium->isMounted())
             medium->setMimeType("media/zip_mounted" );
         else
             medium->setMimeType("media/zip_unmounted");
+        medium->setLabel(i18n("Zip Drive"));
     }
 
     /** @todo And mimtype for JAZ drives ? */
 
     medium->setIconName(QString::null);
 
-    free(volumes);
     libhal_drive_free(halDrive);
 
     return true;
Index: kioslave/media/mediamanager/halbackend.h
===================================================================
--- kioslave/media/mediamanager/halbackend.h	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kioslave/media/mediamanager/halbackend.h	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -128,7 +128,7 @@
 	/**
 	* Reset properties for the given medium
 	*/
-	void ResetProperties(const char* MediumUdi);
+	void ResetProperties(const char* MediumUdi, bool allowNotification=false);
 
 	/**
 	* Find the medium that is concerned with device udi
Index: kioslave/ldap/kio_ldap.cpp
===================================================================
--- kioslave/ldap/kio_ldap.cpp	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kioslave/ldap/kio_ldap.cpp	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -269,6 +269,7 @@
       }
       ldap_value_free_len(bvals);
     }
+    ldap_memfree( name );
     // next attribute
     name = ldap_next_attribute(mLDAP, message, entry);
   }
Index: kioslave/thumbnail/thumbnail.cpp
===================================================================
--- kioslave/thumbnail/thumbnail.cpp	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kioslave/thumbnail/thumbnail.cpp	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -404,6 +404,8 @@
             shmdt((char*)shmaddr);
             return;
         }
+        if( img.depth() != 32 )           // KIO::PreviewJob and this code below completely
+            img = img.convertDepth( 32 ); // ignores colortable :-/, so make sure there is none
         stream << img.width() << img.height() << img.depth()
                << img.hasAlphaBuffer();
         memcpy(shmaddr, img.bits(), img.numBytes());
Index: kioslave/home/homeimpl.h
===================================================================
--- kioslave/home/homeimpl.h	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kioslave/home/homeimpl.h	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -40,9 +40,6 @@
 	bool listHomes(QValueList<KIO::UDSEntry> &list);
 	
 	void createTopLevelEntry(KIO::UDSEntry &entry) const;
-	
-	int lastErrorCode() const { return m_lastErrorCode; }
-	QString lastErrorMessage() const { return m_lastErrorMessage; }
 
 private slots:
 	void slotStatResult(KIO::Job *job);
@@ -54,11 +51,6 @@
 	KIO::UDSEntry m_entryBuffer;
 		
 	
-	/// Last error code stored in class to simplify API.
-	/// Note that this means almost no method can be const.
-	int m_lastErrorCode;
-	QString m_lastErrorMessage;
-
 	long m_effectiveUid;
 };
 
Index: kioslave/home/kio_home.cpp
===================================================================
--- kioslave/home/kio_home.cpp	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kioslave/home/kio_home.cpp	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -79,7 +79,7 @@
 
 	if ( !m_impl.realURL(name, path, newUrl) )
 	{
-		error( m_impl.lastErrorCode(), m_impl.lastErrorMessage() );
+		error(KIO::ERR_MALFORMED_URL, url.prettyURL());
 		return false;
 	}
 
@@ -116,9 +116,9 @@
 	KIO::UDSEntryList home_entries;
 	bool ok = m_impl.listHomes(home_entries);
 
-	if (!ok)
+	if (!ok) // can't happen
 	{
-		error( m_impl.lastErrorCode(), m_impl.lastErrorMessage() );
+		error(KIO::ERR_UNKNOWN, "");
 		return;
 	}
 
Index: kdeprint/printmgr/printers.desktop
===================================================================
--- kdeprint/printmgr/printers.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdeprint/printmgr/printers.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -126,11 +126,11 @@
 Comment[mn]=Хэвлэх системийн тохируулга(Хэвлэгч,Даалгавар, Ангиуд...)
 Comment[ms]=Konfigurasi sistem pencetakan [pencetak, kerja, kelas, ...)
 Comment[mt]=Konfigurazzjoni tas-sistema tal-ipprintjar (printers, xogħol, klassijiet, ...)
-Comment[nb]=Tilpass utskriftssystemet (skrivere, jobber, klasser ...)
+Comment[nb]=Tilpass utskriftssystemet (skrivere, jobber, klasser …)
 Comment[nds]=Instellen för dat Drucksysteem (Druckers, Opgaven, Klassen, ...)
 Comment[ne]=मुद्रण प्रणाली कन्फिगरेसन (मुद्रक, कार्य, बग, ...)
 Comment[nl]=Configuratie van het afdruksysteem (printers, taken, klassen, ...)
-Comment[nn]=Oppsett av utskriftssystem (skrivarar, jobbar, klassar, ...)
+Comment[nn]=Oppsett av utskriftssystem (skrivarar, jobbar, klassar, …)
 Comment[nso]=Peakanyo ya system ya kgatiso (digatisi, mesomo, maemo,...)
 Comment[pa]=ਪਰਿੰਟਿੰਗ ਸਿਸਟਮ ਸੰਰਚਨਾ (ਪਰਿੰਟਰ, ਕੰਮ, ਕਲਾਸ, ...)
 Comment[pl]=Konfiguracja systemu drukowania (drukarki, zadania, klasy, ...)
Index: nsplugins/sdk/prcpucfg.h
===================================================================
--- nsplugins/sdk/prcpucfg.h	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ nsplugins/sdk/prcpucfg.h	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -276,7 +276,7 @@
 #define PR_BYTES_PER_WORD_LOG2   2
 #define PR_BYTES_PER_DWORD_LOG2  3
 
-#elif defined(__sparc__)
+#elif defined(__sparc__) || (defined(__SUNPRO_CC) && defined(__sparc))
 
 #undef	IS_LITTLE_ENDIAN
 #define	IS_BIG_ENDIAN 1
@@ -321,7 +321,7 @@
 #define PR_BYTES_PER_WORD_LOG2   2
 #define PR_BYTES_PER_DWORD_LOG2  3
 
-#elif defined(__i386__)
+#elif defined(__i386__) || (defined(__SUNPRO_CC) && defined(__i386))
 
 #define IS_LITTLE_ENDIAN 1
 #undef  IS_BIG_ENDIAN
Index: nsplugins/sdk/npruntime.h
===================================================================
--- nsplugins/sdk/npruntime.h	(.../tags/KDE/3.5.8/kdebase)	(wersja 0)
+++ nsplugins/sdk/npruntime.h	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -0,0 +1,399 @@
+/* -*- Mode: C; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- */
+/*
+ * Copyright � 2004, Apple Computer, Inc. and The Mozilla Foundation. 
+ * All rights reserved.
+ * 
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions are
+ * met:
+ * 
+ * 1. Redistributions of source code must retain the above copyright
+ * notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ * notice, this list of conditions and the following disclaimer in the
+ * documentation and/or other materials provided with the distribution.
+ * 3. Neither the names of Apple Computer, Inc. ("Apple") or The Mozilla
+ * Foundation ("Mozilla") nor the names of their contributors may be used
+ * to endorse or promote products derived from this software without
+ * specific prior written permission.
+ * 
+ * THIS SOFTWARE IS PROVIDED BY APPLE, MOZILLA AND THEIR CONTRIBUTORS "AS
+ * IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
+ * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
+ * PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL APPLE, MOZILLA OR
+ * THEIR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
+ * TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
+ * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
+ * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
+ * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+ *
+ * Revision 1 (March 4, 2004):
+ * Initial proposal.
+ *
+ * Revision 2 (March 10, 2004):
+ * All calls into script were made asynchronous.  Results are
+ * provided via the NPScriptResultFunctionPtr callback.
+ *
+ * Revision 3 (March 10, 2004):
+ * Corrected comments to not refer to class retain/release FunctionPtrs.
+ *
+ * Revision 4 (March 11, 2004):
+ * Added additional convenience NPN_SetExceptionWithUTF8().
+ * Changed NPHasPropertyFunctionPtr and NPHasMethodFunctionPtr to take NPClass
+ * pointers instead of NPObject pointers.
+ * Added NPIsValidIdentifier().
+ *
+ * Revision 5 (March 17, 2004):
+ * Added context parameter to result callbacks from ScriptObject functions.
+ *
+ * Revision 6 (March 29, 2004):
+ * Renamed functions implemented by user agent to NPN_*.  Removed _ from
+ * type names.
+ * Renamed "JavaScript" types to "Script".
+ *
+ * Revision 7 (April 21, 2004):
+ * NPIdentifier becomes a void*, was int32_t
+ * Remove NP_IsValidIdentifier, renamed NP_IdentifierFromUTF8 to NP_GetIdentifier
+ * Added NPVariant and modified functions to use this new type.
+ *
+ * Revision 8 (July 9, 2004):
+ * Updated to joint Apple-Mozilla license.
+ *
+ */
+#ifndef _NP_RUNTIME_H_
+#define _NP_RUNTIME_H_
+
+#include <qglobal.h>
+typedef Q_UINT32 uint32_t;
+
+#ifdef __cplusplus
+extern "C" {
+#endif
+
+
+/*
+    This API is used to facilitate binding code written in C to script
+    objects.  The API in this header does not assume the presence of a
+    user agent.  That is, it can be used to bind C code to scripting
+    environments outside of the context of a user agent.
+    
+    However, the normal use of the this API is in the context of a
+    scripting environment running in a browser or other user agent.
+    In particular it is used to support the extended Netscape
+    script-ability API for plugins (NP-SAP).  NP-SAP is an extension
+    of the Netscape plugin API.  As such we have adopted the use of
+    the "NP" prefix for this API.
+
+    The following NP{N|P}Variables were added to the Netscape plugin
+    API (in npapi.h):
+
+    NPNVWindowNPObject
+    NPNVPluginElementNPObject
+    NPPVpluginScriptableNPObject
+
+    These variables are exposed through NPN_GetValue() and
+    NPP_GetValue() (respectively) and are used to establish the
+    initial binding between the user agent and native code.  The DOM
+    objects in the user agent can be examined and manipulated using
+    the NPN_ functions that operate on NPObjects described in this
+    header.
+
+    To the extent possible the assumptions about the scripting
+    language used by the scripting environment have been minimized.
+*/
+
+#define NP_BEGIN_MACRO  do {
+#define NP_END_MACRO    } while (0)
+
+/*
+    Objects (non-primitive data) passed between 'C' and script is
+    always wrapped in an NPObject.  The 'interface' of an NPObject is
+    described by an NPClass.
+*/
+typedef struct NPObject NPObject;
+typedef struct NPClass NPClass;
+
+typedef char NPUTF8;
+typedef struct _NPString {
+    const NPUTF8 *utf8characters;
+    uint32_t utf8length;
+} NPString;
+
+typedef enum {
+    NPVariantType_Void,
+    NPVariantType_Null,
+    NPVariantType_Bool,
+    NPVariantType_Int32,
+    NPVariantType_Double,
+    NPVariantType_String,
+    NPVariantType_Object
+} NPVariantType;
+
+typedef struct _NPVariant {
+    NPVariantType type;
+    union {
+        bool boolValue;
+        uint32_t intValue;
+        double doubleValue;
+        NPString stringValue;
+        NPObject *objectValue;
+    } value;
+} NPVariant;
+
+/*
+    NPN_ReleaseVariantValue is called on all 'out' parameters
+    references.  Specifically it is to be called on variants that own
+    their value, as is the case with all non-const NPVariant*
+    arguments after a successful call to any methods (except this one)
+    in this API.
+
+    After calling NPN_ReleaseVariantValue, the type of the variant
+    will be NPVariantType_Void.
+*/
+void NPN_ReleaseVariantValue(NPVariant *variant);
+
+#define NPVARIANT_IS_VOID(_v)    ((_v).type == NPVariantType_Void)
+#define NPVARIANT_IS_NULL(_v)    ((_v).type == NPVariantType_Null)
+#define NPVARIANT_IS_BOOLEAN(_v) ((_v).type == NPVariantType_Bool)
+#define NPVARIANT_IS_INT32(_v)   ((_v).type == NPVariantType_Int32)
+#define NPVARIANT_IS_DOUBLE(_v)  ((_v).type == NPVariantType_Double)
+#define NPVARIANT_IS_STRING(_v)  ((_v).type == NPVariantType_String)
+#define NPVARIANT_IS_OBJECT(_v)  ((_v).type == NPVariantType_Object)
+
+#define NPVARIANT_TO_BOOLEAN(_v) ((_v).value.boolValue)
+#define NPVARIANT_TO_INT32(_v)   ((_v).value.intValue)
+#define NPVARIANT_TO_DOUBLE(_v)  ((_v).value.doubleValue)
+#define NPVARIANT_TO_STRING(_v)  ((_v).value.stringValue)
+#define NPVARIANT_TO_OBJECT(_v)  ((_v).value.objectValue)
+
+#define VOID_TO_NPVARIANT(_v)                                                 \
+NP_BEGIN_MACRO                                                                \
+    (_v).type = NPVariantType_Void;                                           \
+    (_v).value.objectValue = NULL;                                            \
+NP_END_MACRO
+
+#define NULL_TO_NPVARIANT(_v)                                                 \
+NP_BEGIN_MACRO                                                                \
+    (_v).type = NPVariantType_Null;                                           \
+    (_v).value.objectValue = NULL;                                            \
+NP_END_MACRO
+
+#define BOOLEAN_TO_NPVARIANT(_val, _v)                                        \
+NP_BEGIN_MACRO                                                                \
+    (_v).type = NPVariantType_Bool;                                           \
+    (_v).value.boolValue = !!(_val);                                          \
+NP_END_MACRO
+
+#define INT32_TO_NPVARIANT(_val, _v)                                          \
+NP_BEGIN_MACRO                                                                \
+    (_v).type = NPVariantType_Int32;                                          \
+    (_v).value.intValue = _val;                                               \
+NP_END_MACRO
+
+#define DOUBLE_TO_NPVARIANT(_val, _v)                                         \
+NP_BEGIN_MACRO                                                                \
+    (_v).type = NPVariantType_Double;                                         \
+    (_v).value.doubleValue = _val;                                            \
+NP_END_MACRO
+
+#define STRINGZ_TO_NPVARIANT(_val, _v)                                        \
+NP_BEGIN_MACRO                                                                \
+    (_v).type = NPVariantType_String;                                         \
+    NPString str = { _val, strlen(_val) };                                    \
+    (_v).value.stringValue = str;                                             \
+NP_END_MACRO
+
+#define STRINGN_TO_NPVARIANT(_val, _len, _v)                                  \
+NP_BEGIN_MACRO                                                                \
+    (_v).type = NPVariantType_String;                                         \
+    NPString str = { _val, _len };                                            \
+    (_v).value.stringValue = str;                                             \
+NP_END_MACRO
+
+#define OBJECT_TO_NPVARIANT(_val, _v)                                         \
+NP_BEGIN_MACRO                                                                \
+    (_v).type = NPVariantType_Object;                                         \
+    (_v).value.objectValue = _val;                                            \
+NP_END_MACRO
+
+
+/*
+	Type mappings (JavaScript types have been used for illustration
+    purposes):
+
+	JavaScript       to             C (NPVariant with type:)
+	undefined                       NPVariantType_Void
+	null                            NPVariantType_Null
+	Boolean                         NPVariantType_Bool
+	Number                          NPVariantType_Double or NPVariantType_Int32
+	String                          NPVariantType_String
+	Object                          NPVariantType_Object
+
+	C (NPVariant with type:)   to   JavaScript
+	NPVariantType_Void              undefined
+	NPVariantType_Null              null
+	NPVariantType_Bool              Boolean	
+	NPVariantType_Int32             Number
+	NPVariantType_Double            Number
+	NPVariantType_String            String
+	NPVariantType_Object            Object
+*/
+
+typedef void *NPIdentifier;
+
+/*
+    NPObjects have methods and properties.  Methods and properties are
+    identified with NPIdentifiers.  These identifiers may be reflected
+    in script.  NPIdentifiers can be either strings or integers, IOW,
+    methods and properties can be identified by either strings or
+    integers (i.e. foo["bar"] vs foo[1]). NPIdentifiers can be
+    compared using ==.  In case of any errors, the requested
+    NPIdentifier(s) will be NULL.
+*/
+NPIdentifier NPN_GetStringIdentifier(const NPUTF8 *name);
+void NPN_GetStringIdentifiers(const NPUTF8 **names, int32_t nameCount,
+                              NPIdentifier *identifiers);
+NPIdentifier NPN_GetIntIdentifier(int32_t intid);
+bool NPN_IdentifierIsString(NPIdentifier identifier);
+
+/*
+    The NPUTF8 returned from NPN_UTF8FromIdentifier SHOULD be freed.
+*/
+NPUTF8 *NPN_UTF8FromIdentifier(NPIdentifier identifier);
+
+/*
+    Get the integer represented by identifier. If identifier is not an
+    integer identifier, the behaviour is undefined.
+*/
+int32_t NPN_IntFromIdentifier(NPIdentifier identifier);
+
+/*
+    NPObject behavior is implemented using the following set of
+    callback functions.
+
+    The NPVariant *result argument of these functions (where
+    applicable) should be released using NPN_ReleaseVariantValue().
+*/
+typedef NPObject *(*NPAllocateFunctionPtr)(NPP npp, NPClass *aClass);
+typedef void (*NPDeallocateFunctionPtr)(NPObject *npobj);
+typedef void (*NPInvalidateFunctionPtr)(NPObject *npobj);
+typedef bool (*NPHasMethodFunctionPtr)(NPObject *npobj, NPIdentifier name);
+typedef bool (*NPInvokeFunctionPtr)(NPObject *npobj, NPIdentifier name,
+                                    const NPVariant *args, uint32_t argCount,
+                                    NPVariant *result);
+typedef bool (*NPInvokeDefaultFunctionPtr)(NPObject *npobj,
+                                           const NPVariant *args,
+                                           uint32_t argCount,
+                                           NPVariant *result);
+typedef bool (*NPHasPropertyFunctionPtr)(NPObject *npobj, NPIdentifier name);
+typedef bool (*NPGetPropertyFunctionPtr)(NPObject *npobj, NPIdentifier name,
+                                         NPVariant *result);
+typedef bool (*NPSetPropertyFunctionPtr)(NPObject *npobj, NPIdentifier name,
+                                         const NPVariant *value);
+typedef bool (*NPRemovePropertyFunctionPtr)(NPObject *npobj,
+                                            NPIdentifier name);
+
+/*
+    NPObjects returned by create, retain, invoke, and getProperty pass
+    a reference count to the caller.  That is, the callee adds a
+    reference count which passes to the caller.  It is the caller's
+    responsibility to release the returned object.
+
+    NPInvokeFunctionPtr function may return 0 to indicate a void
+    result.
+
+    NPInvalidateFunctionPtr is called by the scripting environment
+    when the native code is shutdown.  Any attempt to message a
+    NPObject instance after the invalidate callback has been
+    called will result in undefined behavior, even if the native code
+    is still retaining those NPObject instances.  (The runtime
+    will typically return immediately, with 0 or NULL, from an attempt
+    to dispatch to a NPObject, but this behavior should not be
+    depended upon.)
+*/
+struct NPClass
+{
+    uint32_t structVersion;
+    NPAllocateFunctionPtr allocate;
+    NPDeallocateFunctionPtr deallocate;
+    NPInvalidateFunctionPtr invalidate;
+    NPHasMethodFunctionPtr hasMethod;
+    NPInvokeFunctionPtr invoke;
+    NPInvokeDefaultFunctionPtr invokeDefault;
+    NPHasPropertyFunctionPtr hasProperty;
+    NPGetPropertyFunctionPtr getProperty;
+    NPSetPropertyFunctionPtr setProperty;
+    NPRemovePropertyFunctionPtr removeProperty;
+};
+
+#define NP_CLASS_STRUCT_VERSION 1
+
+struct NPObject {
+    NPClass *_class;
+    uint32_t referenceCount;
+    /*
+     * Additional space may be allocated here by types of NPObjects
+     */
+};
+
+/*
+    If the class has an allocate function, NPN_CreateObject invokes
+    that function, otherwise a NPObject is allocated and
+    returned. This method will initialize the referenceCount member of
+    the NPObject to 1.
+*/
+NPObject *NPN_CreateObject(NPP npp, NPClass *aClass);
+
+/*
+    Increment the NPObject's reference count.
+*/
+NPObject *NPN_RetainObject(NPObject *npobj);
+
+/*
+    Decremented the NPObject's reference count.  If the reference
+    count goes to zero, the class's destroy function is invoke if
+    specified, otherwise the object is freed directly.
+*/
+void NPN_ReleaseObject(NPObject *npobj);
+
+/*
+    Functions to access script objects represented by NPObject.
+
+    Calls to script objects are synchronous.  If a function returns a
+    value, it will be supplied via the result NPVariant
+    argument. Successful calls will return true, false will be
+    returned in case of an error.
+    
+    Calls made from plugin code to script must be made from the thread
+    on which the plugin was initialized.
+*/
+
+bool NPN_Invoke(NPP npp, NPObject *npobj, NPIdentifier methodName,
+                const NPVariant *args, uint32_t argCount, NPVariant *result);
+bool NPN_InvokeDefault(NPP npp, NPObject *npobj, const NPVariant *args,
+                       uint32_t argCount, NPVariant *result);
+bool NPN_Evaluate(NPP npp, NPObject *npobj, NPString *script,
+                  NPVariant *result);
+bool NPN_GetProperty(NPP npp, NPObject *npobj, NPIdentifier propertyName,
+                     NPVariant *result);
+bool NPN_SetProperty(NPP npp, NPObject *npobj, NPIdentifier propertyName,
+                     const NPVariant *value);
+bool NPN_RemoveProperty(NPP npp, NPObject *npobj, NPIdentifier propertyName);
+bool NPN_HasProperty(NPP npp, NPObject *npobj, NPIdentifier propertyName);
+bool NPN_HasMethod(NPP npp, NPObject *npobj, NPIdentifier methodName);
+
+/*
+    NPN_SetException may be called to trigger a script exception upon
+    return from entry points into NPObjects.  Typical usage:
+
+    NPN_SetException (npobj, message);
+*/
+void NPN_SetException(NPObject *npobj, const NPUTF8 *message);
+
+#ifdef __cplusplus
+}
+#endif
+
+#endif
Index: nsplugins/sdk/npupp.h
===================================================================
--- nsplugins/sdk/npupp.h	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ nsplugins/sdk/npupp.h	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -1,11 +1,11 @@
-/* -*- Mode: C; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 2 -*- */
+/* -*- Mode: C; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- */
 /* ***** BEGIN LICENSE BLOCK *****
- * Version: NPL 1.1/GPL 2.0/LGPL 2.1
+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1
  *
- * The contents of this file are subject to the Netscape Public License
- * Version 1.1 (the "License"); you may not use this file except in
- * compliance with the License. You may obtain a copy of the License at
- * http://www.mozilla.org/NPL/
+ * The contents of this file are subject to the Mozilla Public License Version
+ * 1.1 (the "License"); you may not use this file except in compliance with
+ * the License. You may obtain a copy of the License at
+ * http://www.mozilla.org/MPL/
  *
  * Software distributed under the License is distributed on an "AS IS" basis,
  * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
@@ -14,25 +14,24 @@
  *
  * The Original Code is mozilla.org code.
  *
- * The Initial Developer of the Original Code is 
+ * The Initial Developer of the Original Code is
  * Netscape Communications Corporation.
  * Portions created by the Initial Developer are Copyright (C) 1998
  * the Initial Developer. All Rights Reserved.
  *
  * Contributor(s):
  *
- *
  * Alternatively, the contents of this file may be used under the terms of
  * either the GNU General Public License Version 2 or later (the "GPL"), or
  * the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
  * in which case the provisions of the GPL or the LGPL are applicable instead
  * of those above. If you wish to allow use of your version of this file only
  * under the terms of either the GPL or the LGPL, and not to allow others to
- * use your version of this file under the terms of the NPL, indicate your
+ * use your version of this file under the terms of the MPL, indicate your
  * decision by deleting the provisions above and replace them with the notice
  * and other provisions required by the GPL or the LGPL. If you do not delete
  * the provisions above, a recipient may use your version of this file under
- * the terms of any one of the NPL, the GPL or the LGPL.
+ * the terms of any one of the MPL, the GPL or the LGPL.
  *
  * ***** END LICENSE BLOCK ***** */
 
@@ -58,6 +57,8 @@
 #include "npapi.h"
 #endif
 
+#include "npruntime.h"
+
 #include "jri.h"
 
 /******************************************************************************************
@@ -72,7 +73,6 @@
 
 /* NPP_Initialize */
 
-/*#define _NPUPP_USE_UPP_ (TARGET_RT_MAC_CFM && !TARGET_API_MAC_CARBON)*/
 #define _NPUPP_USE_UPP_ 0
 
 #if _NPUPP_USE_UPP_
@@ -488,8 +488,6 @@
 #endif
 
 
-
-
 /*
  *  Netscape entry points
  */
@@ -1063,7 +1061,585 @@
 
 #endif
 
+/* NPN_GetStringIdentifier */
 
+#if _NPUPP_USE_UPP_
+
+typedef UniversalProcPtr NPN_GetStringIdentifierUPP;
+enum {
+	uppNPN_GetStringIdentifierProcInfo = kThinkCStackBased
+		| STACK_ROUTINE_PARAMETER(1, SIZE_CODE(sizeof(const NPUTF8*)))
+		| RESULT_SIZE(SIZE_CODE(sizeof(NPIdentifier)))
+};
+
+#define NewNPN_GetStringIdentifierProc(FUNC)		\
+		(NPN_GetStringIdentifierUPP) NewRoutineDescriptor((ProcPtr)(FUNC), uppNPN_GetStringIdentifierProcInfo, GetCurrentArchitecture())
+#define CallNPN_GetStringIdentifierProc(FUNC, ARG1)		\
+		(jref)CallUniversalProc((UniversalProcPtr)(FUNC), uppNPN_GetStringIdentifierProcInfo, (ARG1))	
+
+#else
+
+typedef NPIdentifier (* NP_LOADDS NPN_GetStringIdentifierUPP)(const NPUTF8* name);
+#define NewNPN_GetStringIdentifierProc(FUNC)		\
+		((NPN_GetStringIdentifierUPP) (FUNC))
+#define CallNPN_GetStringIdentifierProc(FUNC, ARG1)		\
+		(*(FUNC))((ARG1))
+
+#endif
+
+/* NPN_GetStringIdentifiers */
+
+#if _NPUPP_USE_UPP_
+
+typedef UniversalProcPtr NPN_GetStringIdentifiersUPP;
+enum {
+	uppNPN_GetStringIdentifiersProcInfo = kThinkCStackBased
+		| STACK_ROUTINE_PARAMETER(1, SIZE_CODE(sizeof(const NPUTF8**)))
+		| STACK_ROUTINE_PARAMETER(2, SIZE_CODE(sizeof(int32_t)))
+		| STACK_ROUTINE_PARAMETER(3, SIZE_CODE(sizeof(NPIdentifier*)))
+        | RESULT_SIZE(SIZE_CODE(0))
+};
+
+#define NewNPN_GetStringIdentifiersProc(FUNC)		\
+		(NPN_GetStringIdentifiersUPP) NewRoutineDescriptor((ProcPtr)(FUNC), uppNPN_GetStringIdentifiersProcInfo, GetCurrentArchitecture())
+#define CallNPN_GetStringIdentifiersProc(FUNC, ARG1, ARG2, ARG3)		\
+		(jref)CallUniversalProc((UniversalProcPtr)(FUNC), uppNPN_GetStringIdentifiersProcInfo, (ARG1), (ARG2), (ARG3))	
+
+#else
+
+typedef void (* NP_LOADDS NPN_GetStringIdentifiersUPP)(const NPUTF8** names,
+                                                 int32_t nameCount,
+                                                 NPIdentifier* identifiers);
+#define NewNPN_GetStringIdentifiersProc(FUNC)		\
+		((NPN_GetStringIdentifiersUPP) (FUNC))
+#define CallNPN_GetStringIdentifiersProc(FUNC, ARG1, ARG2, ARG3)		\
+		(*(FUNC))((ARG1), (ARG2), (ARG3))
+
+#endif
+
+/* NPN_GetIntIdentifier */
+
+#if _NPUPP_USE_UPP_
+
+typedef UniversalProcPtr NPN_GetIntIdentifierUPP;
+enum {
+	uppNPN_GetIntIdentifierProcInfo = kThinkCStackBased
+		| STACK_ROUTINE_PARAMETER(1, SIZE_CODE(sizeof(int32_t)))
+		| RESULT_SIZE(SIZE_CODE(sizeof(NPIdentifier)))
+};
+
+#define NewNPN_GetIntIdentifierProc(FUNC)		\
+		(NPN_GetIntIdentifierUPP) NewRoutineDescriptor((ProcPtr)(FUNC), uppNPN_GetIntIdentifierProcInfo, GetCurrentArchitecture())
+#define CallNPN_GetIntIdentifierProc(FUNC, ARG1)		\
+		(jref)CallUniversalProc((UniversalProcPtr)(FUNC), uppNPN_GetIntIdentifierProcInfo, (ARG1))	
+
+#else
+
+typedef NPIdentifier (* NP_LOADDS NPN_GetIntIdentifierUPP)(int32_t intid);
+#define NewNPN_GetIntIdentifierProc(FUNC)		\
+		((NPN_GetIntIdentifierUPP) (FUNC))
+#define CallNPN_GetIntIdentifierProc(FUNC, ARG1)		\
+		(*(FUNC))((ARG1))
+
+#endif
+
+/* NPN_IdentifierIsString */
+
+#if _NPUPP_USE_UPP_
+
+typedef UniversalProcPtr NPN_IdentifierIsStringUPP;
+enum {
+	uppNPN_IdentifierIsStringProcInfo = kThinkCStackBased
+		| STACK_ROUTINE_PARAMETER(1, SIZE_CODE(sizeof(NPIdentifier identifier)))
+		| RESULT_SIZE(SIZE_CODE(sizeof(bool)))
+};
+
+#define NewNPN_IdentifierIsStringProc(FUNC)		\
+		(NPN_IdentifierIsStringUPP) NewRoutineDescriptor((ProcPtr)(FUNC), uppNPN_IdentifierIsStringProcInfo, GetCurrentArchitecture())
+#define CallNPN_IdentifierIsStringProc(FUNC, ARG1)		\
+		(jref)CallUniversalProc((UniversalProcPtr)(FUNC), uppNPN_IdentifierIsStringProcInfo, (ARG1))	
+
+#else
+
+typedef bool (* NP_LOADDS NPN_IdentifierIsStringUPP)(NPIdentifier identifier);
+#define NewNPN_IdentifierIsStringProc(FUNC)		\
+		((NPN_IdentifierIsStringUPP) (FUNC))
+#define CallNPN_IdentifierIsStringProc(FUNC, ARG1)		\
+		(*(FUNC))((ARG1))
+
+#endif
+
+/* NPN_UTF8FromIdentifier */
+
+#if _NPUPP_USE_UPP_
+
+typedef UniversalProcPtr NPN_UTF8FromIdentifierUPP;
+enum {
+	uppNPN_UTF8FromIdentifierProcInfo = kThinkCStackBased
+		| STACK_ROUTINE_PARAMETER(1, SIZE_CODE(sizeof(NPIdentifier)))
+		| RESULT_SIZE(SIZE_CODE(sizeof(NPUTF8*)))
+};
+
+#define NewNPN_UTF8FromIdentifierProc(FUNC)		\
+		(NPN_UTF8FromIdentifierUPP) NewRoutineDescriptor((ProcPtr)(FUNC), uppNPN_UTF8FromIdentifierProcInfo, GetCurrentArchitecture())
+#define CallNPN_UTF8FromIdentifierProc(FUNC, ARG1)		\
+		(jref)CallUniversalProc((UniversalProcPtr)(FUNC), uppNPN_UTF8FromIdentifierProcInfo, (ARG1))	
+
+#else
+
+typedef NPUTF8* (* NP_LOADDS NPN_UTF8FromIdentifierUPP)(NPIdentifier identifier);
+#define NewNPN_UTF8FromIdentifierProc(FUNC)		\
+		((NPN_UTF8FromIdentifierUPP) (FUNC))
+#define CallNPN_UTF8FromIdentifierProc(FUNC, ARG1)		\
+		(*(FUNC))((ARG1))
+
+#endif
+
+/* NPN_IntFromIdentifier */
+
+#if _NPUPP_USE_UPP_
+
+typedef UniversalProcPtr NPN_IntFromIdentifierUPP;
+enum {
+	uppNPN_IntFromIdentifierProcInfo = kThinkCStackBased
+		| STACK_ROUTINE_PARAMETER(1, SIZE_CODE(sizeof(NPIdentifier)))
+		| RESULT_SIZE(SIZE_CODE(sizeof(int32_t)))
+};
+
+#define NewNPN_IntFromIdentifierProc(FUNC)		\
+		(NPN_IntFromIdentifierUPP) NewRoutineDescriptor((ProcPtr)(FUNC), uppNPN_IntFromIdentifierProcInfo, GetCurrentArchitecture())
+#define CallNPN_IntFromIdentifierProc(FUNC, ARG1)		\
+		(jref)CallUniversalProc((UniversalProcPtr)(FUNC), uppNPN_IntFromIdentifierProcInfo, (ARG1))	
+
+#else
+
+typedef int32_t (* NP_LOADDS NPN_IntFromIdentifierUPP)(NPIdentifier identifier);
+#define NewNPN_IntFromIdentifierProc(FUNC)		\
+		((NPN_IntFromIdentifierUPP) (FUNC))
+#define CallNPN_IntFromIdentifierProc(FUNC, ARG1)		\
+		(*(FUNC))((ARG1))
+
+#endif
+
+/* NPN_CreateObject */
+
+#if _NPUPP_USE_UPP_
+
+typedef UniversalProcPtr NPN_CreateObjectUPP;
+enum {
+	uppNPN_CreateObjectProcInfo = kThinkCStackBased
+		| STACK_ROUTINE_PARAMETER(1, SIZE_CODE(sizeof(NPP)))
+		| STACK_ROUTINE_PARAMETER(2, SIZE_CODE(sizeof(NPClass*)))
+		| RESULT_SIZE(SIZE_CODE(sizeof(NPObject*)))
+};
+
+#define NewNPN_CreateObjectProc(FUNC)		\
+		(NPN_CreateObjectUPP) NewRoutineDescriptor((ProcPtr)(FUNC), uppNPN_CreateObjectProcInfo, GetCurrentArchitecture())
+#define CallNPN_CreateObjectProc(FUNC, ARG1, ARG2)		\
+		(jref)CallUniversalProc((UniversalProcPtr)(FUNC), uppNPN_CreateObjectProcInfo, (ARG1), (ARG2))	
+
+#else
+
+typedef NPObject* (* NP_LOADDS NPN_CreateObjectUPP)(NPP npp, NPClass *aClass);
+#define NewNPN_CreateObjectProc(FUNC)		\
+		((NPN_CreateObjectUPP) (FUNC))
+#define CallNPN_CreateObjectProc(FUNC, ARG1, ARG2)		\
+		(*(FUNC))((ARG1), (ARG2))
+
+#endif
+
+/* NPN_RetainObject */
+
+#if _NPUPP_USE_UPP_
+
+typedef UniversalProcPtr NPN_RetainObjectUPP;
+enum {
+	uppNPN_RetainObjectProcInfo = kThinkCStackBased
+		| STACK_ROUTINE_PARAMETER(1, SIZE_CODE(sizeof(NPObject*)))
+		| RESULT_SIZE(SIZE_CODE(sizeof(NPObject*)))
+};
+
+#define NewNPN_RetainObjectProc(FUNC)		\
+		(NPN_RetainObjectUPP) NewRoutineDescriptor((ProcPtr)(FUNC), uppNPN_RetainObjectProcInfo, GetCurrentArchitecture())
+#define CallNPN_RetainObjectProc(FUNC, ARG1)		\
+		(jref)CallUniversalProc((UniversalProcPtr)(FUNC), uppNPN_RetainObjectProcInfo, (ARG1))	
+
+#else
+
+typedef NPObject* (* NP_LOADDS NPN_RetainObjectUPP)(NPObject *obj);
+#define NewNPN_RetainObjectProc(FUNC)		\
+		((NPN_RetainObjectUPP) (FUNC))
+#define CallNPN_RetainObjectProc(FUNC, ARG1)		\
+		(*(FUNC))((ARG1))
+
+#endif
+
+/* NPN_ReleaseObject */
+
+#if _NPUPP_USE_UPP_
+
+typedef UniversalProcPtr NPN_ReleaseObjectUPP;
+enum {
+	uppNPN_ReleaseObjectProcInfo = kThinkCStackBased
+		| STACK_ROUTINE_PARAMETER(1, SIZE_CODE(sizeof(NPObject*)))
+		| RESULT_SIZE(SIZE_CODE(0))
+};
+
+#define NewNPN_ReleaseObjectProc(FUNC)		\
+		(NPN_ReleaseObjectUPP) NewRoutineDescriptor((ProcPtr)(FUNC), uppNPN_ReleaseObjectProcInfo, GetCurrentArchitecture())
+#define CallNPN_ReleaseObjectProc(FUNC, ARG1)		\
+		(jref)CallUniversalProc((UniversalProcPtr)(FUNC), uppNPN_ReleaseObjectProcInfo, (ARG1))
+
+#else
+
+typedef void (* NP_LOADDS NPN_ReleaseObjectUPP)(NPObject *obj);
+#define NewNPN_ReleaseObjectProc(FUNC)		\
+		((NPN_ReleaseObjectUPP) (FUNC))
+#define CallNPN_ReleaseObjectProc(FUNC, ARG1)		\
+		(*(FUNC))((ARG1))
+
+#endif
+
+/* NPN_Invoke */
+
+#if _NPUPP_USE_UPP_
+
+typedef UniversalProcPtr NPN_InvokeUPP;
+enum {
+	uppNPN_InvokeProcInfo = kThinkCStackBased
+		| STACK_ROUTINE_PARAMETER(1, SIZE_CODE(sizeof(NPP)))
+		| STACK_ROUTINE_PARAMETER(2, SIZE_CODE(sizeof(NPObject*)))
+		| STACK_ROUTINE_PARAMETER(3, SIZE_CODE(sizeof(NPIdentifier)))
+		| STACK_ROUTINE_PARAMETER(4, SIZE_CODE(sizeof(const NPVariant*)))
+		| STACK_ROUTINE_PARAMETER(5, SIZE_CODE(sizeof(uint32_t)))
+		| STACK_ROUTINE_PARAMETER(6, SIZE_CODE(sizeof(NPVariant*)))
+		| RESULT_SIZE(SIZE_CODE(sizeof(bool)))
+};
+
+#define NewNPN_InvokeProc(FUNC)		\
+		(NPN_InvokeUPP) NewRoutineDescriptor((ProcPtr)(FUNC), uppNPN_InvokeProcInfo, GetCurrentArchitecture())
+#define CallNPN_InvokeProc(FUNC, ARG1, ARG2, ARG3, ARG4, ARG5, ARG6)		\
+		(jref)CallUniversalProc((UniversalProcPtr)(FUNC), uppNPN_InvokeProcInfo, (ARG1), (ARG2), (ARG3), (ARG4), (ARG5), (ARG6))
+
+#else
+
+typedef bool (* NP_LOADDS NPN_InvokeUPP)(NPP npp, NPObject* obj, NPIdentifier methodName, const NPVariant *args, uint32_t argCount, NPVariant *result);
+#define NewNPN_InvokeProc(FUNC)		\
+		((NPN_InvokeUPP) (FUNC))
+#define CallNPN_InvokeProc(FUNC, ARG1, ARG2, ARG3, ARG4, ARG5, ARG6)		\
+		(*(FUNC))((ARG1), (ARG2), (ARG3), (ARG4), (ARG5), (ARG6))
+
+#endif
+
+/* NPN_InvokeDefault */
+
+#if _NPUPP_USE_UPP_
+
+typedef UniversalProcPtr NPN_InvokeDefaultUPP;
+enum {
+	uppNPN_InvokeDefaultProcInfo = kThinkCStackBased
+		| STACK_ROUTINE_PARAMETER(1, SIZE_CODE(sizeof(NPP)))
+		| STACK_ROUTINE_PARAMETER(2, SIZE_CODE(sizeof(NPObject*)))
+		| STACK_ROUTINE_PARAMETER(4, SIZE_CODE(sizeof(const NPVariant*)))
+		| STACK_ROUTINE_PARAMETER(5, SIZE_CODE(sizeof(uint32_t)))
+		| STACK_ROUTINE_PARAMETER(6, SIZE_CODE(sizeof(NPVariant*)))
+		| RESULT_SIZE(SIZE_CODE(sizeof(bool)))
+};
+
+#define NewNPN_InvokeDefaultProc(FUNC)		\
+		(NPN_InvokeDefaultUPP) NewRoutineDescriptor((ProcPtr)(FUNC), uppNPN_InvokeDefaultProcInfo, GetCurrentArchitecture())
+#define CallNPN_InvokeDefaultProc(FUNC, ARG1, ARG2, ARG3, ARG4, ARG5)		\
+		(jref)CallUniversalProc((UniversalProcPtr)(FUNC), uppNPN_InvokeDefaultProcInfo, (ARG1), (ARG2), (ARG3), (ARG4), (ARG5))
+
+#else
+
+typedef bool (* NP_LOADDS NPN_InvokeDefaultUPP)(NPP npp, NPObject* obj, const NPVariant *args, uint32_t argCount, NPVariant *result);
+#define NewNPN_InvokeDefaultProc(FUNC)		\
+		((NPN_InvokeDefaultUPP) (FUNC))
+#define CallNPN_InvokeDefaultProc(FUNC, ARG1, ARG2, ARG3, ARG4, ARG5)		\
+		(*(FUNC))((ARG1), (ARG2), (ARG3), (ARG4), (ARG5))
+
+#endif
+
+/* NPN_Evaluate */
+
+#if _NPUPP_USE_UPP_
+
+typedef UniversalProcPtr NPN_EvaluateUPP;
+enum {
+	uppNPN_EvaluateProcInfo = kThinkCStackBased
+		| STACK_ROUTINE_PARAMETER(1, SIZE_CODE(sizeof(NPP)))
+		| STACK_ROUTINE_PARAMETER(2, SIZE_CODE(sizeof(NPObject*)))
+		| STACK_ROUTINE_PARAMETER(3, SIZE_CODE(sizeof(NPString*)))
+		| STACK_ROUTINE_PARAMETER(4, SIZE_CODE(sizeof(NPVariant*)))
+		| RESULT_SIZE(SIZE_CODE(sizeof(bool)))
+};
+
+#define NewNPN_EvaluateProc(FUNC)		\
+		(NPN_EvaluateUPP) NewRoutineDescriptor((ProcPtr)(FUNC), uppNPN_EvaluateProcInfo, GetCurrentArchitecture())
+#define CallNPN_EvaluateProc(FUNC, ARG1, ARG2, ARG3, ARG4)		\
+		(jref)CallUniversalProc((UniversalProcPtr)(FUNC), uppNPN_EvaluateProcInfo, (ARG1), (ARG2), (ARG3), (ARG4))
+
+#else
+
+typedef bool (* NP_LOADDS NPN_EvaluateUPP)(NPP npp, NPObject *obj, NPString *script, NPVariant *result);
+#define NewNPN_EvaluateProc(FUNC)		\
+		((NPN_EvaluateUPP) (FUNC))
+#define CallNPN_EvaluateProc(FUNC, ARG1, ARG2, ARG3, ARG4)		\
+		(*(FUNC))((ARG1), (ARG2), (ARG3), (ARG4))
+
+#endif
+
+/* NPN_GetProperty */
+
+#if _NPUPP_USE_UPP_
+
+typedef UniversalProcPtr NPN_GetPropertyUPP;
+enum {
+	uppNPN_GetPropertyProcInfo = kThinkCStackBased
+		| STACK_ROUTINE_PARAMETER(1, SIZE_CODE(sizeof(NPP)))
+		| STACK_ROUTINE_PARAMETER(2, SIZE_CODE(sizeof(NPObject*)))
+		| STACK_ROUTINE_PARAMETER(3, SIZE_CODE(sizeof(NPIdentifier)))
+		| STACK_ROUTINE_PARAMETER(4, SIZE_CODE(sizeof(NPVariant*)))
+		| RESULT_SIZE(SIZE_CODE(sizeof(bool)))
+};
+
+#define NewNPN_GetPropertyProc(FUNC)		\
+		(NPN_GetPropertyUPP) NewRoutineDescriptor((ProcPtr)(FUNC), uppNPN_GetPropertyProcInfo, GetCurrentArchitecture())
+#define CallNPN_GetPropertyProc(FUNC, ARG1, ARG2, ARG3, ARG4)		\
+		(jref)CallUniversalProc((UniversalProcPtr)(FUNC), uppNPN_GetPropertyProcInfo, (ARG1), (ARG2), (ARG3), (ARG4))
+
+#else
+
+typedef bool (* NP_LOADDS NPN_GetPropertyUPP)(NPP npp, NPObject *obj, NPIdentifier propertyName, NPVariant *result);
+#define NewNPN_GetPropertyProc(FUNC)		\
+		((NPN_GetPropertyUPP) (FUNC))
+#define CallNPN_GetPropertyProc(FUNC, ARG1, ARG2, ARG3, ARG4)		\
+		(*(FUNC))((ARG1), (ARG2), (ARG3), (ARG4))
+
+#endif
+
+/* NPN_SetProperty */
+
+#if _NPUPP_USE_UPP_
+
+typedef UniversalProcPtr NPN_SetPropertyUPP;
+enum {
+	uppNPN_SetPropertyProcInfo = kThinkCStackBased
+		| STACK_ROUTINE_PARAMETER(1, SIZE_CODE(sizeof(NPP)))
+		| STACK_ROUTINE_PARAMETER(2, SIZE_CODE(sizeof(NPObject*)))
+		| STACK_ROUTINE_PARAMETER(3, SIZE_CODE(sizeof(NPIdentifier)))
+		| STACK_ROUTINE_PARAMETER(4, SIZE_CODE(sizeof(const NPVariant*)))
+		| RESULT_SIZE(SIZE_CODE(sizeof(bool)))
+};
+
+#define NewNPN_SetPropertyProc(FUNC)		\
+		(NPN_SetPropertyUPP) NewRoutineDescriptor((ProcPtr)(FUNC), uppNPN_SetPropertyProcInfo, GetCurrentArchitecture())
+#define CallNPN_SetPropertyProc(FUNC, ARG1, ARG2, ARG3, ARG4)		\
+		(jref)CallUniversalProc((UniversalProcPtr)(FUNC), uppNPN_SetPropertyProcInfo, (ARG1), (ARG2), (ARG3), (ARG4))
+
+#else
+
+typedef bool (* NP_LOADDS NPN_SetPropertyUPP)(NPP npp, NPObject *obj, NPIdentifier propertyName, const NPVariant *value);
+#define NewNPN_SetPropertyProc(FUNC)		\
+		((NPN_SetPropertyUPP) (FUNC))
+#define CallNPN_SetPropertyProc(FUNC, ARG1, ARG2, ARG3, ARG4)		\
+		(*(FUNC))((ARG1), (ARG2), (ARG3), (ARG4))
+
+#endif
+
+/* NPN_RemoveProperty */
+
+#if _NPUPP_USE_UPP_
+
+typedef UniversalProcPtr NPN_RemovePropertyUPP;
+enum {
+	uppNPN_RemovePropertyProcInfo = kThinkCStackBased
+		| STACK_ROUTINE_PARAMETER(1, SIZE_CODE(sizeof(NPP)))
+		| STACK_ROUTINE_PARAMETER(2, SIZE_CODE(sizeof(NPObject*)))
+		| STACK_ROUTINE_PARAMETER(3, SIZE_CODE(sizeof(NPIdentifier)))
+		| RESULT_SIZE(SIZE_CODE(sizeof(bool)))
+};
+
+#define NewNPN_RemovePropertyProc(FUNC)		\
+		(NPN_RemovePropertyUPP) NewRoutineDescriptor((ProcPtr)(FUNC), uppNPN_RemovePropertyProcInfo, GetCurrentArchitecture())
+#define CallNPN_RemovePropertyProc(FUNC, ARG1, ARG2, ARG3)		\
+		(jref)CallUniversalProc((UniversalProcPtr)(FUNC), uppNPN_RemovePropertyProcInfo, (ARG1), (ARG2), (ARG3))
+
+#else
+
+typedef bool (* NP_LOADDS NPN_RemovePropertyUPP)(NPP npp, NPObject *obj, NPIdentifier propertyName);
+#define NewNPN_RemovePropertyProc(FUNC)		\
+		((NPN_RemovePropertyUPP) (FUNC))
+#define CallNPN_RemovePropertyProc(FUNC, ARG1, ARG2, ARG3)		\
+		(*(FUNC))((ARG1), (ARG2), (ARG3))
+
+#endif
+
+/* NPN_HasProperty */
+
+#if _NPUPP_USE_UPP_
+
+typedef UniversalProcPtr NPN_HasPropertyUPP;
+enum {
+	uppNPN_HasPropertyProcInfo = kThinkCStackBased
+		| STACK_ROUTINE_PARAMETER(1, SIZE_CODE(sizeof(NPP)))
+		| STACK_ROUTINE_PARAMETER(2, SIZE_CODE(sizeof(NPObject*)))
+		| STACK_ROUTINE_PARAMETER(3, SIZE_CODE(sizeof(NPIdentifier)))
+		| RESULT_SIZE(SIZE_CODE(sizeof(bool)))
+};
+
+#define NewNPN_HasPropertyProc(FUNC)		\
+		(NPN_HasPropertyUPP) NewRoutineDescriptor((ProcPtr)(FUNC), uppNPN_HasPropertyProcInfo, GetCurrentArchitecture())
+#define CallNPN_HasPropertyProc(FUNC, ARG1, ARG2, ARG3)		\
+		(jref)CallUniversalProc((UniversalProcPtr)(FUNC), uppNPN_HasPropertyProcInfo, (ARG1), (ARG2), (ARG3))
+
+#else
+
+typedef bool (* NP_LOADDS NPN_HasPropertyUPP)(NPP npp, NPObject *obj, NPIdentifier propertyName);
+#define NewNPN_HasPropertyProc(FUNC)		\
+		((NPN_HasPropertyUPP) (FUNC))
+#define CallNPN_HasPropertyProc(FUNC, ARG1, ARG2, ARG3)		\
+		(*(FUNC))((ARG1), (ARG2), (ARG3))
+
+#endif
+
+/* NPN_HasMethod */
+
+#if _NPUPP_USE_UPP_
+
+typedef UniversalProcPtr NPN_HasMethodUPP;
+enum {
+	uppNPN_HasMethodProcInfo = kThinkCStackBased
+		| STACK_ROUTINE_PARAMETER(1, SIZE_CODE(sizeof(NPP)))
+		| STACK_ROUTINE_PARAMETER(2, SIZE_CODE(sizeof(NPObject*)))
+		| STACK_ROUTINE_PARAMETER(3, SIZE_CODE(sizeof(NPIdentifier)))
+		| RESULT_SIZE(SIZE_CODE(sizeof(bool)))
+};
+
+#define NewNPN_HasMethodProc(FUNC)		\
+		(NPN_HasMethodUPP) NewRoutineDescriptor((ProcPtr)(FUNC), uppNPN_HasMethodProcInfo, GetCurrentArchitecture())
+#define CallNPN_HasMethodProc(FUNC, ARG1, ARG2, ARG3)		\
+		(jref)CallUniversalProc((UniversalProcPtr)(FUNC), uppNPN_HasMethodProcInfo, (ARG1), (ARG2), (ARG3))
+
+#else
+
+typedef bool (* NP_LOADDS NPN_HasMethodUPP)(NPP npp, NPObject *obj, NPIdentifier propertyName);
+#define NewNPN_HasMethodProc(FUNC)		\
+		((NPN_HasMethodUPP) (FUNC))
+#define CallNPN_HasMethodProc(FUNC, ARG1, ARG2, ARG3)		\
+		(*(FUNC))((ARG1), (ARG2), (ARG3))
+
+#endif
+
+/* NPN_ReleaseVariantValue */
+
+#if _NPUPP_USE_UPP_
+
+typedef UniversalProcPtr NPN_ReleaseVariantValue;
+enum {
+	uppNPN_ReleaseVariantValueProcInfo = kThinkCStackBased
+		| STACK_ROUTINE_PARAMETER(1, SIZE_CODE(sizeof(NPVariant*)))
+		| RESULT_SIZE(SIZE_CODE(0))
+};
+
+#define NewNPN_ReleaseVariantValueProc(FUNC)		\
+		(NPN_ReleaseVariantValueUPP) NewRoutineDescriptor((ProcPtr)(FUNC), uppNPN_ReleaseVariantValueProcInfo, GetCurrentArchitecture())
+#define CallNPN_ReleaseVariantValueProc(FUNC, ARG1)		\
+		(jref)CallUniversalProc((UniversalProcPtr)(FUNC), uppNPN_ReleaseVariantValueProcInfo, (ARG1))	
+
+#else
+
+typedef void (* NP_LOADDS NPN_ReleaseVariantValueUPP)(NPVariant *variant);
+#define NewNPN_ReleaseVariantValueProc(FUNC)		\
+		((NPN_ReleaseVariantValueUPP) (FUNC))
+#define CallNPN_ReleaseVariantValueProc(FUNC, ARG1)		\
+		(*(FUNC))((ARG1))
+
+#endif
+
+/* NPN_SetException */
+
+#if _NPUPP_USE_UPP_
+
+typedef UniversalProcPtr NPN_SetExceptionUPP;
+enum {
+	uppNPN_SetExceptionProcInfo = kThinkCStackBased
+		| STACK_ROUTINE_PARAMETER(1, SIZE_CODE(sizeof(NPObject*)))
+		| STACK_ROUTINE_PARAMETER(2, SIZE_CODE(sizeof(const NPUTF8*)))
+		| RESULT_SIZE(SIZE_CODE(0))
+};
+
+#define NewNPN_SetExceptionProc(FUNC)		\
+		(NPN_SetExceptionUPP) NewRoutineDescriptor((ProcPtr)(FUNC), uppNPN_SetExceptionProcInfo, GetCurrentArchitecture())
+#define CallNPN_SetExceptionProc(FUNC, ARG1, ARG2)		\
+		(jref)CallUniversalProc((UniversalProcPtr)(FUNC), uppNPN_SetExceptionProcInfo, (ARG1), (ARG2))	
+
+#else
+
+typedef void (* NP_LOADDS NPN_SetExceptionUPP)(NPObject *obj, const NPUTF8 *message);
+#define NewNPN_SetExceptionProc(FUNC)		\
+		((NPN_SetExceptionUPP) (FUNC))
+#define CallNPN_SetExceptionProc(FUNC, ARG1, ARG2)		\
+		(*(FUNC))((ARG1), (ARG2))	
+
+#endif
+
+/* NPN_PushPopupsEnabledStateUPP */
+
+#if _NPUPP_USE_UPP_
+
+typedef UniversalProcPtr NPN_PushPopupsEnabledStateUPP;
+enum {
+	uppNPN_PushPopupsEnabledStateProcInfo = kThinkCStackBased
+		| STACK_ROUTINE_PARAMETER(1, SIZE_CODE(sizeof(NPP)))
+        | STACK_ROUTINE_PARAMETER(2, SIZE_CODE(sizeof(NPBool)))
+		| RESULT_SIZE(SIZE_CODE(0))
+};
+
+#define NewNPN_PushPopupsEnabledStateProc(FUNC)		\
+		(NPN_PushPopupsEnabledStateUPP) NewRoutineDescriptor((ProcPtr)(FUNC), uppNPN_PushPopupsEnabledStateProcInfo, GetCurrentArchitecture())
+#define CallNPN_PushPopupsEnabledStateProc(FUNC, ARG1, ARG2)		\
+		(jref)CallUniversalProc((UniversalProcPtr)(FUNC), uppNPN_PushPopupsEnabledStateProcInfo, (ARG1), (ARG2))
+
+#else
+
+typedef bool (* NP_LOADDS NPN_PushPopupsEnabledStateUPP)(NPP npp, NPBool enabled);
+#define NewNPN_PushPopupsEnabledStateProc(FUNC)		\
+		((NPN_PushPopupsEnabledStateUPP) (FUNC))
+#define CallNPN_PushPopupsEnabledStateProc(FUNC, ARG1, ARG2)		\
+		(*(FUNC))((ARG1), (ARG2))
+
+#endif
+
+/* NPN_PopPopupsEnabledState */
+
+#if _NPUPP_USE_UPP_
+
+typedef UniversalProcPtr NPN_PopPopupsEnabledStateUPP;
+enum {
+	uppNPN_PopPopupsEnabledStateProcInfo = kThinkCStackBased
+		| STACK_ROUTINE_PARAMETER(1, SIZE_CODE(sizeof(NPP)))
+		| RESULT_SIZE(SIZE_CODE(0))
+};
+
+#define NewNPN_PopPopupsEnabledStateProc(FUNC)		\
+		(NPN_PopPopupsEnabledStateUPP) NewRoutineDescriptor((ProcPtr)(FUNC), uppNPN_PopPopupsEnabledStateProcInfo, GetCurrentArchitecture())
+#define CallNPN_PopPopupsEnabledStateProc(FUNC, ARG1)		\
+		(jref)CallUniversalProc((UniversalProcPtr)(FUNC), uppNPN_PopPopupsEnabledStateProcInfo, (ARG1))
+
+#else
+
+typedef bool (* NP_LOADDS NPN_PopPopupsEnabledStateUPP)(NPP npp);
+#define NewNPN_PopPopupsEnabledStateProc(FUNC)		\
+		((NPN_PopPopupsEnabledStateUPP) (FUNC))
+#define CallNPN_PopPopupsEnabledStateProc(FUNC, ARG1)		\
+		(*(FUNC))((ARG1))
+
+#endif
+
+
+
 /******************************************************************************************
  * The actual plugin function table definitions
  *******************************************************************************************/
@@ -1117,6 +1693,27 @@
     NPN_InvalidateRectUPP invalidaterect;
     NPN_InvalidateRegionUPP invalidateregion;
     NPN_ForceRedrawUPP forceredraw;
+    NPN_GetStringIdentifierUPP getstringidentifier;
+    NPN_GetStringIdentifiersUPP getstringidentifiers;
+    NPN_GetIntIdentifierUPP getintidentifier;
+    NPN_IdentifierIsStringUPP identifierisstring;
+    NPN_UTF8FromIdentifierUPP utf8fromidentifier;
+    NPN_IntFromIdentifierUPP intfromidentifier;
+    NPN_CreateObjectUPP createobject;
+    NPN_RetainObjectUPP retainobject;
+    NPN_ReleaseObjectUPP releaseobject;
+    NPN_InvokeUPP invoke;
+    NPN_InvokeDefaultUPP invokeDefault;
+    NPN_EvaluateUPP evaluate;
+    NPN_GetPropertyUPP getproperty;
+    NPN_SetPropertyUPP setproperty;
+    NPN_RemovePropertyUPP removeproperty;
+    NPN_HasPropertyUPP hasproperty;
+    NPN_HasMethodUPP hasmethod;
+    NPN_ReleaseVariantValueUPP releasevariantvalue;
+    NPN_SetExceptionUPP setexception;
+    NPN_PushPopupsEnabledStateUPP pushpopupsenabledstate;
+    NPN_PopPopupsEnabledStateUPP poppopupsenabledstate;
 } NPNetscapeFuncs;
 
 #ifdef XP_MAC
Index: nsplugins/sdk/npapi.h
===================================================================
--- nsplugins/sdk/npapi.h	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ nsplugins/sdk/npapi.h	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -126,11 +126,11 @@
 /*----------------------------------------------------------------------*/
 
 #define NP_VERSION_MAJOR 0
-#define NP_VERSION_MINOR 11
+#define NP_VERSION_MINOR 13
 
 
 /* The OS/2 version of Netscape uses RC_DATA to define the
-   mime types, file extentions, etc that are required.
+   mime types, file extensions, etc that are required.
    Use a vertical bar to separate types, end types with \0.
    FileVersion and ProductVersion are 32bit ints, all other
    entries are strings the MUST be terminated wwith a \0.
@@ -387,7 +387,8 @@
 
   /* 12 and over are available on Mozilla builds starting with 0.9.9 */
   NPPVjavascriptPushCallerBool = 12,
-  NPPVpluginKeepLibraryInMemory = 13   /* available in Mozilla 1.0 */
+  NPPVpluginKeepLibraryInMemory = 13,   /* available in Mozilla 1.0 */
+  NPPVpluginNeedsXEmbed         = 14
 } NPPVariable;
 
 /*
@@ -404,10 +405,20 @@
   /* 10 and over are available on Mozilla builds starting with 0.9.4 */
   NPNVserviceManager = (10 | NP_ABI_MASK),
   NPNVDOMElement     = (11 | NP_ABI_MASK),   /* available in Mozilla 1.2 */
-  NPNVDOMWindow      = (12 | NP_ABI_MASK)
+  NPNVDOMWindow      = (12 | NP_ABI_MASK),
+  NPNVToolkit        = (13 | NP_ABI_MASK),
+  NPNVSupportsXEmbedBool = 14
 } NPNVariable;
 
 /*
+ * The type of Tookkit the widgets use
+ */
+typedef enum {
+  NPNVGtk12 = 1,
+  NPNVGtk2
+} NPNToolkitType;
+
+/*
  * The type of a NPWindow - it specifies the type of the data structure
  * returned in the window field.
  */
@@ -428,7 +439,7 @@
   NPRect clipRect; /* Clipping rectangle in port coordinates */
                    /* Used by MAC only.			  */
 #if defined(XP_UNIX) && !defined(XP_MACOSX)
-  void * ws_info; /* Platform-dependent additonal data */
+  void * ws_info; /* Platform-dependent additional data */
 #endif /* XP_UNIX */
   NPWindowType type; /* Is this a window or a drawable? */
 } NPWindow;
Index: nsplugins/viewer/nsplugin.cpp
===================================================================
--- nsplugins/viewer/nsplugin.cpp	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ nsplugins/viewer/nsplugin.cpp	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -180,6 +180,12 @@
          // Offline browsing - no thanks
          *(bool*)value = false;
          return NPERR_NO_ERROR;
+      case NPNVToolkit:
+         *(NPNToolkitType*)value = NPNVGtk2;
+         return NPERR_NO_ERROR;
+      case NPNVSupportsXEmbedBool:
+         *(bool*)value = true;
+         return NPERR_NO_ERROR;
       default:
          return NPERR_INVALID_PARAM;
    }
@@ -484,6 +490,8 @@
     KProtocolManager kpm;
     QString agent = kpm.userAgentForHost("nspluginviewer");
     kdDebug(1431) << "g_NPN_UserAgent() = " << agent << endl;
+    // flash crashes without Firefox UA
+    agent = "Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.1.10) Gecko/2007101500 Firefox/2.0.0.10";
     return agent.latin1();
 }
 
@@ -583,7 +591,7 @@
                                    KLibrary *handle, int width, int height,
                                    QString src, QString /*mime*/,
                                    QString appId, QString callbackId,
-                                   bool embed,
+                                   bool embed, WId xembed,
                                    QObject *parent, const char* name )
    : DCOPObject(), QObject( parent, name ) 
 {
@@ -599,6 +607,8 @@
    _streams.setAutoDelete( true );
    _waitingRequests.setAutoDelete( true );
    _callback = new NSPluginCallbackIface_stub( appId.latin1(), callbackId.latin1() );
+   _xembed_window = xembed;
+   _toplevel = _form = 0;
 
    KURL base(src);
    base.setFileName( QString::null );
@@ -619,51 +629,53 @@
    if (height == 0)
       height = 1200;
 
-   // create drawing area
-   Arg args[7];
-   Cardinal nargs = 0;
-   XtSetArg(args[nargs], XtNwidth, width); nargs++;
-   XtSetArg(args[nargs], XtNheight, height); nargs++;
-   XtSetArg(args[nargs], XtNborderWidth, 0); nargs++;
+   if( _xembed_window == 0 ) {
+      // create drawing area
+      Arg args[7];
+      Cardinal nargs = 0;
+      XtSetArg(args[nargs], XtNwidth, width); nargs++;
+      XtSetArg(args[nargs], XtNheight, height); nargs++;
+      XtSetArg(args[nargs], XtNborderWidth, 0); nargs++;
 
-   String n, c;
-   XtGetApplicationNameAndClass(qt_xdisplay(), &n, &c);
+      String n, c;
+      XtGetApplicationNameAndClass(qt_xdisplay(), &n, &c);
 
-   _toplevel = XtAppCreateShell("drawingArea", c, applicationShellWidgetClass,
-                                qt_xdisplay(), args, nargs);
+      _toplevel = XtAppCreateShell("drawingArea", c, applicationShellWidgetClass,
+                                   qt_xdisplay(), args, nargs);
 
-   // What exactly does widget mapping mean? Without this call the widget isn't
-   // embedded correctly. With it the viewer doesn't show anything in standalone mode.
-   //if (embed)
-      XtSetMappedWhenManaged(_toplevel, False);
-   XtRealizeWidget(_toplevel);
+      // What exactly does widget mapping mean? Without this call the widget isn't
+      // embedded correctly. With it the viewer doesn't show anything in standalone mode.
+      //if (embed)
+         XtSetMappedWhenManaged(_toplevel, False);
+      XtRealizeWidget(_toplevel);
 
-   // Create form window that is searched for by flash plugin
-   _form = XtVaCreateWidget("form", compositeWidgetClass, _toplevel, NULL);
-   XtSetArg(args[nargs], XtNvisual, QPaintDevice::x11AppVisual()); nargs++;
-   XtSetArg(args[nargs], XtNdepth, QPaintDevice::x11AppDepth()); nargs++;
-   XtSetArg(args[nargs], XtNcolormap, QPaintDevice::x11AppColormap()); nargs++;
-   XtSetValues(_form, args, nargs);
-   XSync(qt_xdisplay(), false);
+      // Create form window that is searched for by flash plugin
+      _form = XtVaCreateWidget("form", compositeWidgetClass, _toplevel, NULL);
+      XtSetArg(args[nargs], XtNvisual, QPaintDevice::x11AppVisual()); nargs++;
+      XtSetArg(args[nargs], XtNdepth, QPaintDevice::x11AppDepth()); nargs++;
+      XtSetArg(args[nargs], XtNcolormap, QPaintDevice::x11AppColormap()); nargs++;
+      XtSetValues(_form, args, nargs);
+      XSync(qt_xdisplay(), false);
 
-   // From mozilla - not sure if it's needed yet, nor what to use for embedder
+      // From mozilla - not sure if it's needed yet, nor what to use for embedder
 #if 0
-   /* this little trick seems to finish initializing the widget */
+      /* this little trick seems to finish initializing the widget */
 #if XlibSpecificationRelease >= 6
-   XtRegisterDrawable(qt_xdisplay(), embedderid, _toplevel);
+      XtRegisterDrawable(qt_xdisplay(), embedderid, _toplevel);
 #else
-   _XtRegisterWindow(embedderid, _toplevel);
+      _XtRegisterWindow(embedderid, _toplevel);
 #endif
 #endif
-   XtRealizeWidget(_form);
-   XtManageChild(_form);
+      XtRealizeWidget(_form);
+      XtManageChild(_form);
 
-   // Register forwarder
-   XtAddEventHandler(_toplevel, (KeyPressMask|KeyReleaseMask), 
-                     False, forwarder, (XtPointer)this );
-   XtAddEventHandler(_form, (KeyPressMask|KeyReleaseMask), 
-                     False, forwarder, (XtPointer)this );
-   XSync(qt_xdisplay(), false);
+      // Register forwarder
+      XtAddEventHandler(_toplevel, (KeyPressMask|KeyReleaseMask), 
+                        False, forwarder, (XtPointer)this );
+      XtAddEventHandler(_form, (KeyPressMask|KeyReleaseMask), 
+                        False, forwarder, (XtPointer)this );
+      XSync(qt_xdisplay(), false);
+   }
 }
 
 NSPluginInstance::~NSPluginInstance()
@@ -714,14 +726,16 @@
         if (saved)
           g_NPN_MemFree(saved);
 
-        XtRemoveEventHandler(_form, (KeyPressMask|KeyReleaseMask), 
-                             False, forwarder, (XtPointer)this);
-        XtRemoveEventHandler(_toplevel, (KeyPressMask|KeyReleaseMask), 
-                             False, forwarder, (XtPointer)this);
-        XtDestroyWidget(_form);
-	_form = 0;
-        XtDestroyWidget(_toplevel);
-	_toplevel = 0;
+        if( _form != 0 ) {
+            XtRemoveEventHandler(_form, (KeyPressMask|KeyReleaseMask), 
+                                 False, forwarder, (XtPointer)this);
+            XtRemoveEventHandler(_toplevel, (KeyPressMask|KeyReleaseMask), 
+                                 False, forwarder, (XtPointer)this);
+            XtDestroyWidget(_form);
+    	    _form = 0;
+            XtDestroyWidget(_toplevel);
+	    _toplevel = 0;
+        }
 
         if (_npp) {
             ::free(_npp);   // matched with malloc() in newInstance
@@ -902,7 +916,6 @@
    _timer->start( 100, true );
 }
 
-
 int NSPluginInstance::setWindow(int remove)
 {
    if (remove)
@@ -926,15 +939,25 @@
    _win.clipRect.bottom = _height;
    _win.clipRect.right = _width;
 
-   _win.window = (void*) XtWindow(_form);
+   if( _xembed_window ) {
+      _win.window = (void*) _xembed_window;
+      _win_info.type = NP_SETWINDOW;
+      _win_info.display = qt_xdisplay();
+      _win_info.visual = DefaultVisualOfScreen(DefaultScreenOfDisplay(qt_xdisplay()));
+      _win_info.colormap = DefaultColormapOfScreen(DefaultScreenOfDisplay(qt_xdisplay()));
+      _win_info.depth = DefaultDepthOfScreen(DefaultScreenOfDisplay(qt_xdisplay()));
+   } else {
+      _win.window = (void*) XtWindow(_form);
+
+      _win_info.type = NP_SETWINDOW;
+      _win_info.display = XtDisplay(_form);
+      _win_info.visual = DefaultVisualOfScreen(XtScreen(_form));
+      _win_info.colormap = DefaultColormapOfScreen(XtScreen(_form));
+      _win_info.depth = DefaultDepthOfScreen(XtScreen(_form));
+   }
+
    kdDebug(1431) << "Window ID = " << _win.window << endl;
 
-   _win_info.type = NP_SETWINDOW;
-   _win_info.display = XtDisplay(_form);
-   _win_info.visual = DefaultVisualOfScreen(XtScreen(_form));
-   _win_info.colormap = DefaultColormapOfScreen(XtScreen(_form));
-   _win_info.depth = DefaultDepthOfScreen(XtScreen(_form));
-
    _win.ws_info = &_win_info;
 
    NPError error = NPSetWindow( &_win );
@@ -959,9 +982,6 @@
 
 void NSPluginInstance::resizePlugin(int w, int h)
 {
-   if (!_visible)
-      return;
-
    if (w == _width && h == _height)
       return;
 
@@ -970,22 +990,30 @@
    _width = w;
    _height = h;
 
-   XResizeWindow(qt_xdisplay(), XtWindow(_form), w, h);
-   XResizeWindow(qt_xdisplay(), XtWindow(_toplevel), w, h);
+   if( _form != 0 ) {
+      XResizeWindow(qt_xdisplay(), XtWindow(_form), w, h);
+      XResizeWindow(qt_xdisplay(), XtWindow(_toplevel), w, h);
 
-   Arg args[7];
-   Cardinal nargs = 0;
-   XtSetArg(args[nargs], XtNwidth, _width); nargs++;
-   XtSetArg(args[nargs], XtNheight, _height); nargs++;
-   XtSetArg(args[nargs], XtNvisual, QPaintDevice::x11AppVisual()); nargs++;
-   XtSetArg(args[nargs], XtNdepth, QPaintDevice::x11AppDepth()); nargs++;
-   XtSetArg(args[nargs], XtNcolormap, QPaintDevice::x11AppColormap()); nargs++;
-   XtSetArg(args[nargs], XtNborderWidth, 0); nargs++;
+      Arg args[7];
+      Cardinal nargs = 0;
+      XtSetArg(args[nargs], XtNwidth, _width); nargs++;
+      XtSetArg(args[nargs], XtNheight, _height); nargs++;
+      XtSetArg(args[nargs], XtNvisual, QPaintDevice::x11AppVisual()); nargs++;
+      XtSetArg(args[nargs], XtNdepth, QPaintDevice::x11AppDepth()); nargs++;
+      XtSetArg(args[nargs], XtNcolormap, QPaintDevice::x11AppColormap()); nargs++;
+      XtSetArg(args[nargs], XtNborderWidth, 0); nargs++;
+ 
+      XtSetValues(_toplevel, args, nargs);
+      XtSetValues(_form, args, nargs);
 
-   XtSetValues(_toplevel, args, nargs);
-   XtSetValues(_form, args, nargs);
+      resizeWidgets(XtWindow(_form), _width, _height);
+   }
 
-   resizeWidgets(XtWindow(_form), _width, _height);
+   // If not visible yet, displayWindow() will call setWindow() again anyway, so avoid this.
+   // This also handled plugins that are broken and cannot handle repeated setWindow() calls
+   // very well.
+   if (!_visible)
+      return;
 
    setWindow();
 
@@ -1405,7 +1433,7 @@
 DCOPRef NSPluginClass::newInstance( QString url, QString mimeType, bool embed,
                                     QStringList argn, QStringList argv,
                                     QString appId, QString callbackId,
-                                    bool reload, bool doPost, QByteArray postData )
+                                    bool reload, bool doPost, QByteArray postData, long xembed )
 {
    kdDebug(1431) << "-> NSPluginClass::NewInstance" << endl;
 
@@ -1449,16 +1477,25 @@
    memset(npp, 0, sizeof(NPP_t));
    npp->ndata = NULL;
 
-   // Create plugin instance object
-   NSPluginInstance *inst = new NSPluginInstance( npp, &_pluginFuncs, _handle,
-                                                  width, height, baseURL, mimeType,
-                                                  appId, callbackId, embed, this );
-
    // create plugin instance
    NPError error = _pluginFuncs.newp(mime, npp, embed ? NP_EMBED : NP_FULL,
                                      argc, _argn, _argv, 0);
    kdDebug(1431) << "NPP_New = " << (int)error << endl;
 
+   // don't use bool here, it can be 1 byte, but some plugins write it as int, and I can't find what the spec says
+   int wants_xembed = false;
+   if (_pluginFuncs.getvalue) {
+      NPError error = _pluginFuncs.getvalue(npp, (NPPVariable)14/*NPPVpluginNeedsXEmbed*/, &wants_xembed );
+      if( error != NPERR_NO_ERROR )
+         wants_xembed = false;
+   }
+   kdDebug(1431) << "Plugin requires XEmbed:" << (bool)wants_xembed << endl;
+
+   // Create plugin instance object
+   NSPluginInstance *inst = new NSPluginInstance( npp, &_pluginFuncs, _handle,
+                                                  width, height, baseURL, mimeType,
+                                                  appId, callbackId, embed, wants_xembed ? xembed : 0, this );
+
    // free arrays with arguments
    delete [] _argn;
    delete [] _argv;
@@ -1493,7 +1530,6 @@
     timer(); //_timer->start( 0, TRUE );
 }
 
-
 /****************************************************************************/
 
 NSPluginStreamBase::NSPluginStreamBase( NSPluginInstance *instance )
@@ -1516,8 +1552,6 @@
 
    delete _tempFile;
    _tempFile = 0;
-   delete _queue;
-   _queue = 0;
 }
 
 
Index: nsplugins/viewer/viewer.cpp
===================================================================
--- nsplugins/viewer/viewer.cpp	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ nsplugins/viewer/viewer.cpp	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -52,6 +52,7 @@
 #include <X11/Shell.h>
 #else
 #include "qxteventloop.h"
+#include "glibevents.h"
 #endif
 
 /**
@@ -249,6 +250,7 @@
 
    kdDebug(1430) << "4 - create KApplication" << endl;
    KApplication app( argc,  argv, "nspluginviewer" );
+   GlibEvents glibevents;
 #endif
 
    {
Index: nsplugins/viewer/NSPluginClassIface.h
===================================================================
--- nsplugins/viewer/NSPluginClassIface.h	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ nsplugins/viewer/NSPluginClassIface.h	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -50,7 +50,7 @@
   virtual DCOPRef newInstance(QString url, QString mimeType, bool embed,
                               QStringList argn, QStringList argv,
                               QString appId, QString callbackId, bool reload,
-                              bool doPost, QByteArray postData) = 0;
+                              bool doPost, QByteArray postData, long xembed) = 0;
   virtual QString getMIMEDescription() = 0;
 
 };
Index: nsplugins/viewer/glibevents.cpp
===================================================================
--- nsplugins/viewer/glibevents.cpp	(.../tags/KDE/3.5.8/kdebase)	(wersja 0)
+++ nsplugins/viewer/glibevents.cpp	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -0,0 +1,43 @@
+/*
+  Copyright (c) 2007 Lubos Lunak <l.lunak@suse.cz>
+ 
+  This program is free software; you can redistribute it and/or modify
+  it under the terms of the GNU General Public License as published by
+  the Free Software Foundation; either version 2 of the License, or
+  (at your option) any later version.
+ 
+  This program is distributed in the hope that it will be useful,
+  but WITHOUT ANY WARRANTY; without even the implied warranty of
+  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+  GNU General Public License for more details.
+ 
+  You should have received a copy of the GNU General Public License
+  along with this program; if not, write to the Free Software
+  Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
+ 
+*/                                                                            
+
+#include "glibevents.h"
+
+#include <qapplication.h>
+
+GlibEvents::GlibEvents()
+    {
+    g_main_context_ref( g_main_context_default());
+    connect( &timer, SIGNAL( timeout()), SLOT( process()));
+    // TODO Poll for now
+    timer.start( 10 );
+    }
+
+GlibEvents::~GlibEvents()
+    {
+    g_main_context_unref( g_main_context_default());
+    }
+
+void GlibEvents::process()
+    {
+    while( g_main_context_pending( g_main_context_default()))
+        g_main_context_iteration( g_main_context_default(), false );
+    }
+
+#include "glibevents.moc"
Index: nsplugins/viewer/nsplugin.h
===================================================================
--- nsplugins/viewer/nsplugin.h	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ nsplugins/viewer/nsplugin.h	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -165,13 +165,13 @@
   // constructor, destructor
   NSPluginInstance( NPP privateData, NPPluginFuncs *pluginFuncs, KLibrary *handle,
 		    int width, int height, QString src, QString mime,
-                    QString appId, QString callbackId, bool embed,
+                    QString appId, QString callbackId, bool embed, WId xembed,
 		    QObject *parent, const char* name=0 );
   ~NSPluginInstance();
 
   // DCOP functions
   void shutdown();
-  int winId() { return XtWindow(_form); }
+  int winId() { return _form != 0 ? XtWindow(_form) : 0; }
   int setWindow(int remove=0);
   void resizePlugin(int w, int h);
   void javascriptResult(int id, QString result);
@@ -232,6 +232,7 @@
   NPPluginFuncs _pluginFuncs;
 
   Widget _area, _form, _toplevel;
+  WId _xembed_window;
   QString _baseURL;
   int _width, _height;
 
@@ -281,7 +282,7 @@
   DCOPRef newInstance(QString url, QString mimeType, bool embed,
                       QStringList argn, QStringList argv,
                       QString appId, QString callbackId, bool reload, bool post,
-                      QByteArray postData );
+                      QByteArray postData, long xembed );
   void destroyInstance( NSPluginInstance* inst );
   bool error() { return _error; }
 
Index: nsplugins/viewer/glibevents.h
===================================================================
--- nsplugins/viewer/glibevents.h	(.../tags/KDE/3.5.8/kdebase)	(wersja 0)
+++ nsplugins/viewer/glibevents.h	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -0,0 +1,41 @@
+/*
+  Copyright (c) 2007 Lubos Lunak <l.lunak@suse.cz>
+ 
+  This program is free software; you can redistribute it and/or modify
+  it under the terms of the GNU General Public License as published by
+  the Free Software Foundation; either version 2 of the License, or
+  (at your option) any later version.
+ 
+  This program is distributed in the hope that it will be useful,
+  but WITHOUT ANY WARRANTY; without even the implied warranty of
+  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+  GNU General Public License for more details.
+ 
+  You should have received a copy of the GNU General Public License
+  along with this program; if not, write to the Free Software
+  Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
+ 
+*/                                                                            
+
+#ifndef GLIBEVENTS_H
+#define GLIBEVENTS_H
+
+#include <qwidget.h>
+#include <qtimer.h>
+
+#include <glib.h>
+
+class GlibEvents
+    : public QWidget
+    {
+    Q_OBJECT
+    public:
+        GlibEvents();
+        virtual ~GlibEvents();
+    private slots:
+        void process();
+    private:
+        QTimer timer;
+    };
+
+#endif
Index: nsplugins/viewer/Makefile.am
===================================================================
--- nsplugins/viewer/Makefile.am	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ nsplugins/viewer/Makefile.am	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -1,12 +1,11 @@
-INCLUDES = -I$(top_srcdir)/nsplugins -I$(top_builddir)/nsplugins $(all_includes)
+INCLUDES = -I$(top_srcdir)/nsplugins -I$(top_builddir)/nsplugins $(all_includes) `pkg-config --cflags glib-2.0`
 METASOURCES = AUTO
 
 bin_PROGRAMS = nspluginviewer 
 
 nspluginviewer_SOURCES = NSPluginCallbackIface.stub NSPluginClassIface.skel \
-	nsplugin.cpp viewer.cpp kxt.cpp qxteventloop.cpp
-nspluginviewer_LDFLAGS = $(all_libraries) $(KDE_RPATH) -export-dynamic
+	nsplugin.cpp viewer.cpp kxt.cpp qxteventloop.cpp glibevents.cpp
+nspluginviewer_LDFLAGS = $(all_libraries) $(KDE_RPATH) -export-dynamic `pkg-config --libs glib-2.0`
 nspluginviewer_LDADD = $(LIB_KIO) $(LIB_KPARTS) -lXt
 
 NSPluginCallbackIface_DIR = $(srcdir)/..
-
Index: nsplugins/nspluginloader.cpp
===================================================================
--- nsplugins/nspluginloader.cpp	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ nsplugins/nspluginloader.cpp	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -54,11 +54,16 @@
 int NSPluginLoader::s_refCount = 0;
 
 
-NSPluginInstance::NSPluginInstance(QWidget *parent, const QCString& app, const QCString& id)
-  : DCOPStub(app, id), NSPluginInstanceIface_stub(app, id), EMBEDCLASS(parent)
+NSPluginInstance::NSPluginInstance(QWidget *parent)
+  : EMBEDCLASS(parent), stub( NULL )
 {
     _loader = 0L;
     shown = false;
+}
+
+void NSPluginInstance::init(const QCString& app, const QCString& obj)
+{
+    stub = new NSPluginInstanceIface_stub( app, obj );
     QGridLayout *_layout = new QGridLayout(this, 1, 1);
     KConfig cfg("kcmnspluginrc", false);
     cfg.setGroup("Misc");
@@ -80,12 +85,19 @@
         _button = 0L;
         _loader = NSPluginLoader::instance();
         setBackgroundMode(QWidget::NoBackground);
-        setProtocol(QXEmbed::XPLAIN);
-        embed( NSPluginInstanceIface_stub::winId() );
+        WId winid = stub->winId();
+        if( winid != 0 ) {
+            setProtocol(QXEmbed::XPLAIN);
+            embed( winid );
+        } else {
+            setProtocol(QXEmbed::XEMBED);
+        }
+        // resize before showing, some plugins are stupid and can't handle repeated
+        // NPSetWindow() calls very well
+        resizePlugin(width(), height());
         displayPlugin();
         show();
         shown = true;
-        if (isVisible()) resizePlugin(width(), height());
     }
 }
 
@@ -97,6 +109,7 @@
    kdDebug() << "release" << endl;
    _loader->release();
    kdDebug() << "<- NSPluginInstance::~NSPluginInstance" << endl;
+   delete stub;
 }
 
 
@@ -127,6 +140,24 @@
   resizePlugin(width(), height());
 }
 
+void NSPluginInstance::displayPlugin()
+{
+  qApp->syncX(); // process pending X commands
+  stub->displayPlugin();
+}
+
+void NSPluginInstance::resizePlugin( int w, int h )
+{
+  qApp->syncX();
+  stub->resizePlugin( w, h );
+}
+
+void NSPluginInstance::shutdown()
+{
+  if( stub )
+    stub->shutdown();
+}
+
 /*******************************************************************************/
 
 
@@ -445,20 +476,20 @@
    if ( mime=="application/x-shockwave-flash" )
        embed = true; // flash doesn't work in full mode :(
 
+   NSPluginInstance *plugin = new NSPluginInstance( parent );
+   kdDebug() << "<- NSPluginLoader::NewInstance = " << (void*)plugin << endl;
 
    // get plugin instance
-   DCOPRef inst_ref = cls->newInstance( url, mime, embed, argn, argv, appId, callbackId, reload, doPost, postData);
+   DCOPRef inst_ref = cls->newInstance( url, mime, embed, argn, argv, appId, callbackId, reload, doPost, postData, plugin->winId());
    if ( inst_ref.isNull() )
    {
       kdDebug() << "Couldn't create plugin instance" << endl;
+      delete plugin;
       return 0;
    }
 
-   NSPluginInstance *plugin = new NSPluginInstance( parent, inst_ref.app(),
-                                                    inst_ref.object() );
+   plugin->init( inst_ref.app(), inst_ref.object() );
 
-   kdDebug() << "<- NSPluginLoader::NewInstance = " << (void*)plugin << endl;
-
    return plugin;
 }
 
Index: nsplugins/nspluginloader.h
===================================================================
--- nsplugins/nspluginloader.h	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ nsplugins/nspluginloader.h	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -43,13 +43,16 @@
 class QPushButton;
 class QGridLayout;
 
-class NSPluginInstance : public EMBEDCLASS, virtual public NSPluginInstanceIface_stub
+class NSPluginInstance : public EMBEDCLASS
 {
   Q_OBJECT
 
 public:
-    NSPluginInstance(QWidget *parent, const QCString& app, const QCString& id);
+    NSPluginInstance(QWidget *parent);
+    void init( const QCString& app, const QCString& obj );
     ~NSPluginInstance();
+public: // wrappers
+    void javascriptResult( int id, QString result ) { stub->javascriptResult( id, result ); }
 
 private slots:
     void doLoadPlugin();
@@ -62,6 +65,11 @@
     bool shown;
     QPushButton *_button;
     QGridLayout *_layout;
+    NSPluginInstanceIface_stub* stub;
+private: // wrappers
+    void displayPlugin();
+    void resizePlugin( int w, int h );
+    void shutdown();
 };
 
 
Index: kappfinder/apps/Graphics/blender.desktop
===================================================================
--- kappfinder/apps/Graphics/blender.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kappfinder/apps/Graphics/blender.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -4,7 +4,7 @@
 Name[bn]=ব্লেণ্ডার
 Name[fa]=مخلوط‌کن
 Name[hi]=ब्लैण्डर
-Name[is]=Hrærivél
+Name[is]=Blandarinn
 Name[km]=កម្មវិធី​លាយ
 Name[ko]=블렌더
 Name[mk]=Блендер
@@ -46,7 +46,7 @@
 GenericName[hi]=3डी मॉडलर/रेंडरर
 GenericName[hr]=Program za modeliranje i iscrtavanje 3d scena
 GenericName[hu]=3D-s modellező
-GenericName[is]=Tól til vinnslu með 3D hluti
+GenericName[is]=Tól til vinnslu með 3D form
 GenericName[it]=Modellatore e render 3D
 GenericName[ja]=3D モデラー/レンダラー
 GenericName[kk]=3D Үлгілеу/Көрсету
Index: kdesktop/xautolock_engine.c
===================================================================
--- kdesktop/xautolock_engine.c	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdesktop/xautolock_engine.c	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -157,7 +157,7 @@
 #if 0
           newTrigger = now + (useRedelay ? cornerRedelay : cornerDelay) - 1;
 #else
-          newTrigger = now + 2 - 1;
+          newTrigger = now;
 #endif
 
 #if 0
Index: kdesktop/lockeng.cc
===================================================================
--- kdesktop/lockeng.cc	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdesktop/lockeng.cc	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -156,7 +156,7 @@
 	    connect(mXAutoLock, SIGNAL(timeout()), SLOT(idleTimeout()));
 	}
         mXAutoLock->setTimeout(mTimeout);
-        mXAutoLock->setDPMS(mDPMS);
+        mXAutoLock->setDPMS(true);
 	//mXAutoLock->changeCornerLockStatus( mLockCornerTopLeft, mLockCornerTopRight, mLockCornerBottomLeft, mLockCornerBottomRight);
 
         // We'll handle blanking
@@ -204,7 +204,6 @@
 
     bool e  = KDesktopSettings::screenSaverEnabled();
     mTimeout = KDesktopSettings::timeout();
-    mDPMS = KDesktopSettings::dpmsDependent();
 
     mEnabled = !e;   // force the enable()
 
@@ -301,14 +300,17 @@
 
     mLockProcess.kill();
 
-    if (mXAutoLock)
+    if (mEnabled)
     {
-        mXAutoLock->start();
+        if (mXAutoLock)
+        {
+            mXAutoLock->start();
+        }
+        XForceScreenSaver(qt_xdisplay(), ScreenSaverReset );
+        XSetScreenSaver(qt_xdisplay(), mTimeout + 10, mXInterval, PreferBlanking, mXExposures);
     }
     processLockTransactions();
     mState = Waiting;
-    XForceScreenSaver(qt_xdisplay(), ScreenSaverReset );
-    XSetScreenSaver(qt_xdisplay(), mTimeout + 10, mXInterval, PreferBlanking, mXExposures);
 }
 
 void SaverEngine::lockProcessExited()
@@ -317,14 +319,17 @@
     if( mState == Waiting )
 	return;
     emitDCOPSignal("KDE_stop_screensaver()", QByteArray());
-    if (mXAutoLock)
+    if (mEnabled)
     {
-        mXAutoLock->start();
+        if (mXAutoLock)
+        {
+            mXAutoLock->start();
+        }
+        XForceScreenSaver(qt_xdisplay(), ScreenSaverReset );
+        XSetScreenSaver(qt_xdisplay(), mTimeout + 10, mXInterval, PreferBlanking, mXExposures);
     }
     processLockTransactions();
     mState = Waiting;
-    XForceScreenSaver(qt_xdisplay(), ScreenSaverReset );
-    XSetScreenSaver(qt_xdisplay(), mTimeout + 10, mXInterval, PreferBlanking, mXExposures);
 }
 
 //---------------------------------------------------------------------------
Index: kdesktop/kdiconview.cc
===================================================================
--- kdesktop/kdiconview.cc	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdesktop/kdiconview.cc	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -485,7 +485,7 @@
 
     // Auto line-up icons
     if ( b ) {
-        lineupIcons();
+            lineupIcons();
         connect( this, SIGNAL( iconMoved() ),
                  this, SLOT( lineupIcons() ) );
     }
@@ -919,6 +919,11 @@
             if (cfg.readListEntry("NotShowIn", ';').contains("KDE"))
                 return false;
         }
+        if (cfg.hasKey("TryExec"))
+        {
+            if (KStandardDirs::findExe( cfg.readEntry( "TryExec" ) ).isEmpty())
+                return false;
+        }
 
         QString name = cfg.readEntry("Name");
         if ( !name.isEmpty() )
Index: kdesktop/kdesktop.kcfg
===================================================================
--- kdesktop/kdesktop.kcfg	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdesktop/kdesktop.kcfg	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -232,8 +232,10 @@
     </entry>
     <entry name="DpmsDependent" key="DPMS-dependent" type="Bool">
       <default>true</default>
-      <label>Disable screen saver during presentation or TV</label>
-      <whatsthis>Enable this option if you want to disable the screen saver while watching TV or movies.</whatsthis>
+      <label>Suspend screen saver when DPMS kicks in</label>
+      <whatsthis>Usually the screen saver is suspended when display power saving kicks in,
+       as nothing can be seen on the screen anyway, obviously. However, some screen savers
+       actually perform useful computations, so it is not desirable to suspend them.</whatsthis>
     </entry>
     <entry key="ActionTopLeft" type="Int">
       <default>0</default>
Index: kdesktop/xautolock.cc
===================================================================
--- kdesktop/xautolock.cc	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdesktop/xautolock.cc	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -43,10 +43,12 @@
 
 static XAutoLock* self = NULL;
 
+extern "C" {
 static int catchFalseAlarms(Display *, XErrorEvent *)
 {
     return 0;
 }
+}
 
 //===========================================================================
 //
@@ -56,16 +58,16 @@
 XAutoLock::XAutoLock()
 {
     self = this;
-    int dummy = 0;
-    dummy = dummy; // shut up
     xautolock_useXidle = 0;
     xautolock_useMit = 0;
 #ifdef HAVE_XIDLE
-    useXidle = XidleQueryExtension( qt_xdisplay(), &dummy, &dummy );
+    int dummy1;
+    xautolock_useXidle = XidleQueryExtension( qt_xdisplay(), &dummy1, &dummy1 );
 #endif
 #ifdef HAVE_XSCREENSAVER
+    int dummy2;
     if( !xautolock_useXidle )
-        xautolock_useMit = XScreenSaverQueryExtension( qt_xdisplay(), &dummy, &dummy );
+        xautolock_useMit = XScreenSaverQueryExtension( qt_xdisplay(), &dummy2, &dummy2 );
 #endif
     if( !xautolock_useXidle && !xautolock_useMit )
     {
@@ -110,6 +112,13 @@
 
 void XAutoLock::setDPMS(bool s)
 {
+#ifdef HAVE_DPMS
+    BOOL on;
+    CARD16 state;
+    DPMSInfo( qt_xdisplay(), &state, &on );
+    if (!on)
+        s = false;
+#endif
     mDPMS = s;
 }
 
@@ -222,7 +231,9 @@
         activate = true;
     if(!on && mDPMS) {
         activate = false;
+#ifdef HAVE_XSCREENSAVER
         XForceScreenSaver(qt_xdisplay(), ScreenSaverReset );
+#endif
         resetTrigger();
     }
 #endif
@@ -233,7 +244,7 @@
     if (XScreenSaverQueryInfo (qt_xdisplay(), DefaultRootWindow (qt_xdisplay()), mitInfo)) {
         //kdDebug() << "XScreenSaverQueryInfo " << mitInfo->state << " " << ScreenSaverDisabled << endl;
         if (mitInfo->state == ScreenSaverDisabled)
-	    activate = false;
+            activate = false;
     }
 #endif
 
Index: kdesktop/init/Templates/linkDVDROM.desktop
===================================================================
--- kdesktop/init/Templates/linkDVDROM.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdesktop/init/Templates/linkDVDROM.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -40,11 +40,11 @@
 Name[mn]=DVD-ROM төхөөрөмж...
 Name[ms]=Peranti DVD-ROM...
 Name[mt]=DVD-ROM...
-Name[nb]=DVD-ROM-enhet ...
+Name[nb]=DVD-ROM-enhet …
 Name[nds]=DVD-ROM-Reedschap...
 Name[ne]=DVD-ROM यन्त्र...
 Name[nl]=DVD-romspeler...
-Name[nn]=DVD-ROM-eining ...
+Name[nn]=DVD-ROM-eining …
 Name[pa]=DVD-ROM ਜੰਤਰ...
 Name[pl]=Urządzenie DVD-ROM...
 Name[pt]=Leitor de DVD-ROMs...
Index: kdesktop/init/Templates/linkHD.desktop
===================================================================
--- kdesktop/init/Templates/linkHD.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdesktop/init/Templates/linkHD.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -40,11 +40,11 @@
 Name[mn]=Хатуу диск...
 Name[ms]=Peranti Cakera Keras...
 Name[mt]=Ħard disk...
-Name[nb]=Harddisk ...
+Name[nb]=Harddisk …
 Name[nds]=Fastplaat...
 Name[ne]=हार्डडिस्क यन्त्र...
 Name[nl]=Harde Schijf...
-Name[nn]=Harddisk ...
+Name[nn]=Harddisk …
 Name[pa]=ਹਾਰਡ-ਡਿਸਕ ਜੰਤਰ...
 Name[pl]=Twardy dysk...
 Name[pt]=Disco Rígido...
Index: kdesktop/init/Templates/linkURL.desktop
===================================================================
--- kdesktop/init/Templates/linkURL.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdesktop/init/Templates/linkURL.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -40,11 +40,11 @@
 Name[mn]=Хаягтай (URL) холбох...
 Name[ms]=Paut ke Aplikasi (URL)...
 Name[mt]=Link għal lokazzjoni (URL)...
-Name[nb]=Lenke til nettadresse (URL) ...
+Name[nb]=Lenke til nettadresse (URL) …
 Name[nds]=Link na'n Oort (URL)...
 Name[ne]=स्थानमा लिङ्क गर्नुहोस् (यूआरएल)...
 Name[nl]=Koppeling naar locatie (URL-adres)...
-Name[nn]=Lenkje til nettadresse (URL) ...
+Name[nn]=Lenkje til nettadresse (URL) …
 Name[pa]=ਸਥਿਤੀ (URL) ਨਾਲ ਸੰਬੰਧ...
 Name[pl]=Skrót do adresu (URL)...
 Name[pt]=Atalho para Localização (URL)...
Index: kdesktop/init/Templates/linkZIP.desktop
===================================================================
--- kdesktop/init/Templates/linkZIP.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdesktop/init/Templates/linkZIP.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -40,11 +40,11 @@
 Name[mn]=ZIP Төхөөрөмж..
 Name[ms]=Peranti ZIP...
 Name[mt]=Apparat ZIP
-Name[nb]=ZIP-enhet ...
+Name[nb]=ZIP-enhet …
 Name[nds]=ZIP-Reedschap...
 Name[ne]=ZIP यन्त्र...
 Name[nl]=ZIP-apparaat...
-Name[nn]=ZIP-eining ...
+Name[nn]=ZIP-eining …
 Name[pa]=ZIP ਜੰਤਰ...
 Name[pl]=Napęd ZIP...
 Name[pt]=Dispositivo ZIP...
Index: kdesktop/init/Templates/linkCDROM.desktop
===================================================================
--- kdesktop/init/Templates/linkCDROM.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdesktop/init/Templates/linkCDROM.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -40,11 +40,11 @@
 Name[mn]=КД-ROM төхөөрөмж...
 Name[ms]=Peranti CD-ROM...
 Name[mt]=CDROM...
-Name[nb]=CD-ROM-enhet ...
+Name[nb]=CD-ROM-enhet …
 Name[nds]=CD-ROM-Reedschap...
 Name[ne]=CD-ROM यन्त्र...
 Name[nl]=CD-romspeler...
-Name[nn]=CD-ROM-eining ...
+Name[nn]=CD-ROM-eining …
 Name[pa]=CD-ROM ਜੰਤਰ...
 Name[pl]=Urządzenie CD-ROM...
 Name[pt]=Dispositivo de CD-ROM...
Index: kdesktop/init/Templates/TextFile.desktop
===================================================================
--- kdesktop/init/Templates/TextFile.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdesktop/init/Templates/TextFile.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -40,11 +40,11 @@
 Name[mn]=Текст файл...
 Name[ms]=Fail Teks...
 Name[mt]=Fajl ta' test...
-Name[nb]=Tekstfil ...
+Name[nb]=Tekstfil …
 Name[nds]=Textdatei...
 Name[ne]=पाठ फाइल...
 Name[nl]=Tekstbestand...
-Name[nn]=Tekstfil ...
+Name[nn]=Tekstfil …
 Name[pa]=ਪਾਠ ਫਾਇਲ...
 Name[pl]=Plik tekstowy...
 Name[pt]=Ficheiro de Texto...
Index: kdesktop/init/Templates/linkProgram.desktop
===================================================================
--- kdesktop/init/Templates/linkProgram.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdesktop/init/Templates/linkProgram.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -40,11 +40,11 @@
 Name[mn]=Програмтай холбох...
 Name[ms]=Paut ke Aplikasi...
 Name[mt]=Link għal programm...
-Name[nb]=Lenke til program ...
+Name[nb]=Lenke til program …
 Name[nds]=Link na'n Programm...
 Name[ne]=अनुप्रयोगमा लिङ्क गर्नुहोस्...
 Name[nl]=Koppeling naar toepassing...
-Name[nn]=Lenkje til program ...
+Name[nn]=Lenkje til program …
 Name[pa]=ਕਾਰਜ ਨਾਲ ਸੰਬੰਧ...
 Name[pl]=Skrót do programu...
 Name[pt]=Atalho para Aplicação...
Index: kdesktop/init/Templates/linkFloppy.desktop
===================================================================
--- kdesktop/init/Templates/linkFloppy.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdesktop/init/Templates/linkFloppy.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -40,11 +40,11 @@
 Name[mn]=Уян диск...
 Name[ms]=Peranti Liut...
 Name[mt]=Floppy...
-Name[nb]=Diskettenhet ...
+Name[nb]=Diskettenhet …
 Name[nds]=Diskett-Reedschap...
 Name[ne]=फ्लपी यन्त्र...
 Name[nl]=Diskettestation...
-Name[nn]=Disketteining ...
+Name[nn]=Disketteining …
 Name[pa]=ਫਲਾਪੀ ਜੰਤਰ...
 Name[pl]=Stacja dyskietek...
 Name[pt]=Leitor de Disquetes...
Index: kdesktop/init/Templates/linkMO.desktop
===================================================================
--- kdesktop/init/Templates/linkMO.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdesktop/init/Templates/linkMO.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -40,11 +40,11 @@
 Name[mn]=MO Төхөөрөмж...
 Name[ms]=Peranti MO...
 Name[mt]=Apparat MO...
-Name[nb]=MO-enhet ...
+Name[nb]=MO-enhet …
 Name[nds]=MO-Reedschap...
 Name[ne]=MO यन्त्र...
 Name[nl]=MO-apparaat...
-Name[nn]=MO-eining ...
+Name[nn]=MO-eining …
 Name[pa]=MO ਜੰਤਰ...
 Name[pl]=Napęd magnetooptyczny...
 Name[pt]=Dispositivo MO...
Index: kdesktop/init/Templates/linkCDWRITER.desktop
===================================================================
--- kdesktop/init/Templates/linkCDWRITER.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdesktop/init/Templates/linkCDWRITER.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -44,7 +44,7 @@
 Name[nds]=CD-Brenner...
 Name[ne]=CDWRITER यन्त्र...
 Name[nl]=CD-writer...
-Name[nn]=CD-brennareining ...
+Name[nn]=CD-brennareining …
 Name[pa]=CDWRITER ਜੰਤਰ...
 Name[pl]=Nagrywarka CD...
 Name[pt]=Gravador de CDs...
Index: kdesktop/init/Templates/HTMLFile.desktop
===================================================================
--- kdesktop/init/Templates/HTMLFile.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdesktop/init/Templates/HTMLFile.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -40,11 +40,11 @@
 Name[mn]=HTML-Файл...
 Name[ms]=Fail HTML...
 Name[mt]=Fajl HTML...
-Name[nb]=HTML-fil ...
+Name[nb]=HTML-fil …
 Name[nds]=HTML-Datei...
 Name[ne]=HTML फाइल...
 Name[nl]=HTML-bestand...
-Name[nn]=HTML-fil ...
+Name[nn]=HTML-fil …
 Name[pa]=HTML ਫਾਇਲ...
 Name[pl]=Plik HTML...
 Name[pt]=Ficheiro HTML...
Index: kdesktop/init/Templates/Directory.desktop
===================================================================
--- kdesktop/init/Templates/Directory.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdesktop/init/Templates/Directory.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -39,11 +39,11 @@
 Name[mk]=Папка...
 Name[mn]=Хавтас...
 Name[mt]=Direttorju...
-Name[nb]=Mappe ...
+Name[nb]=Mappe …
 Name[nds]=Orner...
 Name[ne]=फोल्डर...
 Name[nl]=Map...
-Name[nn]=Mappe ...
+Name[nn]=Mappe …
 Name[pa]=ਫੋਲਡਰ...
 Name[pl]=Katalog...
 Name[pt]=Pasta...
Index: kdesktop/init/Templates/linkNFS.desktop
===================================================================
--- kdesktop/init/Templates/linkNFS.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdesktop/init/Templates/linkNFS.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -7,8 +7,8 @@
 Name[de]=NFS ...
 Name[hi]=एनएफ़एस...
 Name[hu]=NFS-megosztás...
-Name[nb]=NFS ...
-Name[nn]=NFS ...
+Name[nb]=NFS …
+Name[nn]=NFS …
 Name[ru]=Диск NFS...
 Name[se]=NFS …
 Name[sl]=NFS ...
Index: kdesktop/init/Templates/linkCAMERA.desktop
===================================================================
--- kdesktop/init/Templates/linkCAMERA.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdesktop/init/Templates/linkCAMERA.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -40,11 +40,11 @@
 Name[mn]=Камерын Төхөөрөмж...
 Name[ms]=Peranti Kamera...
 Name[mt]=Kamera...
-Name[nb]=Kameraenhet ...
+Name[nb]=Kameraenhet …
 Name[nds]=Kamera...
 Name[ne]=क्यामेरा यन्त्र...
 Name[nl]=Camera...
-Name[nn]=Kameraeining ...
+Name[nn]=Kameraeining …
 Name[pa]=ਕੈਮਰਾ ਜੰਤਰ...
 Name[pl]=Aparat fotograficzny...
 Name[pt]=Máquina Fotográfica...
Index: kdesktop/lockeng.h
===================================================================
--- kdesktop/lockeng.h	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdesktop/lockeng.h	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -93,7 +93,6 @@
 protected:
     enum State { Waiting, Preparing, Saving };
     bool        mEnabled;
-    bool	mDPMS;
 
     State       mState;
     XAutoLock   *mXAutoLock;
Index: applnk/kde-utilities-file.directory
===================================================================
--- applnk/kde-utilities-file.directory	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ applnk/kde-utilities-file.directory	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -34,6 +34,7 @@
 Name[ja]=ファイル
 Name[kk]=Файл
 Name[km]=ឯកសារ
+Name[ku]=Pel
 Name[lt]=Byla
 Name[mk]=Датотека
 Name[ms]=Fail
@@ -99,6 +100,7 @@
 Comment[ja]=ファイル
 Comment[kk]=Файл
 Comment[km]=ឯកសារ
+Comment[ku]=Pel
 Comment[lt]=Byla
 Comment[mk]=Датотека
 Comment[ms]=Fail
Index: konqueror/remoteencodingplugin/kremoteencodingplugin.desktop
===================================================================
--- konqueror/remoteencodingplugin/kremoteencodingplugin.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/remoteencodingplugin/kremoteencodingplugin.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -41,7 +41,7 @@
 Name[it]=Plugin codifica remota
 Name[ja]=リモートエンコーディングプラグイン
 Name[kk]=Қашықтан баптау
-Name[km]=កម្មវិធី​ជំនួយ​ការបម្លែង​ជាកូដ​ឆ្ងាយ
+Name[km]=កម្មវិធី​ជំនួយ​ការ​អ៊ិនកូដ​ពី​ចម្ងាយ
 Name[lt]=Nutolusių vietų koduotės priedas
 Name[mk]=Приклучок за оддалечено кодирање
 Name[ms]=Plugin Pengekodan Jauh
@@ -100,7 +100,7 @@
 Comment[it]=Plugin per la codifica remota di Konqueror
 Comment[ja]=Konqueror 用のリモートエンコーディングプラグイン
 Comment[kk]=Қашықтан баптау модулі
-Comment[km]=កម្មវិធី​ជំនួយ​បម្លែង​ជាកូដឆ្ងាយ សម្រាប់ Konqueror
+Comment[km]=កម្មវិធី​ជំនួយ​​ការ​អ៊ិនកូដ​សម្រាប់ Konqueror
 Comment[lt]=Nutolusių vietų koduotės Konqueror priedas
 Comment[mk]=Приклучок за оддалечено кодирање за Konqueror
 Comment[ms]=Plugin Pengekodan Jauh untuk Konqueror
Index: konqueror/profile_tabbedbrowsing.desktop
===================================================================
--- konqueror/profile_tabbedbrowsing.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/profile_tabbedbrowsing.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -39,11 +39,11 @@
 Name[mk]=Прелистување со ливчиња
 Name[ms]=Pelayaran Bertab
 Name[mt]=Browsing bit-tabs
-Name[nb]=Nettleser med arkfaner
+Name[nb]=Nettleser med faner
 Name[nds]=Nettkieken mit Paneels
 Name[ne]=ट्याब गरिएको ब्राउजिङ
 Name[nl]=Browser met tabbladen
-Name[nn]=Nettlesar med arkfaner
+Name[nn]=Nettlesar med faner
 Name[pa]=ਟੈਬ ਝਲਕੀ
 Name[pl]=Przeglądanie wielu stron w jednym oknie
 Name[pt]=Navegação por Páginas
Index: konqueror/quickprint/text-tex-print.desktop
===================================================================
--- konqueror/quickprint/text-tex-print.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/quickprint/text-tex-print.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -43,11 +43,11 @@
 Name[mk]=Печати...
 Name[ms]=Cetak...
 Name[mt]=Ipprintja...
-Name[nb]=Skriv ut...
+Name[nb]=Skriv ut …
 Name[nds]=Drucken...
 Name[ne]=मुद्रण...
 Name[nl]=Afdrukken...
-Name[nn]=Skriv ut ...
+Name[nn]=Skriv ut …
 Name[pa]=ਛਪਾਈ...
 Name[pl]=Drukuj...
 Name[pt]=Imprimir...
Index: konqueror/quickprint/text-xml-print.desktop
===================================================================
--- konqueror/quickprint/text-xml-print.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/quickprint/text-xml-print.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -43,11 +43,11 @@
 Name[mk]=Печати...
 Name[ms]=Cetak...
 Name[mt]=Ipprintja...
-Name[nb]=Skriv ut...
+Name[nb]=Skriv ut …
 Name[nds]=Drucken...
 Name[ne]=मुद्रण...
 Name[nl]=Afdrukken...
-Name[nn]=Skriv ut ...
+Name[nn]=Skriv ut …
 Name[pa]=ਛਪਾਈ...
 Name[pl]=Drukuj...
 Name[pt]=Imprimir...
Index: konqueror/quickprint/text-print.desktop
===================================================================
--- konqueror/quickprint/text-print.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/quickprint/text-print.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -43,11 +43,11 @@
 Name[mk]=Печати...
 Name[ms]=Cetak...
 Name[mt]=Ipprintja...
-Name[nb]=Skriv ut...
+Name[nb]=Skriv ut …
 Name[nds]=Drucken...
 Name[ne]=मुद्रण...
 Name[nl]=Afdrukken...
-Name[nn]=Skriv ut ...
+Name[nn]=Skriv ut …
 Name[pa]=ਛਪਾਈ...
 Name[pl]=Drukuj...
 Name[pt]=Imprimir...
Index: konqueror/quickprint/text-perl-print.desktop
===================================================================
--- konqueror/quickprint/text-perl-print.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/quickprint/text-perl-print.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -43,11 +43,11 @@
 Name[mk]=Печати...
 Name[ms]=Cetak...
 Name[mt]=Ipprintja...
-Name[nb]=Skriv ut...
+Name[nb]=Skriv ut …
 Name[nds]=Drucken...
 Name[ne]=मुद्रण...
 Name[nl]=Afdrukken...
-Name[nn]=Skriv ut ...
+Name[nn]=Skriv ut …
 Name[pa]=ਛਪਾਈ...
 Name[pl]=Drukuj...
 Name[pt]=Imprimir...
Index: konqueror/quickprint/text-html-print.desktop
===================================================================
--- konqueror/quickprint/text-html-print.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/quickprint/text-html-print.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -43,11 +43,11 @@
 Name[mk]=Печати...
 Name[ms]=Cetak...
 Name[mt]=Ipprintja...
-Name[nb]=Skriv ut...
+Name[nb]=Skriv ut …
 Name[nds]=Drucken...
 Name[ne]=मुद्रण...
 Name[nl]=Afdrukken...
-Name[nn]=Skriv ut ...
+Name[nn]=Skriv ut …
 Name[pa]=ਛਪਾਈ...
 Name[pl]=Drukuj...
 Name[pt]=Imprimir...
Index: konqueror/quickprint/text-diff-print.desktop
===================================================================
--- konqueror/quickprint/text-diff-print.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/quickprint/text-diff-print.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -43,11 +43,11 @@
 Name[mk]=Печати...
 Name[ms]=Cetak...
 Name[mt]=Ipprintja...
-Name[nb]=Skriv ut...
+Name[nb]=Skriv ut …
 Name[nds]=Drucken...
 Name[ne]=मुद्रण...
 Name[nl]=Afdrukken...
-Name[nn]=Skriv ut ...
+Name[nn]=Skriv ut …
 Name[pa]=ਛਪਾਈ...
 Name[pl]=Drukuj...
 Name[pt]=Imprimir...
Index: konqueror/quickprint/text-c++-print.desktop
===================================================================
--- konqueror/quickprint/text-c++-print.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/quickprint/text-c++-print.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -43,11 +43,11 @@
 Name[mk]=Печати...
 Name[ms]=Cetak...
 Name[mt]=Ipprintja...
-Name[nb]=Skriv ut...
+Name[nb]=Skriv ut …
 Name[nds]=Drucken...
 Name[ne]=मुद्रण...
 Name[nl]=Afdrukken...
-Name[nn]=Skriv ut ...
+Name[nn]=Skriv ut …
 Name[pa]=ਛਪਾਈ...
 Name[pl]=Drukuj...
 Name[pt]=Imprimir...
Index: konqueror/quickprint/text-makefile-print.desktop
===================================================================
--- konqueror/quickprint/text-makefile-print.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/quickprint/text-makefile-print.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -43,11 +43,11 @@
 Name[mk]=Печати...
 Name[ms]=Cetak...
 Name[mt]=Ipprintja...
-Name[nb]=Skriv ut...
+Name[nb]=Skriv ut …
 Name[nds]=Drucken...
 Name[ne]=मुद्रण...
 Name[nl]=Afdrukken...
-Name[nn]=Skriv ut ...
+Name[nn]=Skriv ut …
 Name[pa]=ਛਪਾਈ...
 Name[pl]=Drukuj...
 Name[pt]=Imprimir...
Index: konqueror/quickprint/text-c++h-print.desktop
===================================================================
--- konqueror/quickprint/text-c++h-print.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/quickprint/text-c++h-print.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -43,11 +43,11 @@
 Name[mk]=Печати...
 Name[ms]=Cetak...
 Name[mt]=Ipprintja...
-Name[nb]=Skriv ut...
+Name[nb]=Skriv ut …
 Name[nds]=Drucken...
 Name[ne]=मुद्रण...
 Name[nl]=Afdrukken...
-Name[nn]=Skriv ut ...
+Name[nn]=Skriv ut …
 Name[pa]=ਛਪਾਈ...
 Name[pl]=Drukuj...
 Name[pt]=Imprimir...
Index: konqueror/quickprint/text-log-print.desktop
===================================================================
--- konqueror/quickprint/text-log-print.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/quickprint/text-log-print.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -43,11 +43,11 @@
 Name[mk]=Печати...
 Name[ms]=Cetak...
 Name[mt]=Ipprintja...
-Name[nb]=Skriv ut...
+Name[nb]=Skriv ut …
 Name[nds]=Drucken...
 Name[ne]=मुद्रण...
 Name[nl]=Afdrukken...
-Name[nn]=Skriv ut ...
+Name[nn]=Skriv ut …
 Name[pa]=ਛਪਾਈ...
 Name[pl]=Drukuj...
 Name[pt]=Imprimir...
Index: konqueror/quickprint/text-java-print.desktop
===================================================================
--- konqueror/quickprint/text-java-print.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/quickprint/text-java-print.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -43,11 +43,11 @@
 Name[mk]=Печати...
 Name[ms]=Cetak...
 Name[mt]=Ipprintja...
-Name[nb]=Skriv ut...
+Name[nb]=Skriv ut …
 Name[nds]=Drucken...
 Name[ne]=मुद्रण...
 Name[nl]=Afdrukken...
-Name[nn]=Skriv ut ...
+Name[nn]=Skriv ut …
 Name[pa]=ਛਪਾਈ...
 Name[pl]=Drukuj...
 Name[pt]=Imprimir...
Index: konqueror/quickprint/text-python-print.desktop
===================================================================
--- konqueror/quickprint/text-python-print.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/quickprint/text-python-print.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -43,11 +43,11 @@
 Name[mk]=Печати...
 Name[ms]=Cetak...
 Name[mt]=Ipprintja...
-Name[nb]=Skriv ut...
+Name[nb]=Skriv ut …
 Name[nds]=Drucken...
 Name[ne]=मुद्रण...
 Name[nl]=Afdrukken...
-Name[nn]=Skriv ut ...
+Name[nn]=Skriv ut …
 Name[pa]=ਛਪਾਈ...
 Name[pl]=Drukuj...
 Name[pt]=Imprimir...
Index: konqueror/quickprint/text-c-print.desktop
===================================================================
--- konqueror/quickprint/text-c-print.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/quickprint/text-c-print.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -43,11 +43,11 @@
 Name[mk]=Печати...
 Name[ms]=Cetak...
 Name[mt]=Ipprintja...
-Name[nb]=Skriv ut...
+Name[nb]=Skriv ut …
 Name[nds]=Drucken...
 Name[ne]=मुद्रण...
 Name[nl]=Afdrukken...
-Name[nn]=Skriv ut ...
+Name[nn]=Skriv ut …
 Name[pa]=ਛਪਾਈ...
 Name[pl]=Drukuj...
 Name[pt]=Imprimir...
Index: konqueror/quickprint/text-tcl-print.desktop
===================================================================
--- konqueror/quickprint/text-tcl-print.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/quickprint/text-tcl-print.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -43,11 +43,11 @@
 Name[mk]=Печати...
 Name[ms]=Cetak...
 Name[mt]=Ipprintja...
-Name[nb]=Skriv ut...
+Name[nb]=Skriv ut …
 Name[nds]=Drucken...
 Name[ne]=मुद्रण...
 Name[nl]=Afdrukken...
-Name[nn]=Skriv ut ...
+Name[nn]=Skriv ut …
 Name[pa]=ਛਪਾਈ...
 Name[pl]=Drukuj...
 Name[pt]=Imprimir...
Index: konqueror/quickprint/text-pas-print.desktop
===================================================================
--- konqueror/quickprint/text-pas-print.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/quickprint/text-pas-print.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -43,11 +43,11 @@
 Name[mk]=Печати...
 Name[ms]=Cetak...
 Name[mt]=Ipprintja...
-Name[nb]=Skriv ut...
+Name[nb]=Skriv ut …
 Name[nds]=Drucken...
 Name[ne]=मुद्रण...
 Name[nl]=Afdrukken...
-Name[nn]=Skriv ut ...
+Name[nn]=Skriv ut …
 Name[pa]=ਛਪਾਈ...
 Name[pl]=Drukuj...
 Name[pt]=Imprimir...
Index: konqueror/quickprint/text-ada-print.desktop
===================================================================
--- konqueror/quickprint/text-ada-print.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/quickprint/text-ada-print.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -43,11 +43,11 @@
 Name[mk]=Печати...
 Name[ms]=Cetak...
 Name[mt]=Ipprintja...
-Name[nb]=Skriv ut...
+Name[nb]=Skriv ut …
 Name[nds]=Drucken...
 Name[ne]=मुद्रण...
 Name[nl]=Afdrukken...
-Name[nn]=Skriv ut ...
+Name[nn]=Skriv ut …
 Name[pa]=ਛਪਾਈ...
 Name[pl]=Drukuj...
 Name[pt]=Imprimir...
Index: konqueror/quickprint/text-css-print.desktop
===================================================================
--- konqueror/quickprint/text-css-print.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/quickprint/text-css-print.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -43,11 +43,11 @@
 Name[mk]=Печати...
 Name[ms]=Cetak...
 Name[mt]=Ipprintja...
-Name[nb]=Skriv ut...
+Name[nb]=Skriv ut …
 Name[nds]=Drucken...
 Name[ne]=मुद्रण...
 Name[nl]=Afdrukken...
-Name[nn]=Skriv ut ...
+Name[nn]=Skriv ut …
 Name[pa]=ਛਪਾਈ...
 Name[pl]=Drukuj...
 Name[pt]=Imprimir...
Index: konqueror/quickprint/text-ch-print.desktop
===================================================================
--- konqueror/quickprint/text-ch-print.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/quickprint/text-ch-print.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -43,11 +43,11 @@
 Name[mk]=Печати...
 Name[ms]=Cetak...
 Name[mt]=Ipprintja...
-Name[nb]=Skriv ut...
+Name[nb]=Skriv ut …
 Name[nds]=Drucken...
 Name[ne]=मुद्रण...
 Name[nl]=Afdrukken...
-Name[nn]=Skriv ut ...
+Name[nn]=Skriv ut …
 Name[pa]=ਛਪਾਈ...
 Name[pl]=Drukuj...
 Name[pt]=Imprimir...
Index: konqueror/quickprint/text-xslt-print.desktop
===================================================================
--- konqueror/quickprint/text-xslt-print.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/quickprint/text-xslt-print.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -43,11 +43,11 @@
 Name[mk]=Печати...
 Name[ms]=Cetak...
 Name[mt]=Ipprintja...
-Name[nb]=Skriv ut...
+Name[nb]=Skriv ut …
 Name[nds]=Drucken...
 Name[ne]=मुद्रण...
 Name[nl]=Afdrukken...
-Name[nn]=Skriv ut ...
+Name[nn]=Skriv ut …
 Name[pa]=ਛਪਾਈ...
 Name[pl]=Drukuj...
 Name[pt]=Imprimir...
Index: konqueror/sidebar/trees/init/remote/ftp/.directory
===================================================================
--- konqueror/sidebar/trees/init/remote/ftp/.directory	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/sidebar/trees/init/remote/ftp/.directory	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -17,7 +17,9 @@
 Name[fr]=Archives FTP
 Name[hi]=एफ़टीपी आर्काइव
 Name[hr]=FTP arhive
+Name[hu]=FTP
 Name[id]=Arsip FTP
+Name[is]=FTP gagnageymslur
 Name[it]=Archivi FTP
 Name[ja]=FTP アーカイブ
 Name[km]=ប័ណ្ណសារ FTP
@@ -35,6 +37,7 @@
 Name[pt]=Arquivos de FTP
 Name[pt_BR]=Arquivos de FTP
 Name[ro]=Arhive FTP
+Name[ru]=Серверы FTP
 Name[sk]=FTP archívy
 Name[sl]=Arhivi FTP
 Name[sr]=FTP архиве
Index: konqueror/sidebar/trees/init/remote/ftp/kde_ftp.desktop
===================================================================
--- konqueror/sidebar/trees/init/remote/ftp/kde_ftp.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/sidebar/trees/init/remote/ftp/kde_ftp.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -8,7 +8,7 @@
 Name[ar]=ميفاق نقل الملفات الرسمي لِــ KDE
 Name[az]=KDE FTP vericisi
 Name[be]=Афіцыйны FTP KDE
-Name[bg]=Официален сървър FTP на KDE
+Name[bg]=Официален FTP сървър на KDE
 Name[bn]=মূল কে.ডি.ই. এফ.টি.পি.
 Name[br]=FTP ofisiel KDE
 Name[bs]=KDE službeni FTP
Index: konqueror/sidebar/trees/init/remote/web/.directory
===================================================================
--- konqueror/sidebar/trees/init/remote/web/.directory	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/sidebar/trees/init/remote/web/.directory	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -17,7 +17,9 @@
 Name[fr]=Sites Web
 Name[hi]=वेब साइट्स
 Name[hr]=Web-lokacije
+Name[hu]=Weboldalak
 Name[id]=Situs Web
+Name[is]=Vefsvæði
 Name[it]=Siti web
 Name[ja]=ウェブサイト
 Name[km]=តំបន់​បណ្ដាញ
@@ -34,6 +36,7 @@
 Name[pt]=Páginas Web
 Name[pt_BR]=Páginas Web
 Name[ro]=Sit-uri de Web
+Name[ru]=Веб-сайты
 Name[sk]=Webové stránky
 Name[sl]=Spletne strani
 Name[sr]=Веб сајтови
Index: konqueror/sidebar/trees/init/remote/web/kde_web.desktop
===================================================================
--- konqueror/sidebar/trees/init/remote/web/kde_web.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/sidebar/trees/init/remote/web/kde_web.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -58,7 +58,7 @@
 Name[pt]=Página do KDE
 Name[pt_BR]=Página principal do KDE
 Name[ro]=Site-ul KDE
-Name[ru]=Веб-сайт KDE
+Name[ru]=Основной сайт KDE
 Name[rw]=KDE Ipajikwinjira 
 Name[se]=KDE-ruoktosiidu
 Name[sk]=Domovská stránka KDE
Index: konqueror/sidebar/trees/init/system.desktop
===================================================================
--- konqueror/sidebar/trees/init/system.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konqueror/sidebar/trees/init/system.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -103,7 +103,7 @@
 Comment[he]=תיקייה זו מאפשרת לך לגשת את המקומות המועדפים עליך במערכת שלך
 Comment[hr]=Ova mapa omogućuje pristup uobičajenim lokacijama na računalu
 Comment[hu]=Néhány fontosabb rendszerkönyvtár elérését teszi lehetővé
-Comment[is]=Þessi mappa veitir aðgang að almennum stöðum á tölvunni þinni
+Comment[is]=Þessi mappa veitir aðgang að algengum stöðum á tölvunni þinni
 Comment[it]=Questa cartella permette di accedere agli oggetti comuni del tuo computer
 Comment[ja]=このフォルダからコンピュータ上のよく使われる場所にアクセスできます
 Comment[kk]=Бұл қапшық компьютердегі ортақ орындарға қатынауға мүмкіндік береді
Index: knetattach/knetattach.ui
===================================================================
--- knetattach/knetattach.ui	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ knetattach/knetattach.ui	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -415,6 +415,8 @@
     <include location="global" impldecl="in implementation">kapplication.h</include>
     <include location="global" impldecl="in implementation">kstandarddirs.h</include>
     <include location="global" impldecl="in implementation">kdirnotify_stub.h</include>
+    <include location="global" impldecl="in implementation">kcombobox.h</include>
+    <include location="global" impldecl="in implementation">klineedit.h</include>
     <include location="global" impldecl="in declaration">kurl.h</include>
     <include location="local" impldecl="in implementation">knetattach.ui.h</include>
 </includes>
Index: kscreensaver/KRandom.desktop
===================================================================
--- kscreensaver/KRandom.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kscreensaver/KRandom.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -129,11 +129,11 @@
 Name[mk]=Постави...
 Name[mn]=Тохируулга...
 Name[ms]=Tetapan...
-Name[nb]=Oppsett ...
+Name[nb]=Oppsett …
 Name[nds]=Instellen...
 Name[ne]=सेटअप...
 Name[nl]=Instellingen...
-Name[nn]=Oppsett ...
+Name[nn]=Oppsett …
 Name[nso]=Beakanya...
 Name[oc]=Configuracion...
 Name[pa]=ਸੈੱਟਅੱਪ...
Index: kscreensaver/KBlankscreen.desktop
===================================================================
--- kscreensaver/KBlankscreen.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kscreensaver/KBlankscreen.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -131,11 +131,11 @@
 Name[mk]=Постави...
 Name[mn]=Тохируулга...
 Name[ms]=Tetapan...
-Name[nb]=Oppsett ...
+Name[nb]=Oppsett …
 Name[nds]=Instellen...
 Name[ne]=सेटअप...
 Name[nl]=Instellingen...
-Name[nn]=Oppsett ...
+Name[nn]=Oppsett …
 Name[nso]=Beakanya...
 Name[oc]=Configuracion...
 Name[pa]=ਸੈੱਟਅੱਪ...
Index: kxkb/kcmmiscwidget.ui
===================================================================
--- kxkb/kcmmiscwidget.ui	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kxkb/kcmmiscwidget.ui	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -337,6 +337,7 @@
 </tabstops>
 <includes>
     <include location="global" impldecl="in implementation">kdialog.h</include>
+    <include location="global" impldecl="in implementation">knuminput.h</include>
 </includes>
 <layoutdefaults spacing="6" margin="11"/>
 <layoutfunctions spacing="KDialog::spacingHint" margin="KDialog::marginHint"/>
Index: libkonq/konqpopupmenuplugin.desktop
===================================================================
--- libkonq/konqpopupmenuplugin.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ libkonq/konqpopupmenuplugin.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -42,11 +42,11 @@
 Comment[mn]=Конкюрорын тагтан-цэсний Плугин
 Comment[ms]=Plugin untuk Menu Popuo Konqueror
 Comment[mt]=Plagin għall-menu kuntestwali ta' Konqueror
-Comment[nb]=Programtillegg for oppsprettsmenyen i Konqueror
+Comment[nb]=Programtillegg for sprettoppmenyen i Konqueror
 Comment[nds]=Plugin för dat Konqueror-Opdukmenü
 Comment[ne]=कन्क्वेरर पपअप मेनुका लागि प्लगइन
 Comment[nl]=Plugin voor Konqueror's contextmenu
-Comment[nn]=Tillegg til oppsprettmenyen i Konqueror
+Comment[nn]=Tillegg til sprettoppmenyen i Konqueror
 Comment[nso]=Plugin ya Menu wa Thlarogo ya Konqueror
 Comment[pa]=ਕੋਨਕਿਉਰੋਰ ਪਾਪਅੱਪ ਮੇਨੂ ਲਈ ਪਲੱਗਇਨ
 Comment[pl]=Wtyczka do menu (otwieranego przyciskiem myszy) Konquerora
Index: khotkeys/shared/actions.cpp
===================================================================
--- khotkeys/shared/actions.cpp	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ khotkeys/shared/actions.cpp	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -118,6 +118,12 @@
         return;
     KURIFilterData uri;
     QString cmd = command_url();
+    static bool sm_ready = false;
+    if( !sm_ready )
+        {
+        kapp->propagateSessionManager();
+        sm_ready = true;
+        }
 //    int space_pos = command_url().find( ' ' );
 //    if( command_url()[ 0 ] != '\'' && command_url()[ 0 ] != '"' && space_pos > -1
 //        && command_url()[ space_pos - 1 ] != '\\' )
Index: khotkeys/data/konqueror_gestures_kde321.khotkeys
===================================================================
--- khotkeys/data/konqueror_gestures_kde321.khotkeys	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ khotkeys/data/konqueror_gestures_kde321.khotkeys	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -98,6 +98,7 @@
 Comment[fy]=Konqueror finster
 Comment[hr]=Konqueror prozor
 Comment[hu]=Konqueror-ablak
+Comment[is]=Konqueror gluggi
 Comment[it]=Finestra di Konqueror
 Comment[ja]=Konqueror ウィンドウ
 Comment[km]=បង្អួច​របស់ Konqueror
@@ -162,6 +163,7 @@
 Comment[fy]=Yndrukke, nei lofts, loslitte
 Comment[hr]=Pritisni, pomakni ulijevo, otpusti.
 Comment[hu]=Lenyomás, balra, elengedés.
+Comment[is]=Smella niður, hreyfa til vinstri, sleppa.
 Comment[it]=Premi, sposta a sinistra, rilascia.
 Comment[ja]=マウスの中ボタンを押したまま、マウスを左に動かし、ボタンを放します。
 Comment[km]=ចុច ផ្លាស់ទី​ទៅ​ឆ្វេង លែង ។
@@ -199,6 +201,7 @@
 Name[fy]=Werom
 Name[hr]=Natrag
 Name[hu]=Vissza
+Name[is]=Til baka
 Name[it]=Indietro
 Name[ja]=戻る
 Name[km]=ថយក្រោយ
@@ -272,6 +275,7 @@
 Name[fy]=it laden stopje
 Name[hr]=Zaustavi učitavanje
 Name[hu]=A betöltés leállítása
+Name[is]=Stöðva hleðslu
 Name[it]=Interrompi caricamento
 Name[ja]=読み込みを停止
 Name[km]=បញ្ឈប់​កា​រផ្ទុក
@@ -322,6 +326,7 @@
 Comment[fy]=Stjoerring_starters
 Comment[hr]=Okidači gestikulacija
 Comment[hu]=Mozdulatsor-kiváltók
+Comment[is]=Gesture_strengir
 Comment[it]=Interruttori_gesti
 Comment[km]=ការ​កេះ​កាយវិការ
 Comment[nb]=Bevegelsestarer
@@ -394,6 +399,7 @@
 Name[fy]=Omheech
 Name[hr]=Gore
 Name[hu]=Fel
+Name[is]=Upp
 Name[it]=Su
 Name[ja]=上
 Name[km]=ឡើងលើ
@@ -445,6 +451,7 @@
 Comment[fy]=Stjoerring_starters
 Comment[hr]=Okidači gestikulacija
 Comment[hu]=Mozdulatsor-kiváltók
+Comment[is]=Gesture_strengir
 Comment[it]=Interruttori_gesti
 Comment[km]=ការ​កេះ​កាយវិការ
 Comment[nb]=Bevegelsestarer
@@ -514,6 +521,7 @@
 Name[fy]=Omheech #2
 Name[hr]=Gore br.2
 Name[hu]=Fel (2)
+Name[is]=Upp #2
 Name[it]=Su #2
 Name[ja]=上 #2
 Name[km]=ឡើង​លើ #2
@@ -564,6 +572,7 @@
 Comment[fy]=Stjoerring_starters
 Comment[hr]=Okidači gestikulacija
 Comment[hu]=Mozdulatsor-kiváltók
+Comment[is]=Gesture_strengir
 Comment[it]=Interruttori_gesti
 Comment[km]=ការ​កេះ​កាយវិការ
 Comment[nb]=Bevegelsestarer
@@ -637,10 +646,11 @@
 Name[fy]=Folgjende ljepper aktivearje
 Name[hr]=Aktiviraj sljedeću karticu
 Name[hu]=Következő lap
+Name[is]=Virkja næsta glugga
 Name[it]=Attiva scheda successiva
 Name[ja]=次のタブをアクティブに
 Name[km]=ធ្វើ​ឲ្យ​ថេប​បន្ទាប់​សកម្ម
-Name[nb]=Aktiver neste fane
+Name[nb]=Skru på neste fane
 Name[nds]=Nakamen Paneel aktiv maken
 Name[nl]=Volgend tabblad activeren
 Name[pa]=ਅਗਲੀ ਟੈਬ ਸਰਗਰਮ ਕਰੋ
@@ -685,6 +695,7 @@
 Comment[fy]=Stjoerring_starters
 Comment[hr]=Okidači gestikulacija
 Comment[hu]=Mozdulatsor-kiváltók
+Comment[is]=Gesture_strengir
 Comment[it]=Interruttori_gesti
 Comment[km]=ការ​កេះ​កាយវិការ
 Comment[nb]=Bevegelsestarer
@@ -758,6 +769,7 @@
 Name[fy]=Foarige ljepper aktivearje
 Name[hr]=Aktiviraj prethodnu karticu
 Name[hu]=Előző lap
+Name[is]=Virkja síðasta glugga
 Name[it]=Attiva scheda precedente
 Name[ja]=前のタブをアクティブに
 Name[km]=ធ្វើ​ឲ្យថេប​មុន​សកម្ម
@@ -806,6 +818,7 @@
 Comment[fy]=Stjoerring_starters
 Comment[hr]=Okidači gestikulacija
 Comment[hu]=Mozdulatsor-kiváltók
+Comment[is]=Gesture_strengir
 Comment[it]=Interruttori_gesti
 Comment[km]=ការ​កេះ​កាយវិការ
 Comment[nb]=Bevegelsestarer
@@ -854,6 +867,7 @@
 Comment[fy]=Stjoerring_starters
 Comment[hr]=Okidači gestikulacija
 Comment[hu]=Mozdulatsor-kiváltók
+Comment[is]=Gesture_strengir
 Comment[it]=Interruttori_gesti
 Comment[km]=ការ​កេះ​កាយវិការ
 Comment[nb]=Bevegelsestarer
@@ -926,6 +940,7 @@
 Name[fy]=Ljepper duplisearje
 Name[hr]=Kopiraj karticu
 Name[hu]=Lap duplikálása
+Name[is]=Afritaður flipi
 Name[it]=Duplica scheda
 Name[ja]=タブを複製
 Name[km]=ស្ទួន​ថេប
@@ -974,6 +989,7 @@
 Comment[fy]=Stjoerring_starters
 Comment[hr]=Okidači gestikulacija
 Comment[hu]=Mozdulatsor-kiváltók
+Comment[is]=Gesture_strengir
 Comment[it]=Interruttori_gesti
 Comment[km]=ការ​កេះ​កាយវិការ
 Comment[nb]=Bevegelsestarer
@@ -1045,6 +1061,7 @@
 Name[fy]=Finster duplisearje
 Name[hr]=Kopiraj prozor
 Name[hu]=Ablak duplikálása
+Name[is]=Afrit af glugga
 Name[it]=Duplica finestra
 Name[ja]=ウィンドウを複製
 Name[km]=ស្ទួន​បង្អួច
@@ -1093,6 +1110,7 @@
 Comment[fy]=Stjoerring_starters
 Comment[hr]=Okidači gestikulacija
 Comment[hu]=Mozdulatsor-kiváltók
+Comment[is]=Gesture_strengir
 Comment[it]=Interruttori_gesti
 Comment[km]=ការ​កេះ​កាយវិការ
 Comment[nb]=Bevegelsestarer
@@ -1130,6 +1148,7 @@
 Comment[fy]=Yndrukke, nei rjochts, loslitte.
 Comment[hr]=Pritisni, pomakni udesno, otpusti.
 Comment[hu]=Lenyomás, jobbra, elengedés.
+Comment[is]=Smella niður, hreyfa til hægri, sleppa.
 Comment[it]=Premi, sposta a desta, rilascia.
 Comment[ja]=マウスの中ボタンを押したまま、マウスを右に動かし、ボタンを放します。
 Comment[km]=ចុច ផ្លាស់ទី​ទៅស្ដាំ លែង ។
@@ -1168,6 +1187,7 @@
 Name[fy]=Foarút
 Name[hr]=Naprijed
 Name[hu]=Előre
+Name[is]=Áfram
 Name[it]=Avanti
 Name[ja]=進む
 Name[km]=បញ្ជូន​បន្ត
@@ -1219,6 +1239,7 @@
 Comment[fy]=Stjoerring_starters
 Comment[hr]=Okidači gestikulacija
 Comment[hu]=Mozdulatsor-kiváltók
+Comment[is]=Gesture_strengir
 Comment[it]=Interruttori_gesti
 Comment[km]=ការ​កេះ​កាយវិការ
 Comment[nb]=Bevegelsestarer
@@ -1379,6 +1400,7 @@
 Comment[fy]=Stjoerring_starters
 Comment[hr]=Okidači gestikulacija
 Comment[hu]=Mozdulatsor-kiváltók
+Comment[is]=Gesture_strengir
 Comment[it]=Interruttori_gesti
 Comment[km]=ការ​កេះ​កាយវិការ
 Comment[nb]=Bevegelsestarer
@@ -1453,6 +1475,7 @@
 Name[fy]=Ljepper slute
 Name[hr]=Zatvori karticu
 Name[hu]=Lap bezárása
+Name[is]=Loka flipa
 Name[it]=Chiudi scheda
 Name[ja]=タブを閉じる
 Name[km]=បិទ​ថេប
@@ -1502,6 +1525,7 @@
 Comment[fy]=Stjoerring_starters
 Comment[hr]=Okidači gestikulacija
 Comment[hu]=Mozdulatsor-kiváltók
+Comment[is]=Gesture_strengir
 Comment[it]=Interruttori_gesti
 Comment[km]=ការ​កេះ​កាយវិការ
 Comment[nb]=Bevegelsestarer
@@ -1575,6 +1599,7 @@
 Name[fy]=Nije ljepper
 Name[hr]=Nova kartica
 Name[hu]=Új lap
+Name[is]=Opna nýjan flipa
 Name[it]=Nuova scheda
 Name[ja]=新規タブ
 Name[km]=ថេប​ថ្មី
@@ -1624,6 +1649,7 @@
 Comment[fy]=Stjoerring_starters
 Comment[hr]=Okidači gestikulacija
 Comment[hu]=Mozdulatsor-kiváltók
+Comment[is]=Gesture_strengir
 Comment[it]=Interruttori_gesti
 Comment[km]=ការ​កេះ​កាយវិការ
 Comment[nb]=Bevegelsestarer
@@ -1787,6 +1813,7 @@
 Comment[fy]=Stjoerring_starters
 Comment[hr]=Okidači gestikulacija
 Comment[hu]=Mozdulatsor-kiváltók
+Comment[is]=Gesture_strengir
 Comment[it]=Interruttori_gesti
 Comment[km]=ការ​កេះ​កាយវិការ
 Comment[nb]=Bevegelsestarer
@@ -1859,6 +1886,7 @@
 Name[fy]=Ferfarskje
 Name[hr]=Osvježi
 Name[hu]=Újratöltés
+Name[is]=Endurhlaða
 Name[it]=Ricarica
 Name[ja]=再読み込み
 Name[km]=ផ្ទុកឡើង​វិញ
@@ -1910,6 +1938,7 @@
 Comment[fy]=Stjoerring_starters
 Comment[hr]=Okidači gestikulacija
 Comment[hu]=Mozdulatsor-kiváltók
+Comment[is]=Gesture_strengir
 Comment[it]=Interruttori_gesti
 Comment[km]=ការ​កេះ​កាយវិការ
 Comment[nb]=Bevegelsestarer
Index: khotkeys/data/printscreen.khotkeys
===================================================================
--- khotkeys/data/printscreen.khotkeys	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ khotkeys/data/printscreen.khotkeys	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -49,6 +49,7 @@
 Name[fy]=Foarynstelde aksjes
 Name[hr]=Unaprijed zadane aktivnosti
 Name[hu]=Beállított műveletek
+Name[is]=Forsniðnar aðgerðir
 Name[it]=Azioni predefinite
 Name[ja]=プリセットアクション
 Name[km]=កំណង់​សកម្មភាព​ជា​មុន
@@ -118,6 +119,7 @@
 Name[es]=Imprimir la pantalla
 Name[fr]=Impression écran
 Name[fy]=print foarbyld
+Name[is]=PrentaSkjá
 Name[it]=Stamp
 Name[km]=បោះពុម្ព​អេក្រង់
 Name[nb]=Skriv skjermdump
Index: khotkeys/kcontrol/khotkeys.desktop
===================================================================
--- khotkeys/kcontrol/khotkeys.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ khotkeys/kcontrol/khotkeys.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -34,7 +34,7 @@
 Name[he]=פעולות קלט
 Name[hr]=Aktivnosti unosa
 Name[hu]=Beviteli műveletek
-Name[is]=Inntaks aðgerðir
+Name[is]=Inntaksaðgerðir
 Name[it]=Azioni di immissione
 Name[ja]=入力アクション
 Name[kk]=Енгізу әрекеттері
Index: drkonqi/presets/developerrc
===================================================================
--- drkonqi/presets/developerrc	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ drkonqi/presets/developerrc	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -703,6 +703,7 @@
 Name[kk]=Беймәлім
 Name[km]=មិន​ស្គាល់
 Name[ko]=모름
+Name[ku]=Nenas
 Name[lo]=ບໍ່ຮູ້ຈັກ
 Name[lt]=Nežinoma
 Name[lv]=Nezināms
Index: drkonqi/presets/enduserrc
===================================================================
--- drkonqi/presets/enduserrc	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ drkonqi/presets/enduserrc	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -690,6 +690,7 @@
 Name[kk]=Беймәлім
 Name[km]=មិន​ស្គាល់
 Name[ko]=모름
+Name[ku]=Nenas
 Name[lo]=ບໍ່ຮູ້ຈັກ
 Name[lt]=Nežinoma
 Name[lv]=Nezināms
Index: kwin/kcmkwin/kwinrules/kwinrules.desktop
===================================================================
--- kwin/kcmkwin/kwinrules/kwinrules.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kwin/kcmkwin/kwinrules/kwinrules.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -77,7 +77,7 @@
 Comment[af]=Stel spesifieke venster instellings op
 Comment[ar]=إعداد التعيينات الخاصة بنافذة
 Comment[be]=Настаўленні для кожнага вакна асабіста
-Comment[bg]=Настройване на специфични особености за отделни прозорци
+Comment[bg]=Настройване на специфични особености за отделните прозорци
 Comment[bn]=শুধুমাত্র এই বিশেষ উইণ্ডো-টির সেটিংস কনফিগার করুন
 Comment[bs]=Podesite postavke specifične za ovaj prozor
 Comment[ca]=Configura l'arranjament específicament per a una finestra
Index: kwin/geometry.cpp
===================================================================
--- kwin/geometry.cpp	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kwin/geometry.cpp	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -1437,6 +1437,7 @@
         if ( value_mask & CWHeight )
             nh = rh;
         QSize ns = sizeForClientSize( QSize( nw, nh ) );
+        new_pos = rules()->checkPosition( new_pos );
 
         // TODO what to do with maximized windows?
         if ( maximizeMode() != MaximizeFull
Index: kwin/group.cpp
===================================================================
--- kwin/group.cpp	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kwin/group.cpp	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -816,7 +816,7 @@
         if( pos == NULL )
             break;
         loop_pos = pos->transient_for_id;
-        if( --count == 0 )
+        if( --count == 0 || pos == this )
             {
             kdWarning( 1216 ) << "Client " << this << " caused WM_TRANSIENT_FOR loop." << endl;
             new_transient_for = workspace()->rootWin();
Index: kwin/data/fsp_workarounds_1.kwinrules
===================================================================
--- kwin/data/fsp_workarounds_1.kwinrules	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kwin/data/fsp_workarounds_1.kwinrules	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -11,6 +11,7 @@
 Description[fr]=(Défaut) Désactive le vol du focus pour XV
 Description[fy]=(standert) Foarkomme fan ôfpakke fan toetseboerdfokus foar XV
 Description[hr]=(Zadano) Onemogući sprečavanje preuzimanja fokusa za XV
+Description[hu]=(Alapértelmezés) A fókuszelvételi védelem kikapcsolása az XV-nél
 Description[it]=(Predefinita) Disabilita la prevenzione della cattura del fuoco per XV
 Description[ja]=(デフォルト) XV のフォーカス移動防止を無効にする
 Description[km]=(លំនាំដើម) បិទ​ការ​ផ្ដោតអារម្មណ៍ ដោយ​លួច​ការពារ​សម្រាប់ XV
@@ -20,6 +21,7 @@
 Description[pl]=(Domyślne) wyłączenie przechwytywania aktywności dla XV
 Description[pt]=(Predefinido) Desactivar a prevenção de roubo do primeiro plano do XV
 Description[pt_BR]=(Padrão) Desativa prevenção de roubo de foco para o XV
+Description[ru]=(по умолчанию) отключить предотвращение потери для XV
 Description[sk]=(Štandard) Znemožniť kradnutie fokusu pre XV
 Description[sl]=(privzeto) Onemogoči preprečevanje kraje fokusa za XV
 Description[sr]=(Подразумевано) Искључи спречавање преузимања фокуса за XV
Index: konsole/konsole.desktop
===================================================================
--- konsole/konsole.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konsole/konsole.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -34,7 +34,6 @@
 Name[pa]=ਕੰਨਸੋਲ
 Name[pl]=Konsola
 Name[ro]=Consolă
-Name[ru]=Консоль
 Name[se]=Konsolla
 Name[sk]=Konzola
 Name[sl]=Konzola
Index: konsole/konsole-script.desktop
===================================================================
--- konsole/konsole-script.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konsole/konsole-script.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -34,7 +34,6 @@
 Name[pa]=ਕੰਨਸੋਲ
 Name[pl]=Konsola
 Name[ro]=Consolă
-Name[ru]=Консоль
 Name[se]=Konsolla
 Name[sk]=Konzola
 Name[sl]=Konzola
Index: konsole/konsolehere.desktop
===================================================================
--- konsole/konsolehere.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konsole/konsolehere.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -32,7 +32,6 @@
 Name[pa]=ਕੰਨਸੋਲ
 Name[pl]=Konsola
 Name[ro]=Consolă
-Name[ru]=Консоль
 Name[se]=Konsolla
 Name[sk]=Konzola
 Name[sl]=Konzola
Index: konsole/eventsrc
===================================================================
--- konsole/eventsrc	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konsole/eventsrc	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -23,7 +23,6 @@
 Comment[nn]=Konsoll
 Comment[pa]=ਕੰਨਸੋਲ
 Comment[ro]=Consolă
-Comment[ru]=Консоль
 Comment[sl]=Konzola
 Comment[ta]=கான்சோல்
 Comment[te]=కాన్సొల్
Index: konsole/kcmkonsole.desktop
===================================================================
--- konsole/kcmkonsole.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ konsole/kcmkonsole.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -124,7 +124,7 @@
 GenericName[mn]=Консолын бүх тохируулга
 GenericName[ms]=Semua Seting Konsol
 GenericName[mt]=Setings kollha tal-Konsole
-GenericName[nb]=Alle Konsoll-instillinger
+GenericName[nb]=Alle Konsoll-innstillinger
 GenericName[nds]=All Konsole-Instellen
 GenericName[ne]=सबै कन्सोल सेटिङ
 GenericName[nl]=Alle Konsole-instellingen
@@ -136,7 +136,7 @@
 GenericName[pt]=Configuração da Consola
 GenericName[pt_BR]=Todas as configurações do Konsole
 GenericName[ro]=Toate setările Konsole
-GenericName[ru]=Настройки консоли
+GenericName[ru]=Настройка терминала
 GenericName[rw]=Amagenamiterere ya Konsole Zose
 GenericName[se]=Buot konsolla-heivehusat
 GenericName[sk]=Všetky nastavenia Konzoly
@@ -206,6 +206,7 @@
 Keywords[pl]=konsole,konsola,terminal
 Keywords[pt]=konsole,consola,terminal
 Keywords[ro]=konsole,consolă,terminal
+Keywords[ru]=konsole,console,terminal,терминал
 Keywords[rw]=konsole,konsole,igihera
 Keywords[se]=konsolla,console,konsole,terminála,gohččunlinnjá
 Keywords[sk]=konsole,konzola,terminál
Index: l10n/rs/entry.desktop
===================================================================
--- l10n/rs/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/rs/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -13,6 +13,7 @@
 Name[fr]=Serbie
 Name[hr]=Srbija
 Name[hu]=Szerbia
+Name[is]=Serbía
 Name[ja]=セルビア
 Name[kk]=Сербия
 Name[km]=សែប៊ី
Index: l10n/rw/entry.desktop
===================================================================
--- l10n/rw/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/rw/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -11,6 +11,7 @@
 Name[de]=Ruanda
 Name[el]=Ρουάντα
 Name[eo]=Ruando
+Name[es]=Ruanda
 Name[eu]=Ruanda
 Name[fa]=روآندا
 Name[fi]=Ruanda
Index: l10n/kg/entry.desktop
===================================================================
--- l10n/kg/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/kg/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -14,7 +14,7 @@
 Name[de]=Kirgisien
 Name[el]=Κιργιζιστάν
 Name[eo]=Kirgizujo
-Name[es]=Kyrgyzstán
+Name[es]=Kirguistán
 Name[et]=Kõrgõzstan
 Name[fa]=قرقیزستان
 Name[fr]=Kirghizstan
Index: l10n/kh/entry.desktop
===================================================================
--- l10n/kh/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/kh/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -13,6 +13,7 @@
 Name[de]=Kambodscha
 Name[el]=Καμπότζη
 Name[eo]=Kamboĝo
+Name[es]=Camboya
 Name[et]=Kambodža
 Name[eu]=Canbodia
 Name[fa]=کامبوج
Index: l10n/km/entry.desktop
===================================================================
--- l10n/km/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/km/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -13,6 +13,7 @@
 Name[de]=Komoren
 Name[el]=Κομόρες
 Name[eo]=Komoroj
+Name[es]=Comoras
 Name[et]=Komoorid
 Name[fa]=کومور
 Name[fi]=Komorit
Index: l10n/kn/entry.desktop
===================================================================
--- l10n/kn/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/kn/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -15,7 +15,7 @@
 Name[de]=St. Kitts und Nevis
 Name[el]=Άγιος Χριστόφορος (Σαιντ Κιτς) και Νέβις
 Name[eo]=Sent-Kristofo kaj Neviso
-Name[es]=St. Kitts y Nevis
+Name[es]=San Cristobal y Nieves
 Name[et]=St. Kitts ja Nevis
 Name[eu]=St. Kitts eta Nevis
 Name[fa]=سنت کیتس و نویس
Index: l10n/kz/entry.desktop
===================================================================
--- l10n/kz/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/kz/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -12,7 +12,7 @@
 Name[de]=Kasachstan
 Name[el]=Καζακστάν
 Name[eo]=Kazaĥujo
-Name[es]=Kazakhstán
+Name[es]=Kazajistán
 Name[et]=Kasahstan
 Name[fa]=قزاقستان
 Name[fi]=Kazakstan
Index: l10n/sr/entry.desktop
===================================================================
--- l10n/sr/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/sr/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -13,6 +13,7 @@
 Name[de]=Surinam
 Name[el]=Σουρινάμ
 Name[eo]=Surinamo
+Name[es]=Surinam
 Name[et]=Surinam
 Name[eu]=Surinam
 Name[fa]=سورینام
Index: l10n/st/entry.desktop
===================================================================
--- l10n/st/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/st/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -16,7 +16,7 @@
 Name[de]=Sao Tome und Principe
 Name[el]=Σάο Τομέ και Πρίνσιπε
 Name[eo]=Sao-Tomeo kaj Principeo
-Name[es]=Sao Tome y Príncipe
+Name[es]=Santo Tomé y Príncipe
 Name[et]=Sao Tome ja Principe
 Name[eu]=Sao Tome eta Principe
 Name[fa]=سائوتومه و پرنسیپ
Index: l10n/sz/entry.desktop
===================================================================
--- l10n/sz/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/sz/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -13,7 +13,7 @@
 Name[de]=Swasiland
 Name[el]=Σουαζιλάνδη
 Name[eo]=Svazilando
-Name[es]=Swazilandia
+Name[es]=Suazilandia
 Name[et]=Svaasimaa
 Name[eu]=Swazilandia
 Name[fa]=سوآزیلند
Index: l10n/tc/entry.desktop
===================================================================
--- l10n/tc/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/tc/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -16,7 +16,7 @@
 Name[de]=Turks- und Caicos-Inseln
 Name[el]=Νήσοι Τερκς και Κάικος
 Name[eo]=Turkoj kaj Kajkoj
-Name[es]=Islas Turcos y Caicos
+Name[es]=Islas Turcas y Caicos
 Name[et]=Turks ja Caicos
 Name[eu]=Turks eta Caicos Irlak
 Name[fa]=جزایر ترکها و کایکوها
Index: l10n/tj/entry.desktop
===================================================================
--- l10n/tj/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/tj/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -14,7 +14,7 @@
 Name[de]=Tadschikistan
 Name[el]=Τατζικιστάν
 Name[eo]=Taĝikujo
-Name[es]=Tajikistán
+Name[es]=Tayikistán
 Name[et]=Tadžikistan
 Name[fa]=تاجیکستان
 Name[fr]=Tadjikistan
Index: l10n/lu/entry.desktop
===================================================================
--- l10n/lu/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/lu/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -40,6 +40,7 @@
 Name[mk]=Луксембург
 Name[mn]=Люксембүрг
 Name[mt]=Lussemburgu
+Name[nb]=Luxemburg
 Name[nds]=Luxemborg
 Name[ne]=लक्जेम्बर्ग
 Name[nl]=Luxemburg
Index: l10n/tp/entry.desktop
===================================================================
--- l10n/tp/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/tp/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -16,7 +16,7 @@
 Name[de]=Ost-Timor
 Name[el]=Ανατολικό Τιμόρ
 Name[eo]=Orienta Timoro
-Name[es]=Timor oriental
+Name[es]=Timor Oriental
 Name[et]=Ida-Timor
 Name[eu]=Ekialdeko Timor
 Name[fa]=تیمور شرقی
Index: l10n/tr/entry.desktop
===================================================================
--- l10n/tr/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/tr/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -37,6 +37,7 @@
 Name[kk]=Түркия
 Name[km]=ទួរគី
 Name[ko]=터키
+Name[ku]=Tirkiye
 Name[lo]=ຕຸລະກີ
 Name[lt]=Turkija
 Name[lv]=Turcija
Index: l10n/tz/entry.desktop
===================================================================
--- l10n/tz/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/tz/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -16,7 +16,7 @@
 Name[de]=Tansania, vereinigte Republik
 Name[el]=Τανζανία, Ενωμένη δημοκρατία της
 Name[eo]=Tanzanio, Unuiĝinta Respubliko de
-Name[es]=Tanzania, Republica de
+Name[es]=Tanzania, República de
 Name[et]=Tansaania
 Name[eu]=Tanaziar Errepublika Batua
 Name[fa]=جمهوری متحدۀ تانزانیا
Index: l10n/me/entry.desktop
===================================================================
--- l10n/me/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/me/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -9,6 +9,7 @@
 Name[fr]=Montenégro
 Name[hr]=Crna Gora
 Name[hu]=Montenegró
+Name[is]=Svartfjallaland
 Name[ja]=モンテネグロ
 Name[kk]=Черногория
 Name[km]=ម៉ុង​តេ​ណេ​រ៉ូ
Index: l10n/northafrica.desktop
===================================================================
--- l10n/northafrica.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/northafrica.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -15,7 +15,7 @@
 Name[de]=Afrika, Nördliches
 Name[el]=Αφρική, Βόρεια
 Name[eo]=Afriko norda
-Name[es]=Africa, del Norte
+Name[es]=África del Norte
 Name[et]=Põhja-Aafrika
 Name[eu]=Ipar Afrika
 Name[fa]=آفریقای شمالی
Index: l10n/mo/entry.desktop
===================================================================
--- l10n/mo/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/mo/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -14,6 +14,7 @@
 Name[de]=Macao SAR (China)
 Name[el]=Μακάο SAR (Κίνα)
 Name[eo]=Makao SAR(Ĉino)
+Name[es]=Macao
 Name[et]=Macau
 Name[eu]=Macau SAR(Txina)
 Name[fa]=منطقۀ صنعتی ویژۀ ماکائو )چین(
Index: l10n/va/entry.desktop
===================================================================
--- l10n/va/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/va/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -16,7 +16,7 @@
 Name[de]=Vatikanstadt
 Name[el]=Βατικανό
 Name[eo]=Vatikano
-Name[es]=Vaticano
+Name[es]=Ciudad del Vaticano
 Name[et]=Vatikan
 Name[eu]=Batikano Hiria
 Name[fa]=واتیکان سیتی
Index: l10n/nr/entry.desktop
===================================================================
--- l10n/nr/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/nr/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -8,7 +8,6 @@
 Name[cy]=Nawrw
 Name[el]=Ναουρού
 Name[eo]=Naŭro
-Name[es]=Naurú
 Name[fa]=نائورو
 Name[fi]=Naurusaaret
 Name[ga]=Nárúis
Index: l10n/westafrica.desktop
===================================================================
--- l10n/westafrica.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/westafrica.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -16,7 +16,7 @@
 Name[de]=Afrika, Westliches
 Name[el]=Αφρική, Δυτική
 Name[eo]=Afriko okcidenta
-Name[es]=Africa, Oeste
+Name[es]=Africa Occidental
 Name[et]=Lääne-Aafrika
 Name[eu]=Mendebaldeko Afrika
 Name[fa]=افریقای غربی
Index: l10n/gq/entry.desktop
===================================================================
--- l10n/gq/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/gq/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -15,7 +15,7 @@
 Name[de]=Äquatorial-Guinea
 Name[el]=Ισημερινή Γουινέα
 Name[eo]=Ekvatora Gvineo
-Name[es]=Guinea equatorial
+Name[es]=Guinea Ecuatorial
 Name[et]=Ekvatoriaal-Guinea
 Name[eu]=Ginea Ekuatoriala
 Name[fa]=گینه استوایی
Index: l10n/southafrica.desktop
===================================================================
--- l10n/southafrica.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/southafrica.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -16,7 +16,7 @@
 Name[de]=Afrika, Südliches
 Name[el]=Αφρική, Νότια
 Name[eo]=Afriko suda
-Name[es]=Africa, del Sur
+Name[es]=África Septentrional
 Name[et]=Lõuna-Aafrika
 Name[eu]=Hego Afrika
 Name[fa]=آفریقای جنوبی
Index: l10n/middleeast.desktop
===================================================================
--- l10n/middleeast.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/middleeast.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -37,7 +37,7 @@
 Name[lv]=Vidējie austrumi
 Name[mk]=Среден Исток
 Name[mt]=Lvant Nofsani
-Name[nb]=Midt-Østen
+Name[nb]=Midtøsten
 Name[nds]=Middel-Oosten
 Name[ne]=मध्य-पूर्व
 Name[nl]=Midden-Oosten
Index: l10n/pf/entry.desktop
===================================================================
--- l10n/pf/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/pf/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -15,7 +15,7 @@
 Name[de]=Französisch Polynesien
 Name[el]=Γαλλική Πολυνησία
 Name[eo]=Franca Polinezio
-Name[es]=Polinesia francesa
+Name[es]=Polinesia Francesa
 Name[et]=Prantsuse Polüneesia
 Name[eu]=Polinesia Frantziarra
 Name[fa]=پلی‌نزی فرانسوی
Index: l10n/pg/entry.desktop
===================================================================
--- l10n/pg/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/pg/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -14,7 +14,7 @@
 Name[de]=Papua Neu-Guinea
 Name[el]=Παπούα Νέα Γουινέα
 Name[eo]=Papuo-Nov-Gvineo
-Name[es]=Papua Nueva Guinea
+Name[es]=Papúa Nueva Guinea
 Name[et]=Paapua Uus-Guinea
 Name[eu]=Papua Ginea Berria
 Name[fa]=گینه نو پاپوا
Index: l10n/pk/entry.desktop
===================================================================
--- l10n/pk/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/pk/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -10,6 +10,7 @@
 Name[cy]=Pacistan
 Name[el]=Πακιστάν
 Name[eo]=Pakistano
+Name[es]=Pakistán
 Name[fa]=پاکستان
 Name[ga]=An Phacastáin
 Name[gl]=Paquistán
Index: l10n/pm/entry.desktop
===================================================================
--- l10n/pm/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/pm/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -16,7 +16,7 @@
 Name[de]=Saint Pierre und Miquelon
 Name[el]=Σαιν Πιέρ (Άγιος Πέτρος) και Μικελόν
 Name[eo]=Sent-Piero kaj Mikelono
-Name[es]=Saint Pierre y Miquelon
+Name[es]=San Pedro y Miguelón
 Name[et]=Saint Pierre ja Miquelon
 Name[eu]=Saint Pierre eta Miquelon
 Name[fa]=سنت پیر و میکلون
Index: l10n/ps/entry.desktop
===================================================================
--- l10n/ps/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/ps/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -15,7 +15,7 @@
 Name[de]=Palästinensisches Gebiet
 Name[el]=Παλαιστίνη
 Name[eo]=Palestina Teritorio
-Name[es]=Territorio palestino
+Name[es]=Territorios Palestinos
 Name[et]=Palestiina
 Name[eu]=Palestina
 Name[fa]=سرزمین فلسطین
Index: l10n/pw/entry.desktop
===================================================================
--- l10n/pw/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/pw/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -7,6 +7,7 @@
 Name[cy]=Palaw
 Name[el]=Παλάου
 Name[eo]=Palao
+Name[es]=Palaos
 Name[fa]=پالائو
 Name[he]=פלאו
 Name[hi]=पलाऊ
Index: l10n/ie/entry.desktop
===================================================================
--- l10n/ie/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/ie/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -15,7 +15,7 @@
 Name[da]=Irland
 Name[de]=Irland
 Name[el]=Ιρλανδία
-Name[eo]=Islando
+Name[eo]=Irlando
 Name[es]=Irlanda
 Name[et]=Iirimaa
 Name[eu]=Irlanda
Index: l10n/ir/entry.desktop
===================================================================
--- l10n/ir/entry.desktop	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ l10n/ir/entry.desktop	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -7,6 +7,7 @@
 Name[cs]=Írán
 Name[el]=Ιράν
 Name[eo]=Irano
+Name[es]=Irán
 Name[et]=Iraan
 Name[fa]=ایران
 Name[ga]=An Iaráin
Index: kdm/backend/client.c
===================================================================
--- kdm/backend/client.c	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdm/backend/client.c	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -1623,6 +1623,8 @@
 	int pretc;
 #endif
 
+	Signal( SIGTERM, SIG_IGN );
+
 	if (removeAuth) {
 		if (source( systemEnviron, td->reset, td_setup ))
 			LogError( "Cannot execute reset script %\"s\n", td->reset );
Index: kdm/backend/inifile.c
===================================================================
--- kdm/backend/inifile.c	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdm/backend/inifile.c	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -37,6 +37,7 @@
 #include "dm_error.h"
 
 #include <sys/types.h>
+#include <sys/stat.h>
 #include <unistd.h>
 #include <stdlib.h>
 #include <string.h>
@@ -47,17 +48,27 @@
 {
 	char *data;
 	int fd, len;
+	struct stat st;
 
 	if ((fd = open( fname, O_RDONLY | O_NONBLOCK )) < 0) {
 		Debug( "cannot open ini-file %\"s: %m", fname );
 		return 0;
 	}
-	len = lseek( fd, 0, SEEK_END );
+	if (fstat( fd, &st ) || !S_ISREG( st.st_mode )) {
+		LogWarn( "Ini-file %\"s is no regular file\n", fname );
+		close( fd );
+		return 0;
+	}
+	if (st.st_size >= 0x10000) {
+		LogWarn( "Ini-file %\"s is too big\n", fname );
+		close( fd );
+		return 0;
+	}
+	len = st.st_size;
 	if (!(data = Malloc( len + 2 ))) {
 		close( fd );
 		return 0;
 	}
-	lseek( fd, 0, SEEK_SET );
 	if (read( fd, data, len ) != len) {
 		Debug( "cannot read ini-file %\"s: %m", fname );
 		free( data );
Index: kdm/backend/session.c
===================================================================
--- kdm/backend/session.c	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdm/backend/session.c	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -145,7 +145,10 @@
 		ReStr( &curtype, "classic" );
 		cursource = (td->hstent->rLogin == 1) ? PWSRC_RELOGIN : PWSRC_MANUAL;
 		return 1;
-	} else if (*td->autoUser && !td->autoDelay && (tdiff > 0 || td->autoAgain))
+	} else if (*td->autoUser && !td->autoDelay &&
+	           ((tdiff > 0 && ((td->displayType & d_lifetime) == dTransient ||
+	                           !td->hstent->lastExit)) ||
+	            td->autoAgain))
 	{
 		unsigned int lmask;
 		Window dummy1, dummy2;
@@ -487,6 +490,7 @@
 static void
 catchTerm( int n ATTR_UNUSED )
 {
+	Signal( SIGTERM, SIG_IGN );
 	Longjmp( abortSession, EX_AL_RESERVER_DPY );
 }
 
Index: kdm/kfrontend/kdm_config.c
===================================================================
--- kdm/kfrontend/kdm_config.c	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdm/kfrontend/kdm_config.c	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -1072,6 +1072,9 @@
 		if (!((**hostPtr)->entry.displayAddress.hostAddress =
 		      Malloc( addr_len )))
 		{
+#if defined(IPv6) && defined(AF_INET6)
+			freeaddrinfo( ai );
+#endif
 			free( (char *)(**hostPtr) );
 			return 0;
 		}
@@ -1165,7 +1168,7 @@
 					         h->entry.aliasPattern );
 			}
 		} else if (h->type == HOST_PATTERN && (flags & CHECK_NO_PAT))
-			LogWarn( "XDMCP ACL: wildcarded pattern %'* in host-only context\n",
+			LogWarn( "XDMCP ACL: wildcarded pattern %'s in host-only context\n",
 			         h->entry.hostPattern );
 	return 0;
 }
@@ -1453,7 +1456,7 @@
 				break;
 #endif
 			default:
-				Debug( "Unsupported config cathegory %#x\n", what );
+				Debug( "Unsupported config category %#x\n", what );
 			}
 			free( cfgfile );
 			break;
Index: kdm/kfrontend/kgreeter.cpp
===================================================================
--- kdm/kfrontend/kgreeter.cpp	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdm/kfrontend/kgreeter.cpp	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -42,6 +42,8 @@
 #undef Unsorted // x headers suck - make qdir.h work with --enable-final
 #include <qdir.h>
 #include <qfile.h>
+#include <qbuffer.h>
+#include <qmemarray.h>
 #include <qimage.h>
 #include <qmovie.h>
 #include <qpopupmenu.h>
@@ -59,6 +61,7 @@
 #include <grp.h>
 #include <stdlib.h>
 #include <unistd.h>
+#include <fcntl.h>
 #include <sys/types.h>
 
 #include <X11/Xlib.h>
@@ -163,6 +166,9 @@
 	QString login;
 };
 
+#define FILE_LIMIT_ICON 20
+#define FILE_LIMIT_IMAGE 200
+
 void
 KGreeter::insertUser( const QImage &default_pix,
                       const QString &username, struct passwd *ps )
@@ -181,16 +187,44 @@
 		nd = 1;
 	QImage p;
 	do {
-		QString fn = dp ?
-		             QFile::decodeName( ps->pw_dir ) + "/.face" :
-		             _faceDir + '/' + username + ".face";
-		if (p.load( fn + ".icon" ) || p.load( fn )) {
-			QSize ns( 48, 48 );
-			if (p.size() != ns)
-				p = p.convertDepth( 32 ).smoothScale( ns, QImage::ScaleMin );
-			goto gotit;
+		dp ^= 1;
+		QCString fn = !dp ?
+		              QCString( ps->pw_dir ) + '/' :
+		              QFile::encodeName( _faceDir + '/' + username );
+		fn += ".face.icon";
+		int fd, ico;
+		if ((fd = open( fn.data(), O_RDONLY | O_NONBLOCK )) < 0) {
+			fn.truncate( fn.length() - 5 );
+			if ((fd = open( fn.data(), O_RDONLY | O_NONBLOCK )) < 0)
+				continue;
+			ico = 0;
+		} else
+			ico = 1;
+		QFile f;
+		f.open( IO_ReadOnly, fd );
+		int fs = f.size();
+		if (fs > (ico ? FILE_LIMIT_ICON : FILE_LIMIT_IMAGE) * 1000) {
+			LogWarn( "%s exceeds file size limit (%dkB)\n",
+			         fn.data(), ico ? FILE_LIMIT_ICON : FILE_LIMIT_IMAGE );
+			continue;
 		}
-		dp = 1 - dp;
+		QByteArray fc( fs );
+		int rfs = f.readBlock( fc.data(), fs );
+		::close( fd );
+		fc.resize( rfs > 0 ? rfs : 0 );
+		QBuffer buf( fc );
+		buf.open( IO_ReadOnly );
+		QImageIO ir;
+		ir.setIODevice( &buf );
+		if (!ir.read()) {
+			LogInfo( "%s is no valid image\n", fn.data() );
+			continue;
+		}
+		p = ir.image();
+		QSize ns( 48, 48 );
+		if (p.size() != ns)
+			p = p.convertDepth( 32 ).smoothScale( ns, QImage::ScaleMin );
+		goto gotit;
 	} while (--nd >= 0);
 	p = default_pix;
   gotit:
Index: kdm/kfrontend/genkdmconf.c
===================================================================
--- kdm/kfrontend/genkdmconf.c	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdm/kfrontend/genkdmconf.c	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -673,7 +673,7 @@
 "    xsess_tmp=";
 static const char def_session2[] =
 "\n"
-"    $SHELL -c \"if (-f /etc/csh.login) source /etc/csh.login; if (-f ~/.login) source ~/.login; /bin/sh -c export >! $xsess_tmp\"\n"
+"    $SHELL -c \"if (-f /etc/csh.login) source /etc/csh.login; if (-f ~/.login) source ~/.login; /bin/sh -c export -p >! $xsess_tmp\"\n"
 "    . $xsess_tmp\n"
 "    rm -f $xsess_tmp\n"
 "    ;;\n"
Index: kdesu/kdesu/kdesu.cpp
===================================================================
--- kdesu/kdesu/kdesu.cpp	(.../tags/KDE/3.5.8/kdebase)	(wersja 750987)
+++ kdesu/kdesu/kdesu.cpp	(.../branches/KDE/3.5/kdebase)	(wersja 750987)
@@ -113,7 +113,10 @@
     unsetenv( "SESSION_MANAGER" );
     KApplication app;
     // but propagate it to the started app
-    setenv( "SESSION_MANAGER", session_manager.data(), 1 );
+    if (session_manager.data())
+    {
+        setenv( "SESSION_MANAGER", session_manager.data(), 1 );
+    }
     
     {
         KStartupInfoId id;

Zmiany atrybutów dla: .
___________________________________________________________________
Nazwa: svn:externals
   + admin https://svn.kde.org/home/kde/branches/KDE/3.5/kde-common/admin


