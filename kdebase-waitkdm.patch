diff -urN kdebase-2.2beta1.orig/kdm/backend/server.c kdebase-2.2beta1/kdm/backend/server.c
--- kdebase-2.2beta1.orig/kdm/backend/server.c	Tue Jun 12 21:07:31 2001
+++ kdebase-2.2beta1/kdm/backend/server.c	Tue Jul 10 14:36:25 2001
@@ -81,6 +81,11 @@
     char	**argv;
     char	arg[1024];
     int		pid;
+    int         result = TRUE;
+    int         i;
+    Display     *disp;
+    pid_t       _pid;
+    int         status;
 
     Debug ("StartServer for %s\n", d->name);
     receivedUsr1 = 0;
@@ -121,8 +126,44 @@
     Debug ("Server forked, pid %d\n", pid);
     d->serverPid = pid;
     if (serverPause ((unsigned) d->serverTimeout, pid))
-	return FALSE;
-    return TRUE;
+	result = FALSE;
+
+    if (result) {
+      /* fprintf(stderr, "Server started, checking\n"); */
+
+      setenv("XAUTHORITY", d->authFile, 1);
+
+      for (i=0; i<10; i++) {
+
+	if ( (_pid = fork()) == 0) {
+	  /* fprintf(stderr, "checking (%s) ", d->name); fflush(stderr); */
+	  disp = XOpenDisplay(d->name); 
+	  
+	  if (disp)
+	    exit(0);
+
+	  exit(1);
+	}
+	else if (pid == -1)
+	  return FALSE;
+
+	waitpid(_pid, &status, 0);
+	
+	if (WEXITSTATUS(status) == 0) {
+	  /* fprintf(stderr, "succes!!!!!!!\n"); */
+	  return TRUE;
+	}
+
+	sleep (1);
+      }
+
+    }
+
+    fprintf(stderr, "switching back to runlevel 3\n"); fflush(stderr); 
+    system("/sbin/telinit 3");
+    exit(-1);
+
+    return result;
 }
 
 int
